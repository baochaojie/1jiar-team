define("util/env",[],function(){var i={host:"",scheme:"",port:"",env:"online"};function e(){var e=$.parseURL(location.href);i.host=e.host,i.scheme=e.scheme,i.port=e.port;var t=i.host;0===t.indexOf("dev")?i.env="dev":0===t.indexOf("test")&&(i.env="test")}function a(e){var t="";return e.scheme&&(t+=e.scheme+"://"),e.host&&(t+=e.host),e.port&&(t+=":"+e.port),e.path&&(t+="/"+e.path),e.query&&(t+="?"+e.query),e.hash&&(t+="#"+e.hash),t}var o={getEnv:function(){return i.env},fixedHost:function(e){if(!e)return i.host;var t=e.substring(0,e.indexOf("."));switch(i.env){case"dev":case"test":if(0!==t.indexOf(i.env))return i.env+e}return e},fixedUrl:function(e,t){t=t||!1,e.indexOf("http")<0&&(e=location.protocol+e);var n=$.parseURL(e);return n.host?(!t&&(n.host=o.fixedHost(n.host)),n.port=i.port,n.scheme||(n.scheme=i.scheme)):(n.host=i.host,n.scheme=i.scheme,n.port=i.port),a(n)},isSameDomain:function(e){var t;return $.parseURL(e).host==i.host}};return e(),o}),define("util/EventEmitter",[],function(){"use strict";var n,a,o,r,s,e;function c(){}return"function"!=typeof Object.create&&(Object.create=(n=function(){},function(e){if(1<arguments.length)throw Error("Second argument not supported");if("object"!=typeof e)throw TypeError("Argument must be an object");n.prototype=e;var t=new n;return n.prototype=null,t})),Object.keys||(Object.keys=(a=Object.prototype.hasOwnProperty,o=!{toString:null}.propertyIsEnumerable("toString"),s=(r=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"]).length,function(e){if("object"!=typeof e&&("function"!=typeof e||null===e))throw new TypeError("Object.keys called on non-object");var t=[],n,i;for(n in e)a.call(e,n)&&t.push(n);if(o)for(i=0;i<s;i++)a.call(e,r[i])&&t.push(r[i]);return t})),c.extend=function(e){var t=this,a=t.prototype;function n(){this&&t(this,arguments),this&&this._initialize_&&this._initialize_.apply(this,arguments)}var i=n.prototype=Object.create(a);for(var o in e){if("constructor"===o)return;var r=e[o];if("function"==typeof r&&a[o]&&"function"==typeof a[o])r=function(n,i){return function(){var e=this._super;this._super=a[n];var t=i.apply(this,arguments);return this._super=e,t}}(o,r);else if("object"==typeof r&&a[o]&&"object"==typeof a[o])for(var s in a[o])r[s]||(r[s]=a[o][s]);i[o]=r}return n.extend=c.extend,n},c.extend({_initialize_:function(e){var t=this;t._eventList={},t._eventTriggerd_={},this.initialize&&this.initialize.apply(this,arguments),this._promise_="boolean"==typeof e&&e},on:function(e,t){if(!e||!t)throw"type of fn is required";var n=this,i=n._eventList[e];i||(i=[],n._eventList[e]=i),i.push(t)},off:function(e,t){var n=this;if(e){var i=n._eventList[e];if(i&&i.length){if(!t){for(;i.pop(););return}for(var a=0,o=i.length;a<o;a++)if(i[a]==t||i[a]==t.fn)return void i.splice(a,1)}}else n._eventList={}},trigger:function(e){if(e){var t=this,n=Array.prototype.slice.call(arguments,1);t._promise_&&(t._eventTriggerd_[e]=n);var i=t._eventList[e];if(i&&i.length)for(var a=0;a<i.length;a++)if(!1===i[a].apply(t,n))return!1}},before:function(e,t){var n,i=this;return function(){return 0<--e?n=t.apply(i,arguments):t=null,n}},once:function(e,t){var n=this;e&&t&&n.on(e,n.before(2,t))},destroy:function(){var e;this._eventList=null},always:function(e,t){var n=this;n.on(e,t),n._eventTriggerd_[e]&&t.apply(null,n._eventTriggerd_[e])}})}),define("util/crossRequest",["require"],function(e){var n={},i=function(e,t){var n=this;n.domain=e,t=t||$.parseURL(e).host.replace(/\./g,"-"),n.name=t,n.init()};function a(e,t){var n=document.createElement("iframe");return n.id=e,n.name=e,n.src=t,n.style.cssText="display:none;width:0px;height:0px;",n.width=0,n.height=0,n.title="empty",document.body.appendChild(n),n}return $.extend(i.prototype,{init:function(){var e=this,t=e.domain+"/xd/api/?name="+e.name,n=a(e.name,t);e.iframe=n.contentWindow,e.reqArray=[]},next:function(){var e=this},request:function(e){var t=this,n=$.Deferred();return t.reqArray.push({defer:n,request:e}),t.next(),n}}),function(e,t){return n[e]?n[e]:n[e]=new i(e,t)}}),define("util/Trans",["require","util/EventEmitter","util/crossRequest","util/env"],function(e){var t=e("util/EventEmitter");$.EventEmitter=t;var n=$.EventEmitter,a=e("util/crossRequest"),o=e("util/env"),i=!1,r;return n.extend({initialize:function(e){var t={url:"",type:"get",dataType:"json",args:{}};$.extend(t,e),t.url=o.fixedUrl(t.url),t.method=t.type;var n=this;n.opt=t;var i=o.fixedUrl($.parseURL(t.url).host);o.isSameDomain(i)?n.isSame=!0:n.crossRequest=a(i)},request:function(e){var t=this,n=t.opt;return $.extend(n.args,e),n.data=n.args,t.isSame?$.ajax(n):this.crossRequest.request(n)}})}),define("util/ajax",[],function(){return $.ajax}),define("util/api",[],function(){var e={host:location.host,port:"",areaApi:"//matrix-api.lianjia.com:9004/",apartmentAreaApi:"",baiduMap:"//api.map.baidu.com/marker",redirect:"//m.zufangzi.com/redirect",userCenter:"//user.lianjia.com/site/favorHouse/",logout:"//test3-upassport.lianjia.com/logout",LianjiaIM:"//s1-ljcdn.test.lianjia.com:8400/web-im-sdk/static/1.1/lianjiaim1.1.min.js"},t;return-1<location.host.indexOf("test")?(e.apartmentAreaApi="//testapi.zufangzi.com/",e.loginUrl="//upassport.test.lianjia.com:5201/login?service=http%3A%2F%2Ftest-beike.m.lianjia.com%2Fmy%2Fchecklogin%3Fredirect%3D%252Fmy%252Findex&type=2",e.staticUrl="//s1.rent39.internal.lianjia.com/matrix_pc/dist/pc/src/",e.userCenter="//test-user.lianjia.com/site/favorHouse/",e.logout="//test3-upassport.lianjia.com/logout"):-1<location.host.indexOf("dev")?(e.staticUrl="//feresource.com:8091/pc/src/",e.userCenter="//test-user.lianjia.com/site/favorHouse/",e.logout="//test3-upassport.lianjia.com/logout"):(e.apartmentAreaApi="http://api.zufangzi.com/",e.loginUrl="//upassport.lianjia.com/login?service=https%3A%2F%2Fm.lianjia.com%2Fmy%2Fchecklogin%3Fredirect%3D%252Fmy%252Findex&type=2",e.staticUrl="//s1.ljcdn.com/matrix_pc/dist/pc/src/",e.userCenter="//user.lianjia.com/site/favorHouse/",e.LianjiaIM="//s1.ljcdn.com/web-im-sdk/static/1.1/lianjiaim1.1.min.js?v=15212312340214",e.logout="//upassport.lianjia.com/logout"),{env:e,path:{getUser:"/user/get"}}}),define("module/login/login",["util/env","util/Trans","util/EventEmitter","util/ajax","util/api"],function(){var C=require("util/env"),e=require("util/Trans"),t=require("util/EventEmitter"),n=require("util/ajax"),i=require("util/api");$.env=C,$.Trans=e,$.EventEmitter=t,$.listener=new $.EventEmitter;var a=$.env.getEnv(),o=!1,r=!1,s="http://172.30.0.20:9991/",c=location.protocol,x="",I=/^\w{4}$/,S=(x="dev"===a||"test"===a?c+"//test3-upassport.lianjia.com/":c+"//upassport.lianjia.com/")+"freshCaptch",j=function(e,t){$(".panel_login").hide();var n,i=$('<div class="panel_login panel_success"><i class="close_success">&times</i>'+e+(t?"":'<div>欢迎回来，<a class="green tologin">点击这里去登录</a></div></div>')).appendTo(".loninContaner");$(".close_success").on("click",function(){$(".overlay_bg").hide(),$(".panel_success").remove()}),t&&setTimeout(function(){location.reload()},2e3)},L=function(e,t){var n,i={phone:[/^\d{11}$/,"请输入有效的手机号"],pwd:[/^\w{8,}$/,"密码必须是至少8位的数字字母组合"]}[t];return!!i&&(!!i[0].test(e)||i[1])},N=/^\d{11}$/,l=/^(?![^a-zA-Z]+$)(?!\D+$)/,d=location.protocol+"//"+location.host,E="https://ajax.api.lianjia.com/login/login/getuserinfo",u=d+"/zufang/aj/userinfo",f=d+"/logout";"test"==a?(E=d+"/zufang/aj/userinfo",f=d+"/logout"):"dev"==a&&(E=d+"/zufang/aj/userinfo",f=d+"/logout");var q={checkExists:x+"CheckExist",sendVerifyCode:x+"sendSms",sendVerifyVoiceCode:x+"sendVoice",verifyCode:"//passport.ke.com/register/ljRegister/GenerateVerifyCode",checkVerifyCode:"//passport.ke.com/register/ljRegister/CheckVerifyCode",sendSMS:"//passport.ke.com/register/ljRegister/SendMobileVerifyCode",checkMobileCode:"//passport.ke.com/register/ljRegister/CheckMobileVerifyCode"},p=0;function g(){lianjiaCasManager.config({setLoginUrl:E,service:E,getFirstTicket:x+"login?service="+encodeURIComponent(E)+"&get-lt=true&isajax=true",loginUrl:x+"login"}),r&&r()}function T(e){lianjiaCasManager?e():r=e}function m(){if(!o){o=!0;var e=document.createElement("script");e.src=x+"dist/js/passport.js",e.type="text/javascript",e.charset="utf-8",e.onload=g,document.getElementsByTagName("head")[0].appendChild(e)}}function M(){return window.$ULOG&&$ULOG.send("10225"),className=$(this).attr("class"),$(".overlay_bg").fadeIn(300),$("#dialog_tel").removeAttr("class").addClass("panel_login animated "+className).fadeIn(),$("#dialog_tel .verImg").trigger("click"),$("body").css({overflow:"hidden"}),m(),!1}function O(){return window.$ULOG&&$ULOG.send("10225"),className=$(this).attr("class"),$("#dialog").removeClass("bounceIn"),$("#dialog").hide(),$("#dialog_tel").removeAttr("class").addClass("panel_login animated className").show(),$("#dialog_tel .verImg").trigger("click"),$("body").css({overflow:"hidden"}),m(),!1}function V(){return $(".panel_success").remove(),window.$ULOG&&$ULOG.send("10225"),$(".panel_login").fadeOut(),className=$(this).attr("class"),$("#dialog_tel").removeClass("bounceIn"),$("#dialog_tel").hide(),$("#dialog_reg").hide(),$("#dialog").show(),$("body").css({overflow:"hidden"}),m(),!1}function U(){return $ULOG.send("10225"),className=$(this).attr("class"),$(".overlay_bg").fadeIn(300),$("#dialog_reg").removeAttr("class").addClass("panel_login animated "+className).fadeIn(),$("#dialog_reg .verImg").trigger("click"),$("body").css({overflow:"hidden"}),m(),!1}function A(){return window.$ULOG&&$ULOG.send("10448"),$(".panel_login").fadeOut(),className=$(this).attr("class"),$("#dialog_tel").removeClass("bounceIn"),$("#dialog_tel").hide(),$("#dialog_reg").hide(),$("#dialog").hide(),$("#dialog_forget").show(),$("#dialog_forget .verImg").trigger("click"),$("body").css({overflow:"hidden"}),m(),!1}function h(){var e;new $.Trans({url:u,dataType:"jsonp"}).request().done(function(e){e&&e.data&&e.data.username&&(e.code=1),0==e.status&&$.listener.trigger("userInfo",e)}).fail(function(e){e&&$.listener.trigger("userInfo",e)})}return $(document.body).ready(function(){var d=$("#con_login_user .verImg"),t=$("#con_login_user").find(".show-error"),c=$("#con_login_user_tel .verImg"),n=$("#con_login_user_tel").find(".show-error"),l=$("#con_login_user_reg .checkVerimg .verImg"),e=$("#con_login_user_tel .checkVerimg1 .verImg"),i=$("#con_login_user_reg").find(".show-error"),s=$("#con_forget_user_tel .verImg"),a=$("#con_forget_user_tel").find(".show-error"),o=$("#con_forget_user_pw").find(".show-error");function r(){$(".panel_login").fadeOut(),$(".overlay_bg").fadeOut(),$("body").css({overflow:""}),$("#dialog").removeClass("bounceIn")}d.on("click",function(){var e=+new Date;window.$ULOG&&$ULOG.send("10451"),$(this).attr("src",S+"?t="+e)}),c.on("click",function(){var e=+new Date;window.$ULOG&&$ULOG.send("10451"),$(this).attr("src",S+"?t="+e)}),s.on("click",function(){var e=+new Date;window.$ULOG&&$ULOG.send("10451"),$(this).attr("src",S+"?t="+e)}),l.on("click",function(){var e=+new Date;window.$ULOG&&$ULOG.send("10451"),$(this).attr("src",S+"?t="+e)}),e.on("click",function(){var e=+new Date;window.$ULOG&&$ULOG.send("10451"),$(this).attr("src",S+"?t="+e)}),$(".typeUserInfo").delegate(".btn-register","click",U),$(".typeUserInfo").delegate(".btn-login","click",M),$(".loninContaner").delegate(".tologin","click",V),$(".loninContaner").delegate(".totellogin","click",function(e){$(".panel_success").remove(),O()}),$(".loninContaner").delegate(".toforget","click",A),$(".overlay_bg, .claseDialogBtn, .close_login").click(function(){r()}),$(".loninContaner").delegate(".checkbox-btn","click",function(e){var t=$(this),n;t.find("input").get(0).checked?t.find("span").addClass("active"):t.find("span").removeClass("active")});var u=function(e,t){var n,i=e||this,a=!1,o={};i.parent().show();var e=$.extend(o,e);i.css({color:"#333333"});var r='<div class="drag_bg"></div><div class="drag_text" onselectstart="return false;" unselectable="on">拖动滑块验证</div><div class="handler handler_bg"></div>';i.html(r);var s=i.find(".handler"),c=i.find(".drag_bg"),l=i.find(".drag_text"),d=i.width()-s.width();function u(){s.removeClass("handler_bg").addClass("handler_ok_bg"),l.text("验证通过"),i.css({color:"#00ae66"}),s.unbind("mousedown"),$(document).unbind("mousemove"),$(document).unbind("mouseup"),t&&t()}s.mousedown(function(e){a=!0,n=e.pageX-parseInt(s.css("left"),10)}),s.mousedown(function(e){a=!0,n=e.pageX-parseInt(s.css("left"),10)}),$(document).mousemove(function(e){var t=e.pageX-n;a&&(0<t&&t<=d?(s.css({left:t}),c.css({width:t})):d<t&&u())}).mouseup(function(e){var t;a=!1,e.pageX-n<d&&(s.css({left:0}),c.css({width:0}))})},f=function(e){u(e);var t=e.find(".handler"),n=e.find(".drag_bg"),i=e.find(".drag_text");t.css({left:0}),n.css({width:0}),t.removeClass("handler_ok_bg").addClass("handler_bg"),i.text("拖动滑块验证"),$("#drag").css({color:"#333333"}),e.parent().hide()};function p(e){e=e||"用户名或者密码错误",t.find("dd").html(e),t.show()}function g(){t.hide()}function m(e){e=e||"用户名或者密码错误",n.find("dd").html(e),n.show()}function h(){n.hide()}function v(e){e=e||"用户名或者密码错误",i.find("dd").html(e),i.show()}function _(){i.hide()}function b(e){e=e||"用户名或者密码错误",a.find("dd").html(e),a.show()}function y(){a.hide()}$("#con_login_user").delegate("input","keyup",function(e){13==e.keyCode&&$(".login-user-btn").click()});var k=0;$(".login-user-btn").on("click",function(e){window.$ULOG&&$ULOG.send("10446"),$(".border-a").removeClass("border-a");var t=$("#con_login_user").find(".item"),n=$("#con_login_agent").find(".item"),i=t.find(".users").val(),a=t.find(".password").val();if(!i||!0!==L(i,"phone"))return t.find(".users").focus(),p("请输入有效的手机号码"),void $("#con_login_user").find(".userName").addClass("border-red");if($("#con_login_user").find(".userName").removeClass("border-red"),!a)return t.find(".password").focus(),p("请输入密码"),void $("#con_login_user").find(".pwd").addClass("border-red");$("#con_login_user").find(".pwd").removeClass("border-red");var o=$("#con_login_user").find('[name="remember"]').get(0),r={username:i,password:a,code:""};if(o&&o.checked&&(r.remember=1),"none"!=$("#con_login_user .checkVerimg").css("display")){var s=$(".ver-img").val();if(!I.test(s))return p("验证码格式错误"),$(".ver-img").focus(),void $("#con_login_user").find(".checkVerimg").addClass("border-red");$("#con_login_user").find(".checkVerimg").removeClass("border-red"),r.code=s}var c=null;if("none"!=$(".drag").css("display")){if(!k)return void p("滑块验证不通过");c=(new Date).getTime(),k=0,f($("#drag"))}return g(),lianjiaCasManager.config({loginUrl:x+"login",getFirstTicket:x+"login?service="+encodeURIComponent(E)+"&type=1&get-lt=true&isajax=true&from=lianjiaweb"+(null===c?"":"&time="+c)}),void T(function(){lianjiaCasManager.login(r,function(e){$.listener.trigger("loginActSuccess"),d.trigger("click"),window.NOTAUTOJUMP||location.reload()},function(e){if(t.removeClass("border-red"),e&&e.eventId)switch(e.eventId){case"needCaptchaCheckWhenIpLimit":$("#con_login_user .checkVerimg").show(),p("请输入图形验证码"),d.trigger("click"),$("#con_login_user").find(".checkVerimg").addClass("border-red");break;case"needSendSms":$("#drag").find(".handler").hasClass("handler_ok_bg")||(u($("#drag")),p("请拖动滑块进行验证")),d.trigger("click");break;case"needCaptcha":$("#con_login_user .checkVerimg").show(),p("请输入图形验证码"),d.trigger("click"),$("#con_login_user").find(".checkVerimg").addClass("border-red");break;default:p(e.msg),d.trigger("click")}})});function l(e){if("1"==e.code)if(e.data.success)location.reload();else if(e.data.isNeedVerifyCode&&"none"==$("#con_login_user .checkVerimg").css("display"))$("#con_login_user .checkVerimg").show(),$("#con_login_user .checkVerimg img").attr("src",C.fixedUrl("//login.lianjia.com/login/GenerateVerifyCode?rand"+(new Date).getTime()));else{var t="用户名或者密码错误";switch(e.data.errorCode){case 1:t="用户名不存在";break;case 2:t="密码不正确,请重试";break;case 3:t="验证码输入不正确或者已经过期",$("#con_login_user .checkVerimg img").attr("src",C.fixedUrl("//login.lianjia.com/login/GenerateVerifyCode?rand"+(new Date).getTime()))}p(t)}}}),$(".login-user-tel-btn").on("click",function(e){window.$ULOG&&$ULOG.send("10446"),$(".border-a").removeClass("border-a");var t=$("#con_login_user_tel").find(".item"),n=$("#con_login_agent").find(".item"),i=t.find(".users_tel").val(),a=t.find(".verifycode").val();if(!i||!0!==L(i,"phone"))return t.find(".users_tel").focus(),m("请输入有效的手机号码"),void $("#con_login_user_tel").find(".userName").addClass("border-red");if($("#con_login_user_tel").find(".userName").removeClass("border-red"),!a)return t.find(".verifycode").focus(),void $("#con_login_user_tel").find(".Verify").addClass("border-red");$("#con_login_user_tel").find(".Verify").removeClass("border-red");var o=$("#con_login_user_tel").find('[name="remember"]').get(0),r={username:i,smsCode:a,code:"",type:2};if(o&&o.checked&&(r.remember=1),"none"!=$("#con_login_user_tel .checkVerimg").css("display")){var s=$("#con_login_user_tel .ver-img").val();if(!I.test(s))return m("验证码格式错误"),$("#con_login_user_tel .ver-img").focus(),void $("#con_login_user_tel").find(".checkVerimg").addClass("border-red");$("#con_login_user_tel").find(".checkVerimg").removeClass("border-red"),r.code=s}h(),lianjiaCasManager.config({loginUrl:x+"login",getFirstTicket:x+"login?service="+encodeURIComponent(E)+"&get-lt=true&isajax=true&type=2&from=lianjiaweb"}),T(function(){t.removeClass("border-red"),lianjiaCasManager.login(r,function(e){-1==e.code?(m(),c.trigger("click")):($.listener.trigger("loginActSuccess"),window.NOTAUTOJUMP||location.reload())},function(e){if(t.removeClass("border-red"),e&&e.eventId)switch(e.eventId){case"needCaptcha":m("请输入验证码"),$("#con_login_user_tel .checkVerimg").show(),c.trigger("click");break;case"showCaptchaWhenSendSms":m("请输入验证码"),$("#con_login_user_tel .checkVerimg").show(),c.trigger("click");default:m(e.msg),c.trigger("click")}})})}),$(".user-forget").on("click",function(e){window.$ULOG&&$ULOG.send("10449"),$(".border-a").removeClass("border-a");var t=$("#con_forget_user_tel").find(".item"),n=t.find(".user_forget_phone").val(),i=t.find(".verifycode").val(),a=$("#con_forget_user_tel").find(".password_reg").val();if(!n||!0!==L(n,"phone"))return t.find(".user_forget_phone").focus(),b("请输入有效的手机号码"),void $("#con_forget_user_tel").find(".userName").addClass("border-red");if($("#con_forget_user_tel").find(".userName").removeClass("border-red"),!a||!0!==L(a,"pwd"))return t.find(".password_reg").focus(),b("请输入不少于8位数的密码（数字+字母）"),void $("#con_forget_user_pw").find(".pwd").addClass("border-red");if(!a.match(/\d/)||!a.match(/[A-Za-z]/))return t.find(".password_reg").focus(),b("请输入不少于8位数的密码（数字+字母）"),void $("#con_forget_user_pw").find(".pwd").addClass("border-red");if($("#con_forget_user_pw").find(".pwd").removeClass("border-red"),!i)return t.find(".verifycode").focus(),t.find(".verifycode").addClass("border-a"),void $("#con_forget_user_tel").find(".Verify").addClass("border-red");$("#con_forget_user_tel").find(".Verify").removeClass("border-red");var o={username:n,phone:n,smsCode:i,newPassword:a,confirmPassword:a};if("none"!=$("#con_forget_user_tel .checkVerimg").css("display")){var r=$("#con_forget_user_tel .ver-img").val();if(!I.test(r))return b("验证码格式错误"),$("#con_forget_user_tel .ver-img").focus(),void $("#con_forget_user_tel").find(".checkVerimg").addClass("border-red");$("#con_forget_user_tel").find(".checkVerimg").removeClass("border-red"),o.code=r}y(),lianjiaCasManager.config({getFirstTicket:x+"forgotpassword?service="+encodeURIComponent(E)+"&get-lt=true&isajax=true&from=lianjiaweb",loginUrl:x+"forgotpassword"}),T(function(){lianjiaCasManager.login(o,function(e){$("#con_forget_user_pw").find(".pwd").removeClass("border-red"),$.listener.trigger("loginActSuccess"),window.NOTAUTOJUMP||(j("修改密码成功"),s.trigger("click"))},function(e){$("#con_forget_user_pw").find(".pwd").removeClass("border-red"),1===e.code?b():(2===e.code?b("请输入验证码"):3===e.code?b("短信验证码输入错误"):b(e.msg),$("#con_forget_user_tel .checkVerimg").show()),s.trigger("click")})})}),$(".register-user-btn").on("click",function(e){window.$ULOG&&$ULOG.send("10447"),$(".border-a").removeClass("border-a");var t=$("#con_login_user_reg").find(".item"),n=$("#con_login_agent").find(".item"),i=t.find(".users_reg").val(),a=t.find(".verifycode").val(),o=t.find(".password_reg").val();if(!i||!0!==L(i,"phone"))return t.find(".users_reg").focus(),v("请输入有效的手机号码"),void $("#con_login_user_reg").find(".userName").addClass("border-red");if($("#con_login_user_reg").find(".userName").removeClass("border-red"),!a)return t.find(".verifycode").focus(),t.find(".verifycode").addClass("border-a"),void $("#con_login_user_reg").find(".Verify").addClass("border-red");if($("#con_login_user_reg").find(".Verify").removeClass("border-red"),!o||!0!==L(o,"pwd"))return t.find(".password_reg").focus(),v("请输入不少于8位数的密码（数字+字母）"),void $("#con_login_user_reg").find(".pwd").addClass("border-red");if($("#con_login_user_reg").find(".pwd").removeClass("border-red"),!o.match(/\d/)||!o.match(/[A-Za-z]/))return t.find(".password_reg").focus(),v("请输入不少于8位数的密码（数字+字母）"),void $("#con_login_user_reg").find(".pwd").addClass("border-red");$("#con_login_user_reg").find(".pwd").removeClass("border-red");var r=$("#con_login_user_reg").find('[name="read"]').get(0),s={username:i,verify:a,password:o,smsCode:a,confirmPassword:o};if(!r.checked)return v("请阅读协议并确认"),void r.focus();if("none"!=$("#con_login_user_reg .checkVerimg").css("display")){var c=$("#con_login_user_reg .ver-img").val();if(!I.test(c))return v("验证码格式错误"),$("#con_login_user_reg .ver-img").focus(),void $("#con_login_user_reg").find(".checkVerimg").addClass("border-red");$("#con_login_user_reg").find(".checkVerimg").removeClass("border-red"),s.code=c}_(),lianjiaCasManager.config({getFirstTicket:x+"register?service="+encodeURIComponent(E)+"&get-lt=true&isajax=true&from=lianjiaweb",loginUrl:x+"register"}),T(function(){lianjiaCasManager.login(s,function(e){t.removeClass("border-red"),-1==e.code?(v(e.msg),l.trigger("click")):($.listener.trigger("loginActSuccess"),window.NOTAUTOJUMP||j("注册成功",!0))},function(e){if(t.removeClass("border-red"),e&&e.eventId)switch(e.eventId){case"needCaptcha":v("请输入验证码"),$("#con_login_user_reg .checkVerimg").show(),l.trigger("click");break;case"showCaptchaWhenSendSms":v("请输入验证码"),$("#con_login_user_reg .checkVerimg").show(),l.trigger("click");default:v(e.msg),l.trigger("click")}})})});var w=function(e){if(null==e||""===e)return!1;if("object"==typeof e)for(var t in e){var n=e[t].value,i=e[t].required;if(void 0===i||!1===i.value);else if(null==n||""==n)return!!i.hint&&i.hint;var a=e[t].pattern;if(a&&!n.match(a.value))return!!a.hint&&a.hint;var o=e[t].equal;if(o){var r=e[o.propertyName];if(null==r)return!1;if(r.value!=n)return!!o.hint&&o.hint}}return!0};$("#send_verify_code_tel").on("click",function(e){if($(this).hasClass("disabled"))return!1;window.$ULOG&&$ULOG.send("10445");var t={telNum:{value:$(".users_tel").val(),pattern:{value:N,hint:"请输入有效的手机号码"}}},n=w(t);if(1!=n)return m(n),!1;var i={phone:$(".users_tel").val()};if(0<$("#con_login_user_tel .checkVerimg").length&&""!=$("#con_login_user_tel .checkVerimg input").val()&&(i.code=$("#con_login_user_tel .checkVerimg input").val(),$("#con_login_user_tel").find(".checkVerimg").removeClass("border-red")),!$("#con_login_user_tel .checkVerimg input").val())return $("#con_login_user_tel").find(".checkVerimg").addClass("border-red"),m("请输入图形验证码"),!1;var a=function(e){var t=null,n=$("#send_verify_code_tel"),i;t=setInterval(function(){if(e<=0)return n.removeClass("disabled"),n.find("em").html("重新获取验证码"),clearInterval(t),void h();40==e&&$(".send_verify_code_s").show(),n.find("em").html(e--+"s 后重新发送"),n.addClass("disabled")},1e3)};$.ajax({url:q.sendVerifyCode,type:"post",dataType:"jsonp",data:i}).done(function(e){1===e.code?(h(),a(60)):(2==e.code?(m("请输入图形验证码"),$("#con_login_user_tel .checkVerimg").show()):8==e.code||0==e.code?m(e.msg):m(e),c.trigger("click"))}).fail(function(e){m("发送失败，请重试"),a(0),$(this).removeClass("disable"),1===e.code?(h(),c.trigger("click"),a(60)):(2==e.code?(m("请输入图形验证码"),$("#con_login_user_tel .checkVerimg").show()):8==e.code||0==e.code?m(e.msg):m(e),c.trigger("click"))})}),$("#send_verify_code_tel_s .voice_a").on("click",function(e){if($(this).hasClass("disabled"))return!1;var t={telNum:{value:$(".users_tel").val(),pattern:{value:N,hint:"请输入有效的手机号码"}}},n=w(t);if(1!=n)return m(n),!1;var i={phone:$(".users_tel").val()};if(0<$("#con_login_user_tel .checkVerimg").length&&""!=$("#con_login_user_tel .checkVerimg input").val()&&(i.code=$("#con_login_user_tel .checkVerimg input").val(),$("#con_login_user_tel").find(".checkVerimg").removeClass("border-red")),!$("#con_login_user_tel .checkVerimg input").val())return m("请输入图形验证码"),$("#con_login_user_tel").find(".checkVerimg").addClass("border-red"),!1;$.ajax({url:q.sendVerifyVoiceCode,type:"post",dataType:"jsonp",data:i}).done(function(e){1===e.code?(h(),$("#send_verify_code_tel_s").hide(),m("验证码将以电话的形式的通知到您，请注意接听")):(2==e.code?(m("请输入验证码"),$("#send_verify_code_tel .checkVerimg").show()):8==e.code||0==e.code?m(e.msg):m(e),c.trigger("click"))}).fail(function(e){e.code=1,m("发送失败，请重试"),$(this).removeClass("disable"),1===e.code?h():2==e.code?(m("请输入验证码"),$("#send_verify_code_tel .checkVerimg").show()):8==e.code||0==e.code?m(e.msg):m(e),c.trigger("click")})}),$("#send_verify_code_forget").on("click",function(e){if($(this).hasClass("disabled"))return!1;window.$ULOG&&$ULOG.send("10445");var t={telNum:{value:$(".user_forget_phone").val(),pattern:{value:N,hint:"请输入有效的手机号码"}}},n=w(t);if(1!=n)return b(n),!1;var i={phone:$(".user_forget_phone").val()};if(0<$("#con_forget_user_tel .checkVerimg").length&&""!=$("#con_forget_user_tel .checkVerimg input").val()&&(i.code=$("#con_forget_user_tel .checkVerimg input").val(),$("#con_forget_user_tel").find(".checkVerimg").removeClass("border-red")),!$("#con_forget_user_tel .checkVerimg input").val())return b("请输入图形验证码"),$("#con_forget_user_tel").find(".checkVerimg").addClass("border-red"),!1;var a=function(e){var t=null,n=$("#send_verify_code_forget"),i;t=setInterval(function(){if(e<=0)return n.removeClass("disabled"),n.find("em").html("重新获取验证码"),clearInterval(t),void _();40==e&&$("#send_verify_code_forget_s").show(),n.find("em").html(e--+"s 后重新发送"),n.addClass("disabled")},1e3)};$.ajax({url:q.sendVerifyCode+"?sendOn=exist",dataType:"jsonp",data:i}).done(function(e){1==e.code?(y(),a(60)):(8==e.code||0==e.code?b(e.msg):2==e.code?(b("请输入验证码"),$("#con_forget_user_tel .checkVerimg").show()):b(e),s.trigger("click"))}).fail(function(e){e.code=1,b("发送失败，请重试"),a(0),$(this).removeClass("disable"),1===e.code?(y(),a(60)):(2==e.code?(b("请输入验证码"),$("#con_forget_user_tel .checkVerimg").show()):8==e.code||0==e.code?b(e.msg):b(e),s.trigger("click"))})}),$("#send_verify_code_forget_s .voice_a").on("click",function(e){if($(this).hasClass("disabled"))return!1;var t={telNum:{value:$(".user_forget_phone").val(),pattern:{value:N,hint:"请输入有效的手机号码"}}},n=w(t);if(1!=n)return v(n),!1;var i={phone:$(".user_forget_phone").val()};if(0<$("#con_forget_user_tel .checkVerimg").length&&""!=$("#con_forget_user_tel .checkVerimg input").val()&&(i.code=$("#con_forget_user_tel .checkVerimg input").val(),$("#con_forget_user_tel").find(".checkVerimg").removeClass("border-red")),!$("#con_forget_user_tel .checkVerimg input").val())return b("请输入图形验证码"),$("#con_forget_user_tel").find(".checkVerimg").addClass("border-red"),!1;$.ajax({url:q.sendVerifyVoiceCode+"?sendOn=exist",type:"post",dataType:"jsonp",data:i}).done(function(e){1===e.code?(y(),$("#send_verify_code_forget_s").hide(),b("验证码将以电话的形式的通知到您，请注意接听")):(8==e.code||0==e.code?b(e.msg):2==e.code?(b("请输入验证码"),$("#con_forget_user_tel .checkVerimg").show()):b(e),s.trigger("click"))}).fail(function(e){b("发送失败，请重试"),$(this).removeClass("disable"),1===e.code?y():2==e.code?(m("请输入验证码"),$("#con_forget_user_tel .checkVerimg").show()):8==e.code||0==e.code?b(e.msg):b(e),s.trigger("click")})}),$("#send_verify_code_reg").on("click",function(e){if($(this).hasClass("disabled"))return!1;window.$ULOG&&$ULOG.send("10445");var t={telNum:{value:$(".users_reg").val(),pattern:{value:N,hint:"请输入有效的手机号码"}}},n=w(t);if(1!=n)return v(n),!1;var i={phone:$(".users_reg").val()};if(0<$("#con_login_user_reg .checkVerimg").length&&""!=$("#con_login_user_reg .checkVerimg input").val()&&(i.code=$("#con_login_user_reg .checkVerimg input").val(),$("#con_login_user_reg").find(".checkVerimg").removeClass("border-red")),!$("#con_login_user_reg .checkVerimg input").val())return v("请输入图形验证码"),$("#con_login_user_reg").find(".checkVerimg").addClass("border-red"),!1;var a=function(e){var t=null,n=$("#send_verify_code_reg"),i;t=setInterval(function(){if(e<=0)return n.removeClass("disabled"),n.find("em").html("重新获取验证码"),clearInterval(t),void _();40==e&&$("#send_verify_code_reg_s").show(),n.find("em").html(e--+"s 后重新发送"),n.addClass("disabled")},1e3)};$.ajax({url:q.sendVerifyCode+"?sendOn=noExist",dataType:"jsonp",data:i}).done(function(e){1==e.code?(_(),a(60)):(8==e.code||0==e.code?v(e.msg):2==e.code?(v("请输入验证码"),$("#con_login_user_reg .checkVerimg").show()):v(e),l.trigger("click"))}).fail(function(e){v("发送失败，请重试"),a(0),$(this).removeClass("disable"),1==e.code?(_(),a(60)):(0==e.code||8==e.code?v(e.msg):2==e.code?(v("请输入验证码"),$("#con_login_user_reg .checkVerimg").show()):v(e),l.trigger("click"))})}),$("#send_verify_code_reg_s .voice_a").on("click",function(e){if($(this).hasClass("disabled"))return!1;var t={telNum:{value:$(".users_reg").val(),pattern:{value:N,hint:"请输入有效的手机号码"}}},n=w(t);if(1!=n)return v(n),!1;var i={phone:$(".users_reg").val()};if(0<$("#con_login_user_reg .checkVerimg").length&&""!=$("#con_login_user_reg .checkVerimg input").val()&&(i.code=$("#con_login_user_reg .checkVerimg input").val(),$("#con_login_user_reg").find(".checkVerimg").removeClass("border-red")),!$("#con_login_user_reg .checkVerimg input").val())return v("请输入图形验证码"),$("#con_login_user_reg").find(".checkVerimg").addClass("border-red"),!1;$.ajax({url:q.sendVerifyVoiceCode+"?sendOn=noExist",type:"post",dataType:"jsonp",data:i}).done(function(e){1==e.code?(_(),$("#send_verify_code_reg_s").hide(),v("验证码将以电话的形式的通知到您，请注意接听")):8==e.code||0==e.code?(v(e.msg),l.trigger("click")):2==e.code?(v("请输入验证码"),$("#con_login_user_reg .checkVerimg").show()):(v(e),l.trigger("click"))}).fail(function(e){e.code=1,v("发送失败，请重试"),$(this).removeClass("disable"),1===e.code?_():2==e.code?(v("请输入验证码"),$("#con_login_user_reg .checkVerimg").show()):8==e.code||0==e.code?v(e.msg):v(e),l.trigger("click")})})}),$(".password-view").on("click",function(){var e=$(this).siblings("input");e.attr("type","password"==e.attr("type")?"text":"password")}),$(".checkVerimg").trigger("click"),{init:function(){function t(e){var t=$(".typeUserInfo");e&&e.displayName&&(e.displayName=$.encodeHTML($.getLimitString(e.displayName,20,"..")),$('[data-el="login"]').addClass("hide"),$('[data-el="user_box"]').removeClass("hide"),$('[data-el="user_box"] [data-el="userName"]').attr("href",i.env.userCenter).text(e.displayName),$('[data-el="logout_btn"]').attr("href",i.env.logout+"?service="+encodeURIComponent("https://www.lianjia.com/user/checklogin?redirect="+encodeURIComponent(location.href))))}$.listener.on("userInfo",function(e){t(e.data),e&&e.data&&e.data.mobile}),h()},openLoginDialog:M,openDialogRegister:U}}),define("module/top/index",["module/login/login","util/api"],function(){var e=require("module/login/login"),t=require("util/api");function n(e){return i.find('[data-el="'+e+'"]')}var i=$("#top"),a=n("login"),o=n("btn_login"),r=n("register"),s=n("user_box");return{login:$.noop,loginSuccess:function(e){a.addClass("hide"),s.removeClass("hide")},bind:function(){o.on("click",function(){e.openLoginDialog()}),r.on("click",function(){e.openDialogRegister()})},init:function(){this.bind(),e.init()}}}),define("module/footer/index",[],function(){function e(){$(".footer__middle").on("mouseover",'[data-el="parentList"] li a',function(){$('[data-el="parentList"] li a').removeClass("cur"),$(this).addClass("cur");var e=$(this).attr("data-index");$('ul[data-el="childrenList"]').hide(),$('ul[data-el="childrenList"]').eq(e).show()})}function t(){e()}return{init:t}}),define("util/validate",[],function(){return{isPhone:function(n){var e,i="";return[{reg:function(e){return 0<e.length},msg:"请输入手机号"},{reg:function(e){return 11===e.length},msg:"手机号须为11位"},{reg:/\d{11}/,msg:"手机号为纯数字"},{reg:/1\d{10}/,msg:"手机号须以1开头"}].some(function(e,t){if(!(e.reg.test&&e.reg.test(n)||$.isFunction(e.reg)&&e.reg(n)))return i=e.msg,!0}),i},isVarifyCode:function(n){var e,i="";return[{reg:function(e){return 6===e.length},msg:"验证码须为6位"},{reg:/\d{6}/,msg:"验证码为纯数字"}].some(function(e,t){if(!(e.reg.test&&e.reg.test(n)||$.isFunction(e.reg)&&e.reg(n)))return i=e.msg,!0}),i}}}),define("config/passport",[],function(){var t=config.passport_host;function e(e){return t+e}return{sendSms:e("/sendSms"),freshCaptch:e("/freshCaptch"),login:{getFirstTicket:e("/login?get-lt=true&isajax=true&type=2"),loginUrl:e("/login?type=2"),service:config.passport_service||"http://matrixapi.lianjia.com",setLoginUrl:location.protocol+"//"+location.host+"/cas/login"}}}),define("util/observer",[],function(){var e;return $({})}),define("module/login/index",["util/validate","config/passport","util/ajax","util/observer"],function(){var t=require("util/validate"),n=require("config/passport"),i=require("util/ajax"),a=require("util/observer");function e(e){return o.find('[data-el="'+e+'"]')}var o=$("#login"),r=e("phoneInput"),s=e("codeInput"),c=e("getCode"),l=e("popup"),d=e("imgCodeInput"),u=e("refeshImgCode"),f=e("picConfirm"),p=e("closePopup"),g=e("showError"),m=e("autoLogin"),h=e("submit"),v=e("shadow");function _(){return $.trim(r.val())}function b(e){return t.isPhone(e)}function y(){return $.trim(s.val())}function k(e){return t.isVarifyCode(e)}function w(){return $.trim(d.val())}function C(e){lianjiaCasManager.login({username:e.phone,code:e.code,_eventId:"submit"},function(e){(e=e&&e.data||{}).displayName?location.reload():I("登录失败，请重试")},function(e){I(e&&e.msg||"登录失败，请重试")})}function x(e,t){i({url:n.sendSms,dataType:"jsonp",data:{phone:e,code:t||""}}).done(function(e){1==(e=e||{}).code?(N.stop(),N.start()):2==e.code?(E.show(),E.refreshCode()):I(e.msg||"发送失败，请重试"),e.smsCode&&s.val(e.smsCode.code)}).fail(function(){I("发送失败，请重试")})}function I(e){g.text(e),g.removeClass("hide")}function S(){g.addClass("hide")}function j(){return{phone:_(),code:y(),isAuto:m.hasClass("login__check--checked")}}function L(e){var t=b(e.phone)||"";return t=t||k(e.code)}var N={t:null,start:function(){var e=59,t=0;function n(){59<=t?N.stop():(c.removeClass("enabled"),c.text(c.attr("data-tip")+"("+(59-t++)+")"))}n(),N.t=setInterval(n,1e3)},stop:function(){c.addClass("enabled"),c.text(c.attr("data-origin")),N.t&&clearInterval(N.t),N.t=null}},E={show:function(){l.removeClass("hide"),E.refreshCode()},hide:function(){l.addClass("hide")},refreshCode:function(){d.val(""),u.attr("src",n.freshCaptch+"?_="+ +new Date),d.focus()},bind:function(){u.on("click",function(){E.refreshCode()}),f.on("click",function(){var e=w();e&&(E.hide(),x(_(),e))}),p.on("click",function(){E.hide()})}};return{loginSuccess:function(e){},initConfig:function(){},bind:function(){var e=this;v.on("click",function(){e.hideBox()}),a.on("login",function(){e.showBox()}),c.on("click",function(){if(c.hasClass("enabled")){var e=b(_());e?I(e):(S(),x(_()),c.html()==c.attr("data-origin")?$ULOG.send(10793):$ULOG.send(10791))}}),m.on("click",function(){m.toggleClass("login__check--checked")}),h.on("click",function(){var e=j(),t=L(e);t?(I(t),$ULOG.send(10786,{action:{status:"failed"}})):(S(),C(e),$ULOG.send(10786,{action:{status:"success"}}))}),E.bind()},showBox:function(){o.removeClass("hide")},hideBox:function(){o.addClass("hide")},loginMsg:function(){var t=this;i({url:"/zufang/aj/userinfo",method:"get",dataType:"json"}).done(function(e){(e=(e=e||{}).data)&&e.displayName&&(window.__isLogin=!0,t.loginSuccess(e))})},init:function(){this.bind(),this.initConfig(),this.loginMsg()}}}),define("ui/suggest/index",[],function(){var c={};return function(i,$,b){String.trim||(String.prototype.trim=function(){for(var e,e,t=/\s/,n=(e=(e=this).replace(/^\s\s*/,"")).length;t.test(e.charAt(--n)););return e.slice(0,n+1)}),String.replaceTpl||(String.prototype.replaceTpl=function(n){return this.replace(/#\{([^}]*)\}/gm,function(e,t){return n[t.trim()]})}),String.htmlEncode||(String.prototype.htmlEncode=function(){return String(this).replace(/\x26/g,"&amp;").replace(/\x3c/g,"&lt;").replace(/\x3E/g,"&gt;").replace(/\x22/g,"&quot;").replace(/\x27/g,"&#39;").replace(/\xA9/g,"&copy;")});var a=" ",y=null,u=/<[^>]+>/g,e=document.documentElement.classList!==b,k=/\w/.test("İ"),o=k&&!i.XMLHttpRequest,w=$.documentMode&&9===$.documentMode,C=function(e){if(e){var t=e.split("."),n=t.length,i=window,a=0,o;if(1<n)for(;a<n-1;a++)o=t[a],i=0===a&&i[o]?i[o]:o in i?i[o]:i[o]={};return i}},l=e?function(e,t){return e.classList.contains(t)}:function(e,t){return-1<(a+e.className+a).indexOf(a+t+a)},f=e?function(e,t){e.classList.add(t)}:function(e,t){l(e,t)||(e.className+=(e.className?a:"")+t)},p=e?function(e,t){e.classList.remove(t)}:function(e,t){if(l(e,t)){var n=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(n,a)}},d=$.addEventListener?function(e,t,n){e.addEventListener(t,n,!1)}:function(e,t,n){e.attachEvent("on"+t,n)},g=function(e,t,n){d(e,t,function(e){var t=(e=e||i.event).srcElement||e.target;n.call(t,e)})},r=k?function(e,t){return t=t.replace(/\-(\w)/g,function(e,t){return t.toUpperCase()}),e.currentStyle[t]}:function(e,t){return $.defaultView.getComputedStyle(e,null).getPropertyValue(t)},t=function(e){for(var t=e+"=",n=document.cookie.split(";"),i=0;i<n.length;i++){for(var a=n[i];" "==a.charAt(0);)a=a.substring(1,a.length);if(0==a.indexOf(t))return a.substring(t.length,a.length)}return null},s=function(e,t){if(!(this instanceof s))return new s(e,t);var n=this;n.el=e+""===e?$.getElementById(e):e,n.el&&(n.o={classNameWrap:t.classNameWrap||"sug-wrap",classNameQuery:t.classNameQuery,classNameQueryNull:t.classNameQueryNull,classNameSelect:t.classNameSelect||"sug-select",classNameClose:t.classNameClose||"sug-close",classNameShim:t.classNameShim||"sug-shim",locAbs:t.locAbs||!1,pressDelay:t.pressDelay===b?3:t.pressDelay,autoFocus:t.autoFocus||!1,delay:t.delay||200,n:t.n||10,t:t.t||!0,autoCompleteData:t.autoCompleteData||!1,url:t.url||!1,charset:t.charset,callbackFn:t.callbackFn||!1,callbackName:t.callbackName||!1,callbackDataKey:t.callbackDataKey||!1,callbackDataNum:t.callbackDataNum||!1,requestQuery:t.requestQuery||!1,requestParas:t.requestParas||{},noSubmit:t.noSubmit||!1,onSelect:t.onSelect,onSearchDirect:t.onSearchDirect,onCheckForm:t.onCheckForm,onKeySelect:t.onKeySelect,onMouseSelect:t.onMouseSelect,onShow:t.onShow,onHide:t.onHide,onFill:t.onFill,onRequest:t.onRequest,onSucess:t.onSucess,onError:t.onError,onQueryChange:t.onQueryChange,onKeyEsc:t.onKeyEsc,customUrl:t.customUrl||!1,templ:t.templ||!1,autoCache:t.autoCache||!1},n.wrap=n.el.parentNode,n.init())},n=s.prototype;n.init=function(){var a=this,e=a.o;if(a.layoutInit(),a.reset(),a.inputHandle(),e.autoFocus&&setTimeout(function(){a.el.focus()},16),!e.autoCompleteData){var o=e.callbackFn,t=C(o,!0),n,i=o.split(".").pop();a.callback=function(e){e=e||{};var t=arguments.callee;(a=o&&t.repeat&&t.context||a).o.onSucess&&a.o.onSucess.call(a);var n=a.o.callbackDataKey||a.o.callbackDataNum,i=n?e[n]:e;if(!i||!i.length)return a.hide(1),void(a.isHide=!1);a.fill(e,a.q),a.show(),a.o.autoCache&&(a.cache[a.q]=e)},t[i]?t[i].repeat=!0:o&&(t[i]=a.callback)}},n.reset=function(e){var t=this,n;for(n in e)t.o[n]=e[n];t.cache={},t.q="",t.s=y,t.i=-1,t.val="",t.inputTimer(),t.isHide=!1,t.hide(1)},n.layoutInit=function(){var e=this,t=e.o,n=t.locAbs?$.body:e.wrap,i=e.sugWrap=$.createElement("div");if(e.el.setAttribute("autocomplete","off"),o){var a=e.shim=i.appendChild($.createElement("iframe"));a.src="about:blank",f(a,t.classNameShim),a.frameBorder=0,a.scrolling="no",e.content=i.appendChild(i.cloneNode(null))}else e.content=i;f(i,t.classNameWrap),!t.locAbs&&"static"===r(n,"position")&&(n.style.position="relative"),n.appendChild(i)},n.show=function(){this.sugWrap.style.display="",this.o.onShow&&this.o.onShow.call(this)},n.hide=function(e){var t=this;t.sugWrap.style.display="none",t.q=t.el.value,2!=e&&(t.s=y,t.i=-1),1==e&&t.fill(),t.o.onHide&&t.o.onHide.call(t)},n.holdFocus=function(e,t){t.preventDefault?t.preventDefault():e.onbeforedeactivate=function(){i.event.returnValue=!1,e.onbeforedeactivate=null}},n.inputTimer=function(e){var t=this,n=t.el,i=t.t,a;if(e){if(i||!t.o.autoCompleteData&&!t.o.url)return;t.t=setInterval(function(){if(!(a=n.value).trim())return t.o.onQueryChange&&t.o.onQueryChange.call(t),t.forceShow||t.hide(1),void(t.q=a);a!==t.q?t.updata(a):t.val=a,t.o.onQueryChange&&t.o.onQueryChange.call(t,!!a.trim())},t.o.delay)}else i&&clearInterval(t.t),t.t=0},n.getIndex=function(e,t){for(var n=t.length;n--;)if(t[n]===e)return n;return-1},n.matchEl=function(e,t,n){for(;e!==t;){if(n.call(e))return e;e=e.parentNode}return y},n.submitForm=function(){var e=this.el.form;e.onsubmit?e.onsubmit():(this.o.onCheckForm&&this.o.onCheckForm(e),e.submit())},n.keydownMove=function(e){var t=this,n=t.sugWrap.getElementsByTagName("OL")[0];if(n)if(t.isHide)t.isHide=!1;else{var i=n.getElementsByTagName("LI"),a=i.length,o=t.el,r=t.s,s=t.o,c=s.classNameSelect,l=t.q||"",d;r&&(p(r,c),t.i=t.getIndex(r,i),t.s=y),t.i===b&&(t.index=-1),-1!==t.i&&p(i[t.i],c),40===e?t.i++:38===e&&t.i--,-2===t.i?t.i=a-1:t.i===a?(o.value=l,t.i=-1):-1===t.i&&(o.value=l),-1!==t.i&&t.i!==a?(d=i[t.i],f(d,c),s.onKeySelect&&s.onKeySelect.call(t,d),!s.autoCompleteData&&(o.value=d.getAttribute("q").replace(u,"")),t.s=d):40!==e&&38!==e||s.onKeySelect&&s.onKeySelect.call(t,i[0],!0)}},n.inputHandle=function(){var i=this,a=i.o,o=i.el,e=o.form,r=i.sugWrap,t=a.classNameSelect,n=a.autoCompleteData,s=0,c;o.onkeypress=function(e){e=e||window.event,c=e.keyCode;var t=i.s?i.s.getElementsByTagName("a")[0]:null,n="";13===c&&t&&(n=t.getAttribute("href"),i.el.blur(),window.open(n),e.preventDefault?e.preventDefault():e.returnValue=!1)},o.onkeydown=function(e){if(e=e||window.event,27===(c=e.keyCode))return i.hide(2),r.getElementsByTagName("ol")[0]&&(i.isHide=!0),!n&&(o.value=i.q),i.inputTimer(),i.o.onKeyEsc&&i.o.onKeyEsc.call(i),!1;if(32<c&&c<41)o.value||"none"!==r.style.display?40!==c&&38!==c||(a.pressDelay&&0!=s++?s===a.pressDelay&&(s=0):(i.isHide&&i.show(),i.keydownMove(c),i.inputTimer()),!k&&e.preventDefault()):o.blur();else if(13===c){if(i.inputTimer(),i.hide(2),a.onSelect&&a.onSelect.call(i),i.s&&l(i.s,"sug-url")&&a.onSearchDirect&&a.onSearchDirect(i.s,o.value,i.val),n)return o.value=i.s?i.s.getAttribute("q").replace(u,""):"",i.o.onFill&&i.o.onFill.call(i),!1;if(a.noSubmit)return!1}else{if(8<c&&c<19)return void(9!==c&&i.holdFocus(o,e));i.inputTimer(1)}},d(o,"keyup",function(){s=0}),d(o,"blur",function(){i.hide(2),r.getElementsByTagName("ol")[0]&&(i.isHide=!0),i.inputTimer()}),g(r,"mouseover",function(){var e=i.matchEl(this,r,function(){return"LI"===this.tagName});e&&(i.s&&p(i.s,t),f(e,t),i.s=e)}),g(r,"mouseout",function(){var e=i.matchEl(this,r,function(){return"LI"===this.tagName});"LI"===this.tagName&&this!==e&&p(e,t)}),d(r,"mousedown",function(e){i.inputTimer(),i.holdFocus(o,e)}),g(r,"mouseup",function(e){var t=r.getElementsByTagName("OL")[0],n;if(!(!t||e.which&&2<e.which||e.button&&1!==e.button&&4!==e.button)&&(l(this,a.classNameClose)&&i.hide(),n=i.matchEl(this,r,function(){return"LI"===this.tagName}))){if(o.value=n.getAttribute("q").replace(u,""),i.hide(),i.inputTimer(),a.onSelect&&a.onSelect.call(i,n),i.i=i.getIndex(n,t.getElementsByTagName("LI")),i.o.onFill&&i.o.onFill.call(i),l(n,"sug-url"))return a.onSearchDirect&&a.onSearchDirect(n,o.value,i.val),!0;a.onMouseSelect&&a.onMouseSelect.call(i,n),!a.autoCompleteData&&!a.noSubmit&&i.submitForm()}})},n.fill=function(a,o){var e=this,t=e.content;if(arguments.length<2)t.innerHTML="";else{var r=e.o,n=r.templ,s=r.classNameQueryNull,c=r.classNameQuery;this.content.innerHTML=n?n.call(e,a,o):function(){a=a[r.callbackDataKey||r.callbackDataNum]||[];var e=0,t=Math.min(a.length,r.n),n=[],i;for(o=o.trim();e<t;e++)(i=a[e])!==b&&n.push('<li q="'+i+'"'+(s&&-1<i.indexOf(o)?"":" class="+s)+">"+(c?i.replace(o,'<span class="'+c+'">'+o+"</span>"):i)+"</li>");return"<ol>"+n.join("")+"</ol>"}()}},n.updata=function(e){var t=this,n=t.o.autoCompleteData||t.cache[e];if(t.q=e,t.i=-1,t.isHide=!1,n!==b){if(t.o.autoCompleteData&&!n.length)return;return t.fill(n,e),void t.show()}t.request(e)},n.request=function(e){var t=this,n=t.o,i=n.callbackFn,a=n.callbackName,o=n.onSucess,r=n.onError,s=n.onRequest,c=t.callback,l=encodeURIComponent,d=n.url,u=n.customUrl,f=n.requestParas,p=[],g,m;if(i){var h=C(i),v=i.split(".").pop();h[v]=t.callback,h[v].repeat&&(h[v].context=t)}else a&&((m=t.script).readyState?m.onreadystatechange=function(){"loaded"!=m.readyState&&"complete"!=m.readyState||(m.onreadystatechange=y,o&&o.call(t),c(a))}:m.onload=function(){o&&o.call(t),c(a)});if(r&&(t.script.onerror=function(){r.call(t)}),!t.script||!k||w){var _=$.getElementsByTagName("script")[0];(m=$.createElement("script")).type="text/javascript",m.async=!0,t.script?_.parentNode.replaceChild(m,t.script):_.parentNode.insertBefore(m,_),t.script=m}s&&s.call(this),f=function(){for(g in f)(m=f[g])!==b&&p.push(l(g)+"="+l(f[g]));return n.t&&p.push(l("t")+"="+l(+new Date)),p.join("&")}(),t.script.charset=n.charset?n.charset:"",t.script.src=u&&u.call(t,f)||d+"?"+n.requestQuery+"="+encodeURIComponent(e)+"&"+f,t.val=e},c=s}(window,document),c}),define("util/searchStore",[],function(){var t="ZUFANG"+(config&&config.cur_city_id?config.cur_city_id:""),n="localStorage";function a(){try{return window[n][t]&&JSON.parse(window[n][t])||null}catch(e){return null}}function o(e){try{window[n][t]=JSON.stringify(e)}catch(e){}}function i(n){var e=a()||[],i=[];i.push(n),$.each(e,function(e,t){t.id===n.id&&t.type===n.type||i.push(t)}),o(i=i.slice(0,50))}function e(){try{window[n].removeItem(t)}catch(e){}}return{get:function(){return a()},add:function(e){i(e)},clear:function(){e()}}}),define("util/checkLogin",["util/ajax"],function(){var e=require("util/ajax");function n(t,n){try{e({url:"/zufang/aj/userinfo",method:"get",dataType:"json"}).then(function(e){t(e)}).fail(function(e){n&&n(e)})}catch(e){console.log(e)}}return{checkLogin:function(e,t){n(e,t)}}}),define("util/cookie",[],function(){var t=/\+/g,f,e,n;function p(e){return f.raw?e:encodeURIComponent(e)}function g(e){return f.raw?e:decodeURIComponent(e)}function m(e){return p(f.json?JSON.stringify(e):String(e))}function i(e){0===e.indexOf('"')&&(e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return e=decodeURIComponent(e.replace(t," ")),f.json?JSON.parse(e):e}catch(e){}}function h(e,t){var n=f.raw?e:i(e);return $.isFunction(t)?t(n):n}return(f=e=function(e,t,n){if(1<arguments.length&&!$.isFunction(t)){if("number"==typeof(n=$.extend({},f.defaults,n)).expires){var i=n.expires,a=n.expires=new Date;a.setMilliseconds(a.getMilliseconds()+864e5*i)}return document.cookie=[p(e),"=",m(t),n.expires?"; expires="+n.expires.toUTCString():"",n.path?"; path="+n.path:"",n.domain?"; domain="+n.domain:"",n.secure?"; secure":""].join("")}for(var o=e?void 0:{},r=document.cookie?document.cookie.split("; "):[],s=0,c=r.length;s<c;s++){var l=r[s].split("="),d=g(l.shift()),u=l.join("=");if(e===d){o=h(u,t);break}e||void 0===(u=h(u))||(o[d]=u)}return o}).defaults={},{cookie:e,removeCookie:function(e,t){return $.cookie(e,"",$.extend({},t,{expires:-1})),!$.cookie(e)}}}),define("util/loadjs",[],function(){function e(e,t){$.getScript(e,function(){t&&t()})}return{load:e}}),define("module/search/index",["ui/suggest/index","util/observer","util/searchStore","util/api","util/ajax","util/checkLogin","util/cookie","util/loadjs"],function(){var e=require("ui/suggest/index"),t=require("util/observer"),c=require("util/searchStore"),i=$("#search"),l=i.find('[data-el="input"]'),a=i.find('[data-el="button"]'),n=require("util/api"),r=require("util/ajax"),o=require("util/checkLogin"),s=require("util/cookie"),d=require("util/loadjs"),u,f=g_conf.resblockid,p={code:0,ucid:""},g=null;function m(e){g=new LianjiaIM({appid:imConf.imAppid,appkey:imConf.imAppkey,is_ljbb:!1,is_bkbb:!0,token:s.cookie("lianjia_token"),userData:e,downAppUrl:" ",appDesc:" ",staticRoot:"https://s1.ljcdn.com/feroot/?_v=20180131223836909"})}function h(){var n=e(l[0],{classNameWrap:"sug-search",classNameQuery:"sug-query",classNameSelect:"sug-select",delay:80,n:10,autoFocus:!1,requestQuery:"query",requestParas:{callback:"SearchSug2015",city_id:config.cur_city_id,channel:"rent"},url:"/zufang/ajax/sug",callbackFn:"SearchSug2015",callbackDataKey:"data",noSubmit:!0,autoCache:!0,onMouseSelect:function(e){e&&l.attr("data-json",e.getAttribute("data-json")),t.trigger("submit_input",{channel:"mouse"})},onSucess:function(){l.attr("data-json","")},onSelect:function(e){e||t.trigger("submit_input",{channel:"enter"})},onKeySelect:function(e,t){e&&!t?l.attr("data-json",e.getAttribute("data-json")):l.attr("data-json","")},onQueryChange:function(e){if(void 0===e&&!n.forceShow){var t=c.get();t&&t.length&&(t[0].isHistory=!0,n.fill({data:t},""),n.show(),n.forceShow=!0)}void 0!==e&&(n.forceShow=!1)},templ:function(e,t){var n=e.data||[],i=[],a=0,o="",r=Math.min(10,n.length),s=!1;for(r&&(s=n[0].isHistory,delete n[0].isHistory,s?i.push('<p>搜索历史<span class="fr pointer" data-el="clearHistory">清空搜索历史</span></p>'):i.push("<p>你可能在找</p>"));a<r;a++)o="<li data-json='",o+=JSON.stringify(n[a]),o+="' data-event_id='"+(s?10798:10799)+"' data-event_action='target="+n[a].uri,o+="' data-origin='"+t+"' q='",o+=n[a].name,o+="'><span class='fl oneline ui--suggest__oneline ",o+=s?"ui--suggest__oneline--long":"",o+="'>",o+=t?'<span class="ui--suggest__hl">'+n[a].name.replace(t,'<span class="ui--suggest__em">'+t+"</span>")+"</span>":'<span class="ui--suggest__hl">'+n[a].name+"</span>",o+='<span class="ui--suggest__light">',n[a].alias&&(o+=t?"（"+n[a].alias.replace(t,'<span class="ui--suggest__em">'+t+"</span>")+"）":"（"+n[a].alias+"）"),o+=t?(n[a].sub_title||"").replace(t,'<span class="ui--suggest__em">'+t+"</span>"):n[a].sub_title,o+="</span></span>",s||(o+='<span class="fr ui--suggest__aside">约'+n[a].count+"套在租"),o+="</li>",i.push(o);return"<ol>"+i.join("")+"</ol>"}});l.on("focus",function(){if($.trim(l.val()))n.forceShow=!1;else{var e=c.get();e&&e.length&&(e[0].isHistory=!0,n.fill({data:e},""),n.show(),n.forceShow=!0)}}),a.on("click",function(){t.trigger("submit_input",{channel:"button"})}),t.on("submit_input",function(e,t){var n=l.attr("data-json"),i=$.trim(l.val()),a=n&&$.parseJSON(n),o=encodeURIComponent(i),r="",s={};a?(r=a.uri,$.extend(s,a)):(r="/zufang/rs"+o+"/",$.extend(s,{name:i,id:i,type:"query",uri:r,sub_title:"",alias:"",count:""})),i&&c.add(s),$ULOG.send(10800,{action:{search_condition:r}}),location.href=r}),i.on("click",'[data-el="clearHistory"]',function(){c.clear(),n.hide(1),n.forceShow=!1}),$('[data-el="callIM_agent"]').on("click",function(){var e=$(this).attr("data-type"),t=$(this).attr("data-port"),n=$(this).attr("data-houseName"),i=$(this).attr("data-event_action");$ULOG.send(13753,{action:{Resblock_id:f,Agent_ucid:u,e_plan:i}});var a={ucid:u,port:t,msgPayload:"您好,我想咨询"+n+"的相关信息"};i&&(a.extends=JSON.stringify({app_data:JSON.stringify({business_dig_v:i})})),o.checkLogin(function(e){e&&e.data&&e.data.id?g&&(p.ucid!=e.data.id?(p.code=1,p.ucid=e.data.id+"",m(p),setTimeout(function(){g.initTalk(a)},2e3)):g.initTalk(a)):$('[data-el="btn_login"]').trigger("click")},function(){$('[data-el="btn_login"]').trigger("click")})})}function v(){var n=$('[data-el="updatePhone"]'),e=n.attr("data-ucid"),t="diaoding",i=$("#card_agent"),a=n.attr("data-digv"),o;e&&r({url:"/zufang/aj/recommendAgent/brokers",dataType:"json",data:{position:t,ucid:e,dig_v:a}}).then(function(e){if(e=e&&e.data){var t=e.agent_phone.replace(",","转");n.html(t),u=e.agent_ucid,b()}})}function _(){var e=$('[data-el="callIM_agent"]').eq(0),t=e&&$(e).attr("data-brand");d.load(n.env.LianjiaIM,function(){o.checkLogin(function(e){e&&e.data&&e.data.id&&p.ucid!=e.data.id&&(p.code=1,p.ucid=e.data.id+"",m(p))})})}function b(){var e,t=$('[data-el="callIM_agent"]').attr("data-event_action"),n;$("#card_agent")&&$ULOG.send(13751,{action:{Resblock_id:f,Agent_ucid:u,e_plan:t}})}return{initIM:function(e){p.code=1,p.ucid=e.id+"",m(p)},init:function(){_(),h(),v()}}}),define("ui/slide/index",[],function(){function e(n,r){var t=function(){},o=function(e){setTimeout(e||t,0)},s={addEventListener:!!window.addEventListener,touch:"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch,transitions:function(e){var t=["transitionProperty","WebkitTransition","MozTransition","OTransition","msTransition"];for(var n in t)if(void 0!==e.style[t[n]])return!0;return!1}(document.createElement("swipe"))};if(n){var c=n.children[0],l,d,u,i;r=r||{};var f=parseInt(r.startSlide,10)||0,p=r.speed||300;r.continuous=void 0===r.continuous||r.continuous;var a=r.continuous,g=r.auto||0,e,m={},h={},v,_={handleEvent:function(e){switch(e.type){case"touchstart":this.start(e);break;case"touchmove":this.move(e);break;case"touchend":o(this.end(e));break;case"webkitTransitionEnd":case"msTransitionEnd":case"oTransitionEnd":case"otransitionend":case"transitionend":o(this.transitionEnd(e));break;case"resize":o($)}r.stopPropagation&&e.stopPropagation()},start:function(e){var t=e.touches[0];m={x:t.pageX,y:t.pageY,time:+new Date},v=void 0,h={},c.addEventListener("touchmove",this,!1),c.addEventListener("touchend",this,!1)},move:function(e){if(!(1<e.touches.length||e.scale&&1!==e.scale)){r.disableScroll&&e.preventDefault();var t=e.touches[0];h={x:t.pageX-m.x,y:t.pageY-m.y},void 0===v&&(v=!!(v||Math.abs(h.x)<Math.abs(h.y))),v||(e.preventDefault(),j(),r.continuous?(x(k(f-1),h.x+d[k(f-1)],0),x(f,h.x+d[f],0),x(k(f+1),h.x+d[k(f+1)],0)):(h.x=h.x/(!f&&0<h.x||f==l.length-1&&h.x<0?Math.abs(h.x)/u+1:1),x(f-1,h.x+d[f-1],0),x(f,h.x+d[f],0),x(f+1,h.x+d[f+1],0)))}},end:function(e){var t=+new Date-m.time,n=Number(t)<250&&20<Math.abs(h.x)||Math.abs(h.x)>u/2,i=!f&&0<h.x||f==l.length-1&&h.x<0;r.continuous&&(i=!1);var a=h.x<0;v||(n&&!i?(f=a?(r.continuous?(C(k(f-1),-u,0),C(k(f+2),u,0)):C(f-1,-u,0),C(f,d[f]-u,p),C(k(f+1),d[k(f+1)]-u,p),k(f+1)):(r.continuous?(C(k(f+1),u,0),C(k(f-2),-u,0)):C(f+1,u,0),C(f,d[f]+u,p),C(k(f-1),d[k(f-1)]+u,p),k(f-1)),r.callback&&r.callback(f,l[f])):r.continuous?(C(k(f-1),-u,p),C(f,0,p),C(k(f+1),u,p)):(C(f-1,-u,p),C(f,0,p),C(f+1,u,p))),c.removeEventListener("touchmove",_,!1),c.removeEventListener("touchend",_,!1)},transitionEnd:function(e){parseInt(e.target.getAttribute("data-index"),10)==f&&(g&&S(),r.transitionEnd&&r.transitionEnd.call(e,f,l[f]))}};return $(),g&&S(),s.addEventListener?(s.touch&&c.addEventListener("touchstart",_,!1),s.transitions&&(c.addEventListener("webkitTransitionEnd",_,!1),c.addEventListener("msTransitionEnd",_,!1),c.addEventListener("oTransitionEnd",_,!1),c.addEventListener("otransitionend",_,!1),c.addEventListener("transitionend",_,!1)),window.addEventListener("resize",_,!1)):window.onresize=function(){$()},{setup:function(){$()},slide:function(e,t){j(),w(e,t)},prev:function(){j(),b()},next:function(){j(),y()},stop:function(){j()},getPos:function(){return f},getNumSlides:function(){return i},kill:function(){j(),c.style.width="",c.style.left="";for(var e=l.length;e--;){var t=l[e];t.style.width="",t.style.left="",s.transitions&&x(e,0,0)}s.addEventListener?(c.removeEventListener("touchstart",_,!1),c.removeEventListener("webkitTransitionEnd",_,!1),c.removeEventListener("msTransitionEnd",_,!1),c.removeEventListener("oTransitionEnd",_,!1),c.removeEventListener("otransitionend",_,!1),c.removeEventListener("transitionend",_,!1),window.removeEventListener("resize",_,!1)):window.onresize=null}}}function $(){f=0,l=c.children,i=l.length,l.length<2?r.continuous=!1:r.continuous=a,s.transitions&&r.continuous&&l.length<3&&(c.appendChild(l[0].cloneNode(!0)),c.appendChild(c.children[1].cloneNode(!0)),l=c.children),d=new Array(l.length),u=n.getBoundingClientRect().width||n.offsetWidth,c.style.width=l.length*u+"px";for(var e=l.length;e--;){var t=l[e];t.style.width=u+"px",t.setAttribute("data-index",e),s.transitions&&(t.style.left=e*-u+"px",C(e,e<f?-u:f<e?u:0,0))}r.continuous&&s.transitions&&(C(k(f-1),-u,0),C(k(f+1),u,0)),s.transitions||(c.style.left=f*-u+"px"),n.style.visibility="visible"}function b(){r.continuous?w(f-1):f&&w(f-1)}function y(){r.continuous?w(f+1):f<l.length-1&&w(f+1)}function k(e){return(l.length+e%l.length)%l.length}function w(e,t){if(f!=e){if(s.transitions){var n=Math.abs(f-e)/(f-e);if(r.continuous){var i=n;(n=-d[k(e)]/u)!==i&&(e=-n*l.length+e)}for(var a=Math.abs(f-e)-1;a--;)C(k((f<e?e:f)-a-1),u*n,0);e=k(e),C(f,u*n,t||p),C(e,0,t||p),r.continuous&&C(k(e-n),-u*n,0)}else e=k(e),I(f*-u,e*-u,t||p);f=e,o(r.callback&&r.callback(f,l[f]))}}function C(e,t,n){x(e,t,n),d[e]=t}function x(e,t,n){var i=l[e],a=i&&i.style;a&&(a.webkitTransitionDuration=a.MozTransitionDuration=a.msTransitionDuration=a.OTransitionDuration=a.transitionDuration=n+"ms",a.webkitTransform="translate("+t+"px,0)translateZ(0)",a.msTransform=a.MozTransform=a.OTransform="translateX("+t+"px)")}function I(t,n,i){if(i)var a=+new Date,o=setInterval(function(){var e=+new Date-a;if(i<e)return c.style.left=n+"px",g&&S(),r.transitionEnd&&r.transitionEnd.call(event,f,l[f]),void clearInterval(o);c.style.left=(n-t)*(Math.floor(e/i*100)/100)+t+"px"},4);else c.style.left=n+"px"}function S(){e=setTimeout(y,g)}function j(){g=0,clearTimeout(e)}}return e}),define("module/detail_content/gslide",["util/observer"],function(){var e=require("util/observer"),n='<div class="gslide hide" id="gslide">  <p class="gslide--close noselect" data-el="close"></p>  <p class="gslide--left noselect" data-el="prev"></p>  <p class="gslide--right noselect" data-el="next"></p>  <p class="gslide--list">    <img src="<%=data[defaultIndex]%>" data-el="img">  </p>  <p class="gslide--tip"><span data-el="curIndex"><%=(parseInt(defaultIndex) + 1)%></span>/<%=data.length%></p>  <div class="gslide--snap" data-el="snapOuter">    <div data-el="snapWrapper">      <%snap.forEach(function(v, k) {%>        <span class="<%=(k == defaultIndex ? \'selected\' : \'\')%>" data-el="snap" data-index="<%=k%>" data-src="<%=data[k]%>">          <img src="<%=v%>">        </span>      <%});%>    </div>  </div></div>',t=!1,i={hasInit:!1,$el:null,count:0,curIndex:0,$img:null,$num:null,$snaps:null,init:function(e,t){var a=[],o=[];e.each(function(e,t){var n=$(this).find("img"),i=n.attr("data-src")||n.attr("src");a.push(i.replace("672x504.jpg","800x600.jpg")),o.push(i.replace("672x504.jpg","48x36.jpg"))}),$(document.body).append($.tpl(n,{data:a,snap:o,defaultIndex:parseInt(t,10)})),i.curIndex=parseInt(t,10),i.count=a.length,i.$el=$("#gslide"),i.getImg(),i.$num=i.$el.find('[data-el="curIndex"]'),i.$snaps=i.$el.find('[data-el="snap"]'),i.bind()},getImg:function(){i.$img=i.$el.find('[data-el="img"]')},on:function(e,t){i.$el.on("click",'[data-el="'+e+'"]',function(e){t.apply(this)})},bind:function(){i.on("close",function(){e.trigger("gslide_close",[i.curIndex]),setTimeout(function(){i.hide()},10)}),i.on("prev",function(){i.jump(null,-1)}),i.on("next",function(){i.jump(null,1)}),i.on("img",function(){i.jump(null,1)}),i.on("snap",function(){var e=$(this),t=e.attr("data-src"),n=parseInt(e.attr("data-index"),10);e.hasClass("selected")||i.jump(n)})},hide:function(){i.$el.addClass("hide")},scrolltoView:function(e){var t=e.get(0);t.scrollIntoViewIfNeeded?t.scrollIntoViewIfNeeded():t.scrollIntoView()},jump:function(e,t){var n=i.curIndex;null===e?(n+=t)<0?n=i.count-1:n>=i.count&&(n=0):n=e,i.curIndex=n,i.$snaps.removeClass("selected"),i.$snaps.eq(n).addClass("selected"),12<i.count.length&&i.scrolltoView(i.$snaps.eq(n)),i.$img.attr("src",i.$snaps.eq(n).attr("data-src")),i.getImg(),i.$num.text(n+1)},show:function(e){i.jump(parseInt(e,10)),i.$el.removeClass("hide")},click:function(e,t){i.hasInit||(i.init(e,t),i.hasInit=!0),i.show(t)}};return{init:function(e,t){i.click(e,t)}}}),define("util/storage",[],function(){function e(e,t){localStorage.setItem(e,t)}function t(e){return localStorage.getItem(e)}function n(e){localStorage.removeItem(e)}function i(e,t){sessionStorage.setItem(e,t)}function a(e){return sessionStorage.getItem(e)}function o(e){sessionStorage.removeItem(e)}return{setSessionStorage:i,getSessionStorage:a,clearSessionStorage:o,setStorage:e,getStorage:t,clearStorage:n}}),define("module/detail_content/index",["ui/slide/index","util/observer","module/detail_content/gslide","module/top/index","util/storage"],function(){var a=require("ui/slide/index"),e=require("util/observer"),t=require("module/detail_content/gslide"),n=require("module/top/index"),i=require("util/storage"),c=document.getElementById("mySwipe"),l=$(c),d=l.find('[data-el="slideItem"]'),u=null,o=$("#prefix");function r(){var o=l.find('[data-el="prefix"]'),r=o.children(),s=r.length,e=l.find('[data-el="prev"]'),t=l.find('[data-el="next"]');function n(e){var t=140,n=$('[data-el="prefix"]').parent().width(),i=Math.floor(n/t)-1;o.find(".active").removeClass("active"),r.eq(e%s).addClass("active");var a=0;1+i<s&&(a=i<e&&e<s-1?"-"+Math.abs(t*(e+2)-n)+"px":e==s-1?"-"+Math.abs(t*(e+1)-n)+"px":0,o.css("left",a))}function i(e){var t=$(e);if(t.length){var n=t.find('[data-el="lazy-img"]'),i=n.attr("data-src");i&&(n.attr("src",i),n.attr("data-src",""))}}u=a(c,{auto:!1,continuous:!0,callback:function(e,t){var n=$(t);i(n),i(n.prev()),i(n.next())},transitionEnd:function(e,t){n(e)}}),i(d.last()),i(d.eq(1)),e.on("click",function(){u.prev()}),t.on("click",function(){u.next()})}function s(){$("#aside").on("click",'[data-el="allAgent"]',function(){e.trigger("detail__list--open")}),$("#desc").on("click",'[data-el="commentShowMore"]',function(){$('[data-el="houseComment"]').removeClass("threeline"),$('[data-el="houseComment"]').css("max-height","none");var e=$('[data-el="houseComment"]').attr("data-desc");$('[data-el="houseComment"]').html(e),$(this).addClass("hide")}),$("#deal").on("click",'[data-el="showMore"]',function(){$(this).parent().find(".hide").removeClass("hide"),$(this).addClass("hide")}),o.on("click","li",function(){var e=$(this).attr("data-index");u.slide(e)}),$(document.body).on("click",'[data-el="showReportBox"]',function(){window.__isLogin?e.trigger("page__report"):$('[data-el="btn_login"]').trigger("click")}),l.on("click",'[data-el="slideItem"]',function(){t.init(d,$(this).attr("data-index"))}),e.on("gslide_close",function(e,t){u.slide(t,1)})}function f(){var e=$('[data-el="commentShowMore"]'),t=$('[data-el="houseComment"]').attr("data-desc"),n=t&&t.split("<br />");t&&(140<t.length||4<n.length||4==n.length&&$.trim(n[3]))?($('[data-el="houseComment"]').html(t.substring(0,140)+"…"),$('[data-el="houseComment"]').addClass("threeline"),e.show()):e.hide()}return{init:function(){r(),f(),n.init(),s()}}}),define("config/map",[],function(){var e;return{ak:"dASz7ubuSpHidP1oQWKuAK3q",mapAround:[{key:"地铁站",value:"地铁",ico:"station"},{key:"公交站",value:"公交",ico:"bus"},{key:"学校",value:"学校",ico:"school"},{key:"医院",value:"医院",ico:"hospital"},{key:"银行",value:"银行",ico:"bank"},{key:"餐厅",value:"餐饮",ico:"rest"},{key:"商场|超市",value:"购物",ico:"shop"}],radius:1200}}),define("util/map",["config/map"],function(){var t=require("config/map"),n=[],i=!1;function e(){var e=document.createElement("script");e.src="//api.map.baidu.com/api?v=2.0&ak="+t.ak+"&callback=__mapInitialize",document.body.appendChild(e)}function a(){i||e()}return window.__mapInitialize=function(){i=!0,$.each(n,function(e,t){t()})},{init:function(){e()},ready:function(e){a(),i?e():n.push(e)}}}),define("util/isInView",[],function(){function e(e,t){var n=e.getBoundingClientRect();return t=t||0,n.top<=window.innerHeight+t&&0<=n.bottom}return e}),define("module/detail_map/index",["util/map","config/map","util/isInView"],function(){var e=require("util/map"),t=require("config/map"),n=require("util/isInView"),i='<div class="content__map--overlay">  <ul class="content__map--overlay__nav">  <%$.each(data, function(k, v) {%>    <li data-el="navItem" data-key="<%=v.key%>" data-classname="<%=v.ico%>" class="<%=(k == 0 ? \'cur\' : \'\')%>">      <i class="<%=v.typ%> <%=v.ico%>"></i>      <%=v.value%>    </li>  <%});%>  </ul>  <ul class="content__map--overlay__list" data-el="list">  </ul></div>',a='<%if(data.length) {%>  <%$.each(data, function(k, v) {%>  <li data-index=<%=k%> data-el="listItem">    <p class="map--overlay__list--title" title="<%=v.name%>"><%=v.shortName%><span><%=v.distance%>m</span></p>    <p class="map--overlay__list--subtitle"><%=v.address%></p>  </li>  <%});%><%} else {%>  <li class="empty">当前周边无相关设施</li><%}%>',o='<span data-index=<%= k %> class="map__mark" data-el="mapMark" data-coord=\'<%=JSON.stringify(data)%>\' title="<%=data.name%>">  <i class="<%= classname %>"></i>  <span class="map__mark--button"><%=data.shortName%><span><%=data.distance%>m</span></span></span>',r=$("#map"),s=r.parent(),c={mapInstance:null,cacheResult:{}},l=null;function d(e,t){l&&clearTimeout(l),l=setTimeout(function(){n(e)?t():d(e,t)})}function u(){var e='<div class="map__cur" data-el="cur" data-coord=\''+JSON.stringify(c.centerPoint)+"'>"+c.name+'<i class="arrow"></i></div>';c.mapInstance.centerAndZoom(c.point,15);var t={position:c.point,offset:new BMap.Size(-7*(c.name.length+2),-61)},n=new BMap.Label(e,t);n.setStyle({border:0,padding:0,backgroundColor:"transparent"}),c.mapInstance&&c.mapInstance.addOverlay(n)}function f(){s.append($.tpl(i,{data:t.mapAround}))}function p(){var n=[];$.each(g_conf.subway,function(e,t){n.push({name:t.name,shortName:t.name,address:t.lines.join("; "),distance:t.distance,coord:{lon:t.point_lng,lat:t.point_lat}})}),c.cacheResult[s.find('[data-el="navItem"]').eq(0).attr("data-key")]=n}function g(){d(r[0],function(){e.ready(function(){c.mapInstance=new BMap.Map(r.attr("id"),{enableMapClick:!1}),c.centerPoint=g_conf.coord,c.mapInstance.addControl(new BMap.NavigationControl({type:BMAP_NAVIGATION_CONTROL_LARGE,offset:new BMap.Size(19,78)})),c.name=g_conf.name,c.point=new BMap.Point(c.centerPoint.longitude,c.centerPoint.latitude),u(),f(),p(),setTimeout(function(){s.find('[data-el="navItem"]').eq(0).trigger("click")},200)})})}function m(){if(c.cacheResult[c.keyword]&&c.cacheResult[c.keyword].length)b(c.cacheResult[c.keyword]);else{var e=c.keyword.split("|");c.bdLocalSearch=new BMap.LocalSearch(c.mapInstance),c.bdLocalSearch.searchNearby(e,c.point,t.radius),c.bdLocalSearch.setSearchCompleteCallback(function(e){var i=[];c.bdLocalSearch.getStatus()==BMAP_STATUS_SUCCESS&&$.each(e,function(e,t){for(var n=0;n<t.getCurrentNumPois();n++)i.push(t.getPoi(n))}),(i=_(i=v(i))).sort(function(e,t){return e.distance>t.distance?1:-1}),c.cacheResult[c.keyword]=i,b(c.cacheResult[c.keyword])})}}var h={el:function(){return s.find('[data-el="list"]')},renderList:function(e){h.el().html($.tpl(a,{data:e||[]}))},clearList:function(){h.el().html("")}};function v(e){var n=[];return $.each(e,function(e,t){t.title&&t.address&&t.point&&n.push({name:t.title,address:t.address,shortName:14<t.title.length?t.title.slice(0,12)+"...":t.title,distance:0,coord:{lon:t.point.lng,lat:t.point.lat}})}),n}function _(e){var t=e,a=new BMap.MercatorProjection,o=a.lngLatToPoint(c.point);return $.each(t,function(e,t){var n=a.lngLatToPoint(new BMap.Point(t.coord.lon,t.coord.lat)),i=Math.round(Math.sqrt(Math.pow(o.x-n.x,2)+Math.pow(o.y-n.y,2)));t.distance=i}),t}function b(e){h.renderList(e),c.mapInstance.clearOverlays(),y(e)}function y(e){u(c.centerPoint,c.mapInstance),$.each(e,function(e,t){var n=$.tpl(o,{data:t,k:e,classname:c.classname}),i=new BMap.Label(n,{position:new BMap.Point(t.coord.lon,t.coord.lat),offset:new BMap.Size(-8,-30),enableMassClear:!0});i.setStyle({border:0,padding:0,backgroundColor:"transparent"}),c.mapInstance&&c.mapInstance.addOverlay(i)})}function k(e){s.find('[data-el="listItem"]').removeClass("cur"),s.find('[data-el="mapMark"]').each(function(e,t){$(this).parent().removeClass("map__mark--cur")}),s.find('[data-el="listItem"][data-index="'+e+'"]').addClass("cur"),s.find('[data-el="mapMark"][data-index="'+e+'"]').parent().addClass("map__mark--cur"),w(e)}function w(e){var t=JSON.parse(s.find('[data-el="mapMark"][data-index="'+e+'"]').attr("data-coord")).coord,n=s.find('[data-el="listItem"][data-index="'+e+'"]').get(0),i=new BMap.Point(t.lon,t.lat),a;1!=c.mapInstance.getBounds().containsPoint(i)&&(c.mapInstance.setViewport([i]),c.mapInstance.setZoom(15)),n.scrollIntoViewIfNeeded?n.scrollIntoViewIfNeeded():n.scrollIntoView()}function C(e,t){s.find('[data-el="listItem"]').removeClass("hover"),s.find('[data-el="mapMark"]').each(function(e,t){$(this).parent().removeClass("map__mark--hover")}),t||(s.find('[data-el="listItem"][data-index="'+e+'"]').addClass("hover"),s.find('[data-el="mapMark"][data-index="'+e+'"]').parent().addClass("map__mark--hover"))}function x(){r.on("click",'[data-el="cur"]',function(){var e=JSON.parse($(this).attr("data-coord")),t=new BMap.Point(e.longitude,e.latitude);c.mapInstance.panTo(t,15)}),s.on("click",'[data-el="navItem"]',function(){var e=$(this);c.keyword=e.attr("data-key"),c.classname=e.attr("data-classname"),e.parent().find(".cur").removeClass("cur"),e.addClass("cur"),h.clearList(),m()}),s.on("click",'[data-el="mapMark"]',function(){var e;k($(this).attr("data-index"))}),s.on("mouseenter",'[data-el="mapMark"]',function(){var e;C($(this).attr("data-index"))}).on("mouseleave",'[data-el="mapMark"]',function(){var e;C($(this).attr("data-index"),!0)}),s.on("click",'[data-el="listItem"]',function(){var e;k($(this).attr("data-index"))}),s.on("mouseenter",'[data-el="listItem"]',function(){var e;C($(this).attr("data-index"))}).on("mouseleave",'[data-el="listItem"]',function(){var e;C($(this).attr("data-index"),!0)})}return{init:function(){g(),x()}}}),define("module/detail_fixed/index",[],function(){var o=$("#fixed"),e=$("#aside"),t=$("#asideFixed"),n=[],i,a=$("#map"),r=0;function s(e,t){var n=e.getBoundingClientRect();t=t||0;var i="below";return i=n.top>=window.innerHeight+t?"below":n.top<=window.innerHeight+t&&0<=n.bottom?"in":"top"}function c(){o.on("click",'[data-el="fixedNavItem"]',function(){var e=$(this).attr("data-href");o.find(".cur").removeClass("cur"),$(this).addClass("cur"),$("#"+e).get(0).scrollIntoView()})}function l(e){1===e&&t.show().addClass("content__aside--fixed")}function d(e){o.removeClass("hide"),t.show(),l(e)}function u(e){o.addClass("hide"),t.hide()}function f(e){var t,n="top"==s(i=i||$("#"+e).get(0))?1:0;r===n?l(r):1===(r=n)?d(r):u(r)}function p(){$.each(n,function(e,t){var n;if($("#"+t).get(0).getBoundingClientRect().top<=60){var i=o.find(".cur"),a=o.find('[data-el="fixedNavItem"][data-href="'+t+'"]');return i[0]!==a[0]&&(i.removeClass("cur"),a.addClass("cur")),!1}})}function g(e){setTimeout(function(){f(e),g(),p()},50)}return{init:function(e){o.find('[data-el="fixedNavItem"]').each(function(){n.push($(this).attr("data-href"))}),n.reverse(),c(),g(e)}}}),define("module/detail_globallist/index",["util/observer"],function(){var e=require("util/observer"),t=$("#globalList");function n(){e.on("detail__list--close",function(){t.addClass("hide")}),e.on("detail__list--open",function(){t.removeClass("hide")}),t.on("click",'[data-el="shadow"]',function(){e.trigger("detail__list--close")}),t.on("click",'[data-el="close"]',function(){e.trigger("detail__list--close")})}return{init:function(){n()}}}),define("module/detail_report/index",["util/ajax","util/observer"],function(){var t=require("util/ajax"),n=require("util/observer"),i='<div class="popbox" id="popbox">  <div class="popbox--bg" data-el="shadow"></div>  <div class="popbox__container">    <span class="popbox--close" data-el="close"></span>    <div class="popbox__container">      <p class="popbox__nav"><span class="cur popbox__nav--item" data-el="nav" data-target="one">举报</span>\x3c!-- <span class="popbox__nav--item" data-el="nav" data-target="two">反馈</span> --\x3e<span class="popbox__nav--tips" data-el="one" data-typ="nav">房源是否有问题？请告诉我们，我们会在第一时间解决。</span></p>      <div class="popbox__one" data-el="one" data-typ="nav">        <p class="popbox__tip" data-el="errorShow">&nbsp;</p>        <p class="popbpx__between"><span class="popbox__aside">举报原因<i>*</i></span><span data-el="checkWrapper"></span></p>        <p class="popbpx__between popbpx__text--container"><span class="popbox__aside">备注：</span><textarea class="popbox__text" data-el="input" placeholder="请您详细描述您的举报理由，以便工作人员更好的判断。字数请控制在100个字以内。" maxlength="100"></textarea></p>        <p class="popbox__button" data-el="button">提交反馈</p>      </div>      <div class="popbox__two hide" data-el="two" data-typ="nav">        <p class="popbox__desc">产品使用有问题？加入用户反馈群，我们会在第一时间解决。群号：710878259</p>        <p class="popbox__icon"></p>      </div>    </div>  </div></div>',a=[],o=null,r=null;function s(){o.find('[data-el="input"]').val(""),o.find('.checked[data-el="checkbox"]').removeClass("checked")}function e(){var e=$(document.body);n.on("page__report",function(){o?(s(),o.removeClass("hide")):($(".wrapper").append($.tpl(i)),o=$("#popbox")),d()}),e.on("click",'#popbox [data-el="shadow"]',function(){o.addClass("hide")}).on("click",'#popbox [data-el="close"]',function(){o.addClass("hide")}).on("click",'#popbox [data-el="nav"]',function(){var e=$(this),t=e.attr("data-target");e.hasClass("cur")||(o.find('[data-typ="nav"]').addClass("hide"),e.parent().find('[data-el="nav"]').removeClass("cur"),e.addClass("cur"),o.find('[data-el="'+t+'"]').removeClass("hide"))}).on("click",'#popbox [data-el="checkbox"]',function(){$(this).toggleClass("checked")}).on("click",'#popbox [data-el="button"]',function(){var e=f();e.reason?c(e.reason):u(e.ret)})}function c(e){o.find('[data-el="errorShow"]').html(e),r&&clearTimeout(r),r=setTimeout(function(){o.find('[data-el="errorShow"]').html("&nbsp;")},1600)}function l(e){var n="";$.each(e,function(e,t){n+='<span data-el="checkbox" class="popbox__checkbox" data-key="'+t.key+'">'+t.title+"</span>"}),o.find('[data-el="checkWrapper"]').html(n)}function d(){a.length||t({url:"/zufang/aj/report/reasons",dataType:"json"}).then(function(e){(e=e&&e.data&&e.data.list)&&e.length&&($.each(e,function(e,t){a.push({key:t.desc,title:t.desc})}),l(a))})}function u(e){t({url:"/zufang/aj/report/house/"+g_conf.houseCode,method:"post",data:{comment:e.reason+(e.str?","+e.str:"")}}).then(function(e){0==e.status?o.addClass("hide"):c(e.msg||"提交失败，请重试")})}function f(){var e={reason:"",ret:{reason:[],str:""}},t=$.trim(o.find('[data-el="input"]').val());return t=t.replace(/\n/g,"").replace(/\r/g,""),e.ret.str=t,o.find('.checked[data-el="checkbox"]').each(function(){e.ret.reason.push($.trim($(this).attr("data-key")||$(this).text()))}),e.ret.reason.length||(e.reason="举报原因请最少选一个"),100<e.ret.str.length&&(e.reason="备注最多为100字，当前已超出限制"),e.ret.reason=e.ret.reason.join(","),e}return{init:function(){e()}}}),define("module/duty_pop/index",[],function(){function t(e){var t='<div class="pop-large" data-el="popLarge"><div class="pop-close" data-el="popLargeClose"></div><img src="'+e+'" class="pop-img"/></div>';$("body").append(t)}function n(){$('[data-el="dutyPic"]').on("click",function(){var e;t($(this).attr("src")),$('[data-el="popLarge"], [data-el="popLargeClose"]').on("click",function(){$(this).remove()})})}function e(e){n()}return{init:e}}),define("module/detail_agent/index",[],function(){var o=0,r=$("#agentList li"),s=$('[data-type="prevAgent"][data-el="switch"]'),c=$('[data-type="nextAgent"][data-el="switch"]');function e(){$('[data-el="switch"]').on("click",function(e){if(!$(this).hasClass("disable")){var t=$(this).attr("data-type"),n=r.length-3,i=Math.floor(n/3),a=0;if("nextAgent"===t&&o<i)++o===i&&$(this).addClass("disable"),s.removeClass("disable");else{if(!("prevAgent"===t&&0<o))return;0===--o&&$(this).addClass("disable"),c.removeClass("disable")}for(a=0;a<n;a++)a<3*o||3*o+3<=a?r.eq(a).css("display","none"):r.eq(a).css("display","inline-block")}})}return{init:function(){e()}}}),define("module/fix_right/kefu",[],function(){function e(e){var t=['<div class="m-kefu">','<div class="box">','<div class="close">×</div>','<div class="hd">官方客服</div>','<div class="bd">','<div class="text">您可以与在线顾问进行实时沟通或者拨打客服热线获得帮助</div>','<div class="item">','<span class="item-1">在线咨询</span>','<span class="item-2 zixun">立即咨询</span>','<span class="item-3 time">周一至周日 09:00-22:00</span>',"</div>",'<div class="item">','<span class="item-1">客服热线</span>','<span class="item-2 num">1010 9666</span>','<span class="item-3 time">周一至周日 09:00-20:00</span>',"</div>","</div>",'<div class="ft">',"<span>关闭</span>","</div>","</div>","</div>"].join("");$(document.body).on("click","#back-top .phone a",function(){$(".m-kefu").length?$(".m-kefu").show():$(document.body).append(t)}).on("click",".m-kefu .ft span, .m-kefu .close",function(){$(".m-kefu").hide()}).on("click",".m-kefu .zixun",function(){$(".m-kefu .close").click(),window.__isLogin?$(".lianjiaim .lianjiaim-body-item").first().find("tr").first().click():$(".btn-login").click()})}return e}),define("module/im/index",["util/api","util/checkLogin","util/cookie","util/loadjs","util/storage"],function(){var n=require("util/api"),o=require("util/checkLogin"),t=require("util/cookie"),i=require("util/loadjs"),r=require("util/storage"),s={code:0,ucid:""},c=null;function l(e){c=new LianjiaIM({appid:imConf.imAppid,appkey:imConf.imAppkey,is_ljbb:!0,is_bkbb:!1,token:t.cookie("lianjia_token"),userData:e,downAppUrl:" ",appDesc:" ",staticRoot:"https://s1.ljcdn.com/feroot/?_v=20180131223836909"})}function e(){var e=$('[data-el="callIM"]').eq(0),t=e&&$(e).attr("data-brand");i.load(n.env.LianjiaIM,function(){o.checkLogin(function(e){e&&e.data&&e.data.id&&s.ucid!=e.data.id&&(s.code=1,s.ucid=e.data.id+"",l(s))})})}function a(i,e){var t=(new Date).toLocaleDateString(),n=r.getStorage("IM_HOUSE_INFO")&&JSON.parse(r.getStorage("IM_HOUSE_INFO"))||{};n=n[i.houseId]||"";var a={ucid:i.agentUcid,port:i.port,push_content:i.title};a=t==n?e&&e.length?$.extend(a,{msgPayload:e}):a:e&&e.length?$.extend(a,{scheme:i.scheme,msgPayload:e}):$.extend(a,{scheme:i.scheme}),o.checkLogin(function(e){if(e&&e.data&&e.data.id){if(c){s.ucid!=e.data.id?(s.code=1,s.ucid=e.data.id+"",l(s),setTimeout(function(){c.initTalk(a)},2e3)):c.initTalk(a);var t={};t[i.houseId]=(new Date).toLocaleDateString();var n=$.extend(JSON.parse(r.getStorage("IM_HOUSE_INFO")),t);r.setStorage("IM_HOUSE_INFO",JSON.stringify(n))}}else $('[data-el="btn_login"]').trigger("click")},function(){$('[data-el="btn_login"]').trigger("click")})}function d(){$('[data-el="callIM"]').on("click",function(){var e,t="layout"==$(this).data("type")?$(this).attr("data-id")+getParams.getParams("layout_id"):$(this).attr("data-id"),n;a({agentUcid:$(this).attr("data-im_id"),houseId:t,houseType:$(this).attr("data-type"),scheme:"lianjiaim://rentplat/httpreq?cardID=2&id="+$(this).attr("data-id")+"&idType=rent_plat_c&cardType="+$(this).attr("data-type"),port:$(this).attr("data-port"),title:$(this).attr("data-title")})}),$('[data-el="send-im"]').on("click",function(){var e,t;a({agentUcid:$(this).parent().data("im_id"),houseId:$(this).parent().data("id"),houseType:$(this).parent().data("type"),scheme:"lianjiaim://rentplat/httpreq?cardID=2&id="+$(this).parent().data("id")+"&idType=rent_plat_c&cardType="+$(this).parent().data("type"),port:$(this).parent().data("port"),title:$(this).parent().data("title")},$(this).data("msg"))})}return{initIM:function(e){s.code=1,s.ucid=e.id+"",l(s)},init:function(){e(),d()}}}),define("module/fix_right/index",["require","module/fix_right/kefu","module/im/index"],function(e){var t=e("module/fix_right/kefu"),n=e("module/im/index");function i(){$("body").on("click","#back-top li",function(){var e=$(this).find("a").attr("data-url");if(e)if(window.__isLogin)window.open(e);else{var t=$(".btn-login");0<t.length?t.trigger("click"):alert("请登录后使用，谢谢！")}})}function a(){var e;$("#back-top").on("mouseenter","li",function(){var e=$(this).find(".popup").eq(0),t=this.className;e.show(),e.stop().animate({opacity:"1",right:"38px"},200)}).on("mouseleave","li",function(){var e=$(this).find(".popup").eq(0),t=this.className;curItemClass="",e.stop().animate({opacity:"0",right:"48px"},200,function(){t!=curItemClass&&e.hide()})})}function o(){var e,t;$(window).height()<$(document).scrollTop()?$("#gotop").show():$("#gotop").hide()}function r(){var e=$("#gotop");e.mouseenter(function(){$(this).find("span").css({opacity:"1"}),$(this).css({overflow:"inherit",width:"auto"})}),e.mouseleave(function(e){$(this).find("span").css({opacity:"0"}),$(this).css({overflow:"hidden",width:"37px"})}),$(document).ready(function(e){o(),$("body").on("click","#gotop",function(){$("html , body").animate({scrollTop:0},1e3)})}),$(window).scroll(function(e){o()})}function s(){i(),a()}return{init:function(e){t(),s(),r(),n.init()}}}),define("util/lazyload",[],function(){var e=null;function t(i,d){if(d.getElementsByClassName){var u,f,p=d.documentElement,c=i.Date,a=i.HTMLPictureElement,o="addEventListener",g="getAttribute",t=i[o],m=i.setTimeout,n=i.requestAnimationFrame||m,l=i.requestIdleCallback,h=/^picture$/i,r=["load","error","lazyincluded","_lazyloaded"],s={},v=Array.prototype.forEach,_=function(e,t){return s[t]||(s[t]=new RegExp("(\\s|^)"+t+"(\\s|$)")),s[t].test(e[g]("class")||"")&&s[t]},$=function(e,t){_(e,t)||e.setAttribute("class",(e[g]("class")||"").trim()+" "+t)},b=function(e,t){var n;(n=_(e,t))&&e.setAttribute("class",(e[g]("class")||"").replace(n," "))},y=function(t,n,e){var i=e?o:"removeEventListener";e&&y(t,n),r.forEach(function(e){t[i](e,n)})},k=function(e,t,n,i,a){var o=d.createEvent("CustomEvent");return n||(n={}),n.instance=u,o.initCustomEvent(t,!i,!a,n),e.dispatchEvent(o),o},w=function(e,t){var n;!a&&(n=i.picturefill||f.pf)?n({reevaluate:!0,elements:[e]}):t&&t.src&&(e.src=t.src)},C=function(e,t){return(getComputedStyle(e,null)||{})[t]},x=function(e,t,n){for(n=n||e.offsetWidth;n<f.minSize&&t&&!e._lazysizesWidth;)n=t.offsetWidth,t=t.parentNode;return n},I=(N=[],E=L=[],(e=function(e,t){S&&!t?e.apply(this,arguments):(E.push(e),j||(j=!0,d.hidden?m(q):n(q)))})._lsFlush=q=function(){var e=E;for(E=L.length?N:L,j=!(S=!0);e.length;)e.shift()();S=!1},e),S,j,L,N,E,q,e,T=function(n,e){return e?function(){I(n)}:function(){var e=this,t=arguments;I(function(){n.apply(e,t)})}},M=function(e){var n,i=0,a=125,t=666,o=t,r=function(){n=!1,i=c.now(),e()},s=l?function(){l(r,{timeout:o}),o!==t&&(o=t)}:T(function(){m(r)},!0);return function(e){var t;(e=!0===e)&&(o=44),n||(n=!0,(t=a-(c.now()-i))<0&&(t=0),e||t<9&&l?s():m(s,t))}},O=function(e){var t,n,i=99,a=function(){t=null,e()},o=function(){var e=c.now()-n;e<99?m(o,99-e):(l||a)(a)};return function(){n=c.now(),t||(t=m(o,99))}},V=(X=/^img$/i,Z=/^iframe$/i,Y="onscroll"in i&&!/glebot/.test(navigator.userAgent),ne=te=ee=0,ie=-1,ae=function(e){ne--,e&&e.target&&y(e.target,ae),(!e||ne<0||!e.target)&&(ne=0)},oe=function(e,t){var n,i=e,a="hidden"==C(d.body,"visibility")||"hidden"!=C(e,"visibility");for(B-=t,W+=t,G-=t,H+=t;a&&(i=i.offsetParent)&&i!=d.body&&i!=p;)(a=0<(C(i,"opacity")||1))&&"visible"!=C(i,"overflow")&&(n=i.getBoundingClientRect(),a=H>n.left&&G<n.right&&W>n.top-1&&B<n.bottom+1);return a},se=M(re=function(){var e,t,n,i,a,o,r,s,c,l=u.elements;if((D=f.loadMode)&&ne<8&&(e=l.length)){t=0,ie++,null==Q&&("expand"in f||(f.expand=500<p.clientHeight&&500<p.clientWidth?500:370),J=f.expand,Q=J*f.expFactor),te<Q&&ne<1&&2<ie&&2<D&&!d.hidden?(te=Q,ie=0):te=1<D&&1<ie&&ne<6?J:0;for(;t<e;t++)if(l[t]&&!l[t]._lazyRace)if(Y)if((s=l[t][g]("data-expand"))&&(o=1*s)||(o=te),c!==o&&(F=innerWidth+o*K,R=innerHeight+o,r=-1*o,c=o),n=l[t].getBoundingClientRect(),(W=n.bottom)>=r&&(B=n.top)<=R&&(H=n.right)>=r*K&&(G=n.left)<=F&&(W||H||G||B)&&(f.loadHidden||"hidden"!=C(l[t],"visibility"))&&(A&&ne<3&&!s&&(D<3||ie<4)||oe(l[t],o))){if(ge(l[t]),a=!0,9<ne)break}else!a&&A&&!i&&ne<4&&ie<4&&2<D&&(U[0]||f.preloadAfterLoad)&&(U[0]||!s&&(W||H||G||B||"auto"!=l[t][g](f.sizesAttr)))&&(i=U[0]||l[t]);else ge(l[t]);i&&!a&&ge(i)}}),le=T(ce=function(e){$(e.target,f.loadedClass),b(e.target,f.loadingClass),y(e.target,de),k(e.target,"lazyloaded")}),de=function(e){le({target:e.target})},ue=function(t,n){try{t.contentWindow.location.replace(n)}catch(e){t.src=n}},fe=function(e){var t,n=e[g](f.srcsetAttr);(t=f.customMedia[e[g]("data-media")||e[g]("media")])&&e.setAttribute("media",t),n&&e.setAttribute("srcset",n)},pe=T(function(e,t,n,i,a){var o,r,s,c,l,d;(l=k(e,"lazybeforeunveil",t)).defaultPrevented||(i&&(n?$(e,f.autosizesClass):e.setAttribute("sizes",i)),r=e[g](f.srcsetAttr),o=e[g](f.srcAttr),a&&(c=(s=e.parentNode)&&h.test(s.nodeName||"")),d=t.firesLoad||"src"in e&&(r||o||c),l={target:e},d&&(y(e,ae,!0),clearTimeout(z),z=m(ae,2500),$(e,f.loadingClass),y(e,de,!0)),c&&v.call(s.getElementsByTagName("source"),fe),r?e.setAttribute("srcset",r):o&&!c&&(Z.test(e.nodeName)?ue(e,o):e.src=o),a&&(r||c)&&w(e,{src:o})),e._lazyRace&&delete e._lazyRace,b(e,f.lazyClass),I(function(){(!d||e.complete&&1<e.naturalWidth)&&(d?ae(l):ne--,ce(l))},!0)}),me=function(){if(!A)if(c.now()-P<999)m(me,999);else{var e=O(function(){f.loadMode=3,se()});A=!0,f.loadMode=3,se(),t("scroll",function(){3==f.loadMode&&(f.loadMode=2),e()},!0)}},{_:function(){var e;P=c.now(),u.elements=d.getElementsByClassName(f.lazyClass),U=d.getElementsByClassName(f.lazyClass+" "+f.preloadClass),K=f.hFac,t("scroll",se,!0),t("resize",se,!0),i.MutationObserver?new MutationObserver(se).observe(p,{childList:!0,subtree:!0,attributes:!0}):(p[o]("DOMNodeInserted",se,!0),p[o]("DOMAttrModified",se,!0),setInterval(se,999)),t("hashchange",se,!0),["focus","mouseover","click","load","transitionend","animationend","webkitAnimationEnd"].forEach(function(e){d[o](e,se,!0)}),/d$|^c/.test(d.readyState)||(d[o]("DOMContentLoaded",se),m(me,2e4)),u.elements.length?(re(),I._lsFlush()):se()},checkElems:se,unveil:ge=function(e){var t,n=X.test(e.nodeName),i=n&&(e[g](f.sizesAttr)||e[g]("sizes")),a="auto"==i;(!a&&A||!n||!e[g]("src")&&!e.srcset||e.complete||_(e,f.errorClass))&&(t=k(e,"lazyunveilread").detail,a&&he.updateElem(e,!0,e.offsetWidth),e._lazyRace=!0,ne++,pe(e,t,a,i,n))}}),U,A,z,D,P,F,R,B,G,H,W,J,Q,K,X,Z,Y,ee,te,ne,ie,ae,oe,re,se,ce,le,de,ue,fe,pe,ge,me,he=(_e=T(function(e,t,n,i){var a,o,r;if(e._lazysizesWidth=i,i+="px",e.setAttribute("sizes",i),h.test(t.nodeName||""))for(o=0,r=(a=t.getElementsByTagName("source")).length;o<r;o++)a[o].setAttribute("sizes",i);n.detail.dataAttr||w(e,n.detail)}),$e=function(e,t,n){var i,a=e.parentNode;a&&(n=x(e,a,n),(i=k(e,"lazybeforesizes",{width:n,dataAttr:!!t})).defaultPrevented||(n=i.detail.width)&&n!==e._lazysizesWidth&&_e(e,a,i,n))},{_:function(){ve=d.getElementsByClassName(f.autosizesClass),t("resize",ye)},checkElems:ye=O(function(){var e,t=ve.length;if(t)for(e=0;e<t;e++)$e(ve[e])}),updateElem:$e}),ve,_e,$e,be,ye,ke=function(){ke.i||(ke.i=!0,he._(),V._())};return function(){var e,t={lazyClass:"lazyload",loadedClass:"lazyloaded",loadingClass:"lazyloading",preloadClass:"lazypreload",errorClass:"lazyerror",autosizesClass:"lazyautosizes",srcAttr:"data-src",srcsetAttr:"data-srcset",sizesAttr:"data-sizes",minSize:40,customMedia:{},init:!1,expFactor:1.5,hFac:.8,loadMode:1,loadHidden:!0};for(e in f=i.lazySizesConfig||i.lazysizesConfig||{},t)e in f||(f[e]=t[e]);i.lazySizesConfig=f,m(function(){f.init&&ke()})}(),u={cfg:f,autoSizer:he,loader:V,init:ke,uP:w,aC:$,rC:b,hC:_,fire:k,gW:x,rAF:I}}}return e=t(window,window.document)}),define("util/getParams",[],function(){function t(e){var t=location.search.length&&location.search.substring(1).split("&"),i={};return $(t).each(function(e,t){var n=t.split("=");n[0]&&(i[n[0]]=n[1])}),i[e]}function i(e,t,n){var i=location;n&&((i=$.parseUrl(n)).pathname="/"+i.path,i.search="?"+i.query,i.hash="#"+i.hash);var a,o=i.search+"&"+e+"="+t,r;return location.protocol+"//"+location.host+i.pathname+o+i.hash}return{getParams:function(e){return t(e)},setParams:function(e,t,n){return i(e,t,n)}}}),define("util/events",["util/observer"],function(){var r=require("util/observer");return function(e,t){var o=$(e);t.forEach(function(t){var e=t.action||"click",n=function(e){return that.$el.find(e)},i=r.trigger,a=function(e){this.$=n,this.emit=i,t.bind.apply(this,arguments),e.stopPropagation()};~e.indexOf(":")?r.on(e,a):o.on(e,'[data-el="'+t.el+'"]',a)})}}),define("module/send_message/index",["util/ajax","util/storage","util/checkLogin","util/getParams","util/events"],function(){var a=require("util/ajax"),e=require("util/storage"),t=require("util/checkLogin"),n=require("util/getParams"),o='<i class="send_message_popup-close" data-el="close-popup"></i><img class="send_message_popup-logo" src="<%= __basePath[0] + \'/resource/detail/success.png\'%>" alt="<%= __basePath[0] + \'/resource/detail/success.png\'%>"><h2 class="send_message_popup-title success">经纪人/管家的联系电话以短信方式发送至您的手机，请注意查收</h2><div class="send_message_popup-btn" data-el="message-success">  <span class="submit-text">知道了</span></div>',i='<i class="send_message_popup-close" data-el="close-popup"></i><h2 class="send_message_popup-title">我们将把经纪人/管家的联系电话以短信方式发送至您的手机，请注意查收</h2><label class="send_message_popup-body">  <p>    <span class="send_message_popup-label">您的手机号</span>    <input class="send_message_popup-input" data-el="message-tel" type="tel" maxlength="11" placeholder="请填写您的手机号">  </p>  <p class="send_message_popup-imgcode"></p></label><div class="send_message_popup-error"></div><div class="send_message_popup-btn" data-el="message-submit">  <div class="loading load-container"><div class="load"></div></div>  <span class="submit-text">发送号码</span></div>',r=require("util/events"),s="",c="",l="",d=!1;function u(e){return $('[data-el="'+e+'"]')}function f(){e.getStorage("showPop")||u("send-message").css({display:"inline-block"})}function p(){$(".send_message_popup-imgcode").empty().append('<span>图形验证码</span> <input class="send_message_popup-input imgcode" data-el="message-img" type="text" placeholder="图形验证码"><img class="send_message_popup-img" data-el="code-img" src="/aj/get/imgCode?stamp='+(new Date).getTime()+'">'),u("code-img").on("click",function(){p()})}function g(e){if(!d){var n=u("message-submit");n.addClass("send_message_popup-loading").find(".loading").show(),n.find(".submit-text").hide();var t="",i=!1;if(u("message-img").length&&((t=u("message-img").val())||($(".send_message_popup-error").css({"margin-top":"8px"}).text("验证码错误，请重新填写"),i=!0)),i)return n.removeClass("send_message_popup-loading").find(".loading").hide(),void n.find(".submit-text").show();d=!0,a({url:"/zufang/aj/broker/sms",method:"post",dataType:"json",data:{id:c,id_type:s,phone:e,virtual_phone:l,img_code:t}}).then(function(e){var t;if(d=!1,n.removeClass("send_message_popup-loading").find(".loading").hide(),n.find(".submit-text").show(),0==e.status)switch(e.data.code){case 0:$(".send_message_popup").empty().append($.tpl(o));break;case 520:p();break;case 522:$(".send_message_popup-error").css({"margin-top":"8px"}).text("联系方式已发送，请勿频繁操作！");break;case 521:$(".send_message_popup-error").css({"margin-top":"8px"}).text("验证码错误，请重新填写"),p();break;default:$(".send_message_popup-error").css({"margin-top":"8px"}).text(e.msg)}})}}var m=[{el:"close-pop",bind:function(){e.setStorage("showPop",!0),u("send-message").hide()}},{el:"close-popup",bind:function(){u("message-tel").val(""),u("popup-wrapper").hide(),$(".send_message_popup-error").text("")}},{el:"updatePhone",bind:function(){$(".send_message_popup").empty().append($.tpl(i));var e=$(this);s=e.data("type"),c="house"==s?e.data("housecode"):"layout"==s?e.data("layout_id"):e.data("id"),l=e.text().match(/\d+/g)&&e.text().match(/\d+/g).join(","),t.checkLogin(function(e){e&&e.data&&e.data.id&&u("message-tel").val(e.data.mobile||"")}),e.hasClass("apartment__closed")||$('[data-el="popup-wrapper"]').show()}},{el:"message-tel",bind:function(){$(this).css({borderColor:"#e4e6f0"}),$(".send_message_popup-error").css({"margin-top":0}).text("")},action:"focus"},{el:"message-submit",bind:function(){var e=u("message-tel"),t=e.val();if(!t.length||!/^1\d{10}$/.test(t))return e.css({borderColor:"red"}),void $(".send_message_popup-error").css({"margin-top":"8px"}).text("您输入的号码有误，请重新填写");g(t)}},{el:"message-success",bind:function(){u("popup-wrapper").hide(),f()}}];return{init:function(){r($("body"),m)}}}),define("page/detail/index",["module/top/index","module/footer/index","module/login/index","module/search/index","module/detail_content/index","module/detail_map/index","module/detail_fixed/index","module/detail_globallist/index","module/detail_report/index","module/duty_pop/index","module/detail_agent/index","module/fix_right/index","util/lazyload","util/ajax","util/storage","module/send_message/index"],function(){var t=require("module/top/index"),e=require("module/footer/index"),n=require("module/login/index"),i=require("module/search/index"),a=require("module/detail_content/index"),o=require("module/detail_map/index"),r=require("module/detail_fixed/index"),s=require("module/detail_globallist/index"),c=require("module/detail_report/index"),l=require("module/duty_pop/index"),d=require("module/detail_agent/index"),u=require("module/fix_right/index"),f=require("util/lazyload"),p=require("util/ajax"),g=require("util/storage"),m=require("module/send_message/index"),h=$("#mySwipe"),v=h.find('[data-el="checkWatch"]'),_=h.find('[data-el="getApp"]'),b=v.find("span");function y(e,t){p({url:"/zufang/aj/attention/house/"+g_conf.houseCode,method:"post",dataType:"json",data:{status:e}}).then(function(e){0==(e=e&&e.status)&&t()})}function k(){p({url:"/zufang/aj/attention/house/"+g_conf.houseCode+"?t=time"+(new Date).getTime(),method:"get",dataType:"json"}).then(function(e){(e=e&&e.data)&&e.status&&w()})}function w(){b.text("已关注"),v.addClass("clicked"),_.removeClass("hide")}function C(){b.text("关注房源"),v.removeClass("clicked"),_.addClass("hide")}function x(){return v.on("click",function(){$ULOG.send(10801,{action:{house_code:location.href.match(/zufang\/(.*)\.html/)[1],status:1}}),window.__isLogin?v.hasClass("clicked")?y(0,C):y(1,w):$('[data-el="btn_login"]').trigger("click")}).on("mouseenter",function(){v.hasClass("clicked")&&b.text("取消关注")}).on("mouseleave",function(){v.hasClass("clicked")&&b.text("已关注")}),k(),v}function I(a){var e;$('[data-el="updatePhone"]').each(function(e,t){var n=$(this),i=n.attr("data-houseCode");a[i]&&n.html(a[i].tp_number?a[i].tp_number.replace(",","转"):"&nbsp;")})}function S(a){var e;$('[data-el="updateName"]').each(function(e,t){var n=$(this),i=n.attr("data-houseCode");a[i]&&a[i].contact_name&&n.html(a[i].contact_name)})}function j(a){var e;$('[data-el="updateAvatar"]').each(function(e,t){var n=$(this),i=n.attr("data-houseCode");a[i]&&a[i].contact_avatar?n.css("background-image","url("+a[i].contact_avatar+")"):n.removeAttr("style")})}function L(e){var n="",t=e.picture_list;t&&t.length&&t.forEach(function(e,t){n+='<img data-el="dutyPic" src="'+e+'">'}),(e.info_card_certCode||e.info_card_content)&&(n+='<p class="duty-pop_title">'+(e.info_card_content?e.info_card_content+"<br/>":"")+(e.info_card_certCode?e.info_card_certCode:"")+"</p>"),n?($('[data-el="picList"]').append(n),$('[data-el="dutyCard"]').show(),$('[data-el="updatePic"]').css("display","inline-block")):$('[data-el="dutyCard"]').hide()}function N(){var i={},a=[],e=$('[data-el="updatePhone"]'),o=$('[data-el="showBooth"]').val(),t=$('[data-el="callIM"]').length?$('[data-el="callIM"]').eq(0).attr("data-info"):"";for(var n in e.each(function(e,t){var n=$(this).attr("data-houseCode");i[n]=1}),i)i.hasOwnProperty(n)&&a.push(n);if(a.length){var r={house_codes:a.join(","),position:"bottom"};t&&(r.ucid=t),p({url:"/zufang/aj/house/brokers",data:r}).then(function(e){var t={};if((e=e&&e.data)&&e.hasOwnProperty(a[0])){for(var n in e)if(e.hasOwnProperty(n)&&!$.isArray(e[n]))for(var i in e[n])t[i]=e[n][i];I(t),"0"!==o?(S(t),j(t),L(t[a[0]])):($('#aside [data-el="updateAvatar"]').hide(),$("#aside .content__aside__list--subtitle").hide())}})}}return{bind:function(){t.login=function(){n.showBox()},n.loginSuccess=function(e){t.loginSuccess(e)}},init:function(){this.bind(),t.init(),i.init(),e.init(),n.init(),l.init(),d.init(),g_conf.offline||(a.init(),o.init(),r.init("baseInfo",40),s.init(),c.init()),$(".lazyload").attr("data-expand",100),f.init(),u.init(),m.init(),x(),N()}}});