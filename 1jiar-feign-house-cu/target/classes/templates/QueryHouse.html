<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.springframework.org/schema/jdbc">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <!-- 引入jequery -->
    <script type="text/javascript" src="/js/jquery.min.js"></script>
    <!-- 引入bootstrap的css、js文件 -->
    <link rel="stylesheet" href="/bootstrap3/css/bootstrap.css">
    <script type="text/javascript" src="/bootstrap3/js/bootstrap.js"></script>
    <!-- 引入table的css、js -->
    <link rel="stylesheet" href="/js/bootstrap-table/bootstrap-table.css">
    <script type="text/javascript" src="/js/bootstrap-table/bootstrap-table.js"></script>
    <script type="text/javascript" src="/js/bootstrap-table/locale/bootstrap-table-zh-CN.js"></script>
    <script src="/js/bootstrap-bootbox/bootbox.js"></script>
    <!-- 引入date日期的css、js -->
    <link rel="stylesheet" href="/js/bootstrap-datetimepicker/css/bootstrap-datetimepicker.css">
    <script type="text/javascript" src="/js/bootstrap-datetimepicker/js/bootstrap-datetimepicker.js"></script>
    <script type="text/javascript" src="/js/bootstrap-datetimepicker/js/locales/bootstrap-datetimepicker.zh-CN.js"></script>
    <!-- 引入文件上传的css、js -->
    <link rel="stylesheet" href="/js/bootstrap-fileinput/css/fileinput.css">
    <script type="text/javascript" src="/js/bootstrap-fileinput/js/fileinput.js"></script>
    <script type="text/javascript" src="/js/bootstrap-fileinput/js/locales/zh.js"></script>
</head>
<body>
<div id="toolbar">
    <form class="form-inline" id="query_form">
        <div class="form-group">
            <label for="houseaheName">房屋名</label>
            <input type="text" class="form-control" id="houseaheName" placeholder="请输入房屋名">
            <label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</label>
            <label for="housePrice">房屋价格</label>
            <input type="text" class="form-control" id="startPrice" placeholder="请输入开始价格">~
            <input type="text" class="form-control" id="endPrice" placeholder="请输入结束价格">
            <div class="radio">
                <label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</label>
                <label>是否有电梯</label>
                <label>
                    <input type="radio" name="houseElevator"  value="1" > 有电梯
                    <input type="radio" name="houseElevator"  value="2" > 无电梯
                </label>
            </div>
            <div class="radio">
                <label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</label>
                <label>是否装修</label>
                <label>
                    <input type="radio" name="houseFinish"  value="1" > 已装修
                    <input type="radio" name="houseFinish"  value="2" > 未装修
                </label>
            </div>
            <div class="radio">
                <label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</label>
                <label>是否供暖</label>
                <label>
                    <input type="radio" name="houseHeating"  value="1" > 已供暖
                    <input type="radio" name="houseHeating"  value="2" > 未供暖
                </label>
            </div>
            <div class="radio">
                <label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</label>
                <label>租期</label>
                <label>
                    <input type="radio" name="houseZuQi"  value="1" > 月租
                    <input type="radio" name="houseZuQi"  value="2" > 年租
                </label>
            </div>
        </div>
        <div class="form-Area">
            <label  >选择区域</label>
                <select class="selectpicker form-control" data-live-search="true" name="quyu" id="quyu" onchange="selectOnchang(this)">
                </select>

            <label>选择街道</label>
                <select class="selectpicker form-control" data-live-search="true" name="jiedao" id="jiedao">
                </select>
        </div>
        <div class="form-Subway">
            <label  >选择地铁线路</label>
            <select class="selectpicker form-control" data-live-search="true" name="xianlu" id="xianlu" onchange="selectDiTieOnchang(this)">
            </select>

            <label>选择地铁站</label>
            <select class="selectpicker form-control" data-live-search="true" name="zhandian" id="zhandian">
            </select>
        </div>

    </form>
    <button type="button" class="btn btn-primary glyphicon glyphicon-search" onclick="searchUser()">搜索</button>
    <button type="button" class="btn btn-primary glyphicon glyphicon-search" onClick="chongzhi()">重置</button>

</div>
<table class="table" id="myTable"></table>
</body>
<script type="text/javascript" th:inline="none">
    $(function() {
        initHouseTable();//初始化用户表格数据
        diqu();
        ditie();
    })
    function initHouseTable(){
        $('#myTable').bootstrapTable({
            toolbar:'#toolbar',
            url:"/house/queryhouse",
            type:"post",
            pagination:true, //是否展示分页
            pageList:[3, 10, 20, 50],//分页组件
            pageNumber:1,
            pageSize:3,//默认每页条数
            sidePagination:'server',//分页方式：client客户端分页，server服务端分页
            striped:true,//显示条纹状表格
            queryParams:function(){
                return {
                    page:this.pageNumber,
                    rows:this.pageSize,
                    houseaheName:$("#houseaheName").val(),
                    houseElevator:  $("input[name='houseElevator']:checked").val(),
                    houseFinish:  $("input[name='houseFinish']:checked").val(),
                    houseHeating:  $("input[name='houseHeating']:checked").val(),
                    houseZuQi:  $("input[name='houseZuQi']:checked").val(),
                    houseQuYuId:  $("#jiedao option:selected").val(),
                    houseDiTieId: $("#zhandian option:selected").val(),
                    startPrice:$("#startPrice").val(),
                    endPrice:$("#endPrice").val(),
                    //chubanshe:$("#chubanshes").val(),
                    //startTime:$("#startTime").val(),
                    //endTime:$("#endTime").val()
                }
            },
            columns:[
                {field:"check",checkbox:true},
                {field:"houseId",title:"id"},
                {field:"houseaheName",title:"房名"},
                {field:"housePrice",title:"价格"},
                {field:"houseManId",title:"用户id"},
                {field:"houseQuYuName",title:"区域名"},
                {field:"houseDiTieName",title:"地铁站名"},
                {field:"houseJianzhuMianji",title:"建筑面积"},
                {field:"houseTaoneiMianji",title:"套内面积"},
                {field:"houseTypeId",title:"房型id"},
                {field:"houseUseId",title:"用途id"},
                {field:"houseFloorTypeId",title:"楼层类型表id"},
                {field:"houseDirectionId",title:"房屋朝向表id"},
                {field:"houseAgeId",title:"楼龄id"},
                {field:"houseZuQi",title:"租期",
                    formatter: function(value,row,index){
                        return value==1?"月租":value==2?"年租":"";
                    }},
                {field:"houseElevator",title:"有无电梯",
                    formatter: function(value,row,index){
                        return value==1?"有电梯":value==2?"没有电梯":"";
                    }},
                {field:"houseFinish",title:"是否装修",
                    formatter: function(value,row,index){
                        return value==1?"已装修":value==2?"未装修":"";
                    }},
                {field:"houseHeating",title:"是否供暖",
                    formatter: function(value,row,index){
                        return value==1?"已供暖":value==2?"未供暖":"";
                    }},
                {field:"ridgepoleName",title:"楼栋"},
                {field:"elementName",title:"单元"},
                {field:"doorplateName",title:"门牌号"},
                {field:"tools",title:"操作",
                    formatter: function (value, row, index) {
                        //js传递字符串的时候一定要加引号!!!!
                        var butt = '<button onclick="deleteById(\''+row.id+'\')" class="btn btn-danger glyphicon glyphicon-remove glyphicon glyphicon-trash" >删除</button>';
                        butt+=" "
                        butt += '<button onclick="openUpdate(\''+row.id+'\')" class="btn btn-info glyphicon glyphicon-wrench" >修改</button>';

                        return butt
                    }
                }
            ]
        })
    }
    //条件查询
    function searchUser(){
        $('#myTable').bootstrapTable('refresh');
    }
    //初始化地区的数据
    function diqu(){
        $.ajax({
            type:"post",
            url:"/house/queryquyu",
            data:{pid:0},
            dataType:"json",
            success:function(data) {
                var html ="<option value='"+0+"'>请先选择区域</option>";
                for( var i = 0 ; i < data.length; i++ ){
                    html  +="<option value='"+data[i].id+"'>"+data[i].name+"</option>";
                }
                $("#quyu").append(html);
            }
        })
    }
  /* $(function(){
        //给所有checkbox添加单击事件
        $("#definedColumns input[name='quyu']:selected").click(function(){
              pids=  $("input[name='quyu']:selected").val();
              alert(pids)
            $.ajax({
                type:"post",
                url:"/house/queryquyu",
                data:{pid:pids},
                dataType:"json",
                success:function(data) {
                    var html2 ="<option value='"+0+"'>请选择</option>";
                    for( var i = 0 ; i < data.length; i++ ){
                        html2  +="<option value='"+data[i].id+"'>"+data[i].name+"</option>";
                    }
                    $("#jiedao").append(html2);
                }
            })
        });
    })*/

    function selectOnchang(obj){
//获取被选中的option标签选项
        //alert(obj.selectedIndex);
        $("#jiedao").empty();
        $.ajax({
            type:"post",
            url:"/house/queryquyu",
            data:{pid:obj.selectedIndex},
            dataType:"json",
            success:function(data) {
                var html2 ="";
                for( var i = 0 ; i < data.length; i++ ){
                    html2  +="<option value='"+data[i].id+"'>"+data[i].name+"</option>";
                }
                $("#jiedao").append(html2);
            }
        })
    }
    //重置按钮
    function chongzhi(){
        $("#query_form").form('clear');
    }
    //初始化地区的数据
    function ditie(){
        $.ajax({
            type:"post",
            url:"/house/queryditie",
            data:{pid:0},
            dataType:"json",
            success:function(data) {
                var html ="<option value='"+0+"'>请先选择线路</option>";
                for( var i = 0 ; i < data.length; i++ ){
                    html  +="<option value='"+data[i].subwayId+"'>"+data[i].subwayName+"</option>";
                }
                $("#xianlu").append(html);
            }
        })
    }
    function selectDiTieOnchang(obj){
//获取被选中的option标签选项
        //alert(obj.selectedIndex);
        $("#zhandian").empty();
        $.ajax({
            type:"post",
            url:"/house/queryditie",
            data:{pid:obj.selectedIndex},
            dataType:"json",
            success:function(data) {
                var html2 ="";
                for( var i = 0 ; i < data.length; i++ ){
                    html2  +="<option value='"+data[i].subwayId+"'>"+data[i].subwayName+"</option>";
                }
                $("#zhandian").append(html2);
            }
        })
    }
</script>
</html>