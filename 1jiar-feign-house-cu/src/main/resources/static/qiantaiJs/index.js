define("util/env",[],function(){var i={host:"",scheme:"",port:"",env:"online"};function e(){var e=$.parseURL(location.href);i.host=e.host,i.scheme=e.scheme,i.port=e.port;var t=i.host;0===t.indexOf("dev")?i.env="dev":0===t.indexOf("test")&&(i.env="test")}function r(e){var t="";return e.scheme&&(t+=e.scheme+"://"),e.host&&(t+=e.host),e.port&&(t+=":"+e.port),e.path&&(t+="/"+e.path),e.query&&(t+="?"+e.query),e.hash&&(t+="#"+e.hash),t}var o={getEnv:function(){return i.env},fixedHost:function(e){if(!e)return i.host;var t=e.substring(0,e.indexOf("."));switch(i.env){case"dev":case"test":if(0!==t.indexOf(i.env))return i.env+e}return e},fixedUrl:function(e,t){t=t||!1,e.indexOf("http")<0&&(e=location.protocol+e);var n=$.parseURL(e);return n.host?(!t&&(n.host=o.fixedHost(n.host)),n.port=i.port,n.scheme||(n.scheme=i.scheme)):(n.host=i.host,n.scheme=i.scheme,n.port=i.port),r(n)},isSameDomain:function(e){var t;return $.parseURL(e).host==i.host}};return e(),o}),define("util/EventEmitter",[],function(){"use strict";var n,r,o,a,s,e;function c(){}return"function"!=typeof Object.create&&(Object.create=(n=function(){},function(e){if(1<arguments.length)throw Error("Second argument not supported");if("object"!=typeof e)throw TypeError("Argument must be an object");n.prototype=e;var t=new n;return n.prototype=null,t})),Object.keys||(Object.keys=(r=Object.prototype.hasOwnProperty,o=!{toString:null}.propertyIsEnumerable("toString"),s=(a=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"]).length,function(e){if("object"!=typeof e&&("function"!=typeof e||null===e))throw new TypeError("Object.keys called on non-object");var t=[],n,i;for(n in e)r.call(e,n)&&t.push(n);if(o)for(i=0;i<s;i++)r.call(e,a[i])&&t.push(a[i]);return t})),c.extend=function(e){var t=this,r=t.prototype;function n(){this&&t(this,arguments),this&&this._initialize_&&this._initialize_.apply(this,arguments)}var i=n.prototype=Object.create(r);for(var o in e){if("constructor"===o)return;var a=e[o];if("function"==typeof a&&r[o]&&"function"==typeof r[o])a=function(n,i){return function(){var e=this._super;this._super=r[n];var t=i.apply(this,arguments);return this._super=e,t}}(o,a);else if("object"==typeof a&&r[o]&&"object"==typeof r[o])for(var s in r[o])a[s]||(a[s]=r[o][s]);i[o]=a}return n.extend=c.extend,n},c.extend({_initialize_:function(e){var t=this;t._eventList={},t._eventTriggerd_={},this.initialize&&this.initialize.apply(this,arguments),this._promise_="boolean"==typeof e&&e},on:function(e,t){if(!e||!t)throw"type of fn is required";var n=this,i=n._eventList[e];i||(i=[],n._eventList[e]=i),i.push(t)},off:function(e,t){var n=this;if(e){var i=n._eventList[e];if(i&&i.length){if(!t){for(;i.pop(););return}for(var r=0,o=i.length;r<o;r++)if(i[r]==t||i[r]==t.fn)return void i.splice(r,1)}}else n._eventList={}},trigger:function(e){if(e){var t=this,n=Array.prototype.slice.call(arguments,1);t._promise_&&(t._eventTriggerd_[e]=n);var i=t._eventList[e];if(i&&i.length)for(var r=0;r<i.length;r++)if(!1===i[r].apply(t,n))return!1}},before:function(e,t){var n,i=this;return function(){return 0<--e?n=t.apply(i,arguments):t=null,n}},once:function(e,t){var n=this;e&&t&&n.on(e,n.before(2,t))},destroy:function(){var e;this._eventList=null},always:function(e,t){var n=this;n.on(e,t),n._eventTriggerd_[e]&&t.apply(null,n._eventTriggerd_[e])}})}),define("util/crossRequest",["require"],function(e){var n={},i=function(e,t){var n=this;n.domain=e,t=t||$.parseURL(e).host.replace(/\./g,"-"),n.name=t,n.init()};function r(e,t){var n=document.createElement("iframe");return n.id=e,n.name=e,n.src=t,n.style.cssText="display:none;width:0px;height:0px;",n.width=0,n.height=0,n.title="empty",document.body.appendChild(n),n}return $.extend(i.prototype,{init:function(){var e=this,t=e.domain+"/xd/api/?name="+e.name,n=r(e.name,t);e.iframe=n.contentWindow,e.reqArray=[]},next:function(){var e=this},request:function(e){var t=this,n=$.Deferred();return t.reqArray.push({defer:n,request:e}),t.next(),n}}),function(e,t){return n[e]?n[e]:n[e]=new i(e,t)}}),define("util/Trans",["require","util/EventEmitter","util/crossRequest","util/env"],function(e){var t=e("util/EventEmitter");$.EventEmitter=t;var n=$.EventEmitter,r=e("util/crossRequest"),o=e("util/env"),i=!1,a;return n.extend({initialize:function(e){var t={url:"",type:"get",dataType:"json",args:{}};$.extend(t,e),t.url=o.fixedUrl(t.url),t.method=t.type;var n=this;n.opt=t;var i=o.fixedUrl($.parseURL(t.url).host);o.isSameDomain(i)?n.isSame=!0:n.crossRequest=r(i)},request:function(e){var t=this,n=t.opt;return $.extend(n.args,e),n.data=n.args,t.isSame?$.ajax(n):this.crossRequest.request(n)}})}),define("util/ajax",[],function(){return $.ajax}),define("util/api",[],function(){var e={host:location.host,port:"",areaApi:"//matrix-api.lianjia.com:9004/",apartmentAreaApi:"",baiduMap:"//api.map.baidu.com/marker",redirect:"//m.zufangzi.com/redirect",userCenter:"//user.lianjia.com/site/favorHouse/",logout:"//test3-upassport.lianjia.com/logout",LianjiaIM:"//s1-ljcdn.test.lianjia.com:8400/web-im-sdk/static/1.1/lianjiaim1.1.min.js"},t;return-1<location.host.indexOf("test")?(e.apartmentAreaApi="//testapi.zufangzi.com/",e.loginUrl="//upassport.test.lianjia.com:5201/login?service=http%3A%2F%2Ftest-beike.m.lianjia.com%2Fmy%2Fchecklogin%3Fredirect%3D%252Fmy%252Findex&type=2",e.staticUrl="//s1.rent39.internal.lianjia.com/matrix_pc/dist/pc/src/",e.userCenter="//test-user.lianjia.com/site/favorHouse/",e.logout="//test3-upassport.lianjia.com/logout"):-1<location.host.indexOf("dev")?(e.staticUrl="//feresource.com:8091/pc/src/",e.userCenter="//test-user.lianjia.com/site/favorHouse/",e.logout="//test3-upassport.lianjia.com/logout"):(e.apartmentAreaApi="http://api.zufangzi.com/",e.loginUrl="//upassport.lianjia.com/login?service=https%3A%2F%2Fm.lianjia.com%2Fmy%2Fchecklogin%3Fredirect%3D%252Fmy%252Findex&type=2",e.staticUrl="//s1.ljcdn.com/matrix_pc/dist/pc/src/",e.userCenter="//user.lianjia.com/site/favorHouse/",e.LianjiaIM="//s1.ljcdn.com/web-im-sdk/static/1.1/lianjiaim1.1.min.js?v=15212312340214",e.logout="//upassport.lianjia.com/logout"),{env:e,path:{getUser:"/user/get"}}}),define("module/login/login",["util/env","util/Trans","util/EventEmitter","util/ajax","util/api"],function(){var C=require("util/env"),e=require("util/Trans"),t=require("util/EventEmitter"),n=require("util/ajax"),i=require("util/api");$.env=C,$.Trans=e,$.EventEmitter=t,$.listener=new $.EventEmitter;var r=$.env.getEnv(),o=!1,a=!1,s="http://172.30.0.20:9991/",c=location.protocol,x="",S=/^\w{4}$/,j=(x="dev"===r||"test"===r?c+"//test3-upassport.lianjia.com/":c+"//upassport.lianjia.com/")+"freshCaptch",N=function(e,t){$(".panel_login").hide();var n,i=$('<div class="panel_login panel_success"><i class="close_success">&times</i>'+e+(t?"":'<div>欢迎回来，<a class="green tologin">点击这里去登录</a></div></div>')).appendTo(".loninContaner");$(".close_success").on("click",function(){$(".overlay_bg").hide(),$(".panel_success").remove()}),t&&setTimeout(function(){location.reload()},2e3)},I=function(e,t){var n,i={phone:[/^\d{11}$/,"请输入有效的手机号"],pwd:[/^\w{8,}$/,"密码必须是至少8位的数字字母组合"]}[t];return!!i&&(!!i[0].test(e)||i[1])},L=/^\d{11}$/,l=/^(?![^a-zA-Z]+$)(?!\D+$)/,d=location.protocol+"//"+location.host,V="https://ajax.api.lianjia.com/login/login/getuserinfo",u=d+"/zufang/aj/userinfo",f=d+"/logout";"test"==r?(V=d+"/zufang/aj/userinfo",f=d+"/logout"):"dev"==r&&(V=d+"/zufang/aj/userinfo",f=d+"/logout");var O={checkExists:x+"CheckExist",sendVerifyCode:x+"sendSms",sendVerifyVoiceCode:x+"sendVoice",verifyCode:"//passport.ke.com/register/ljRegister/GenerateVerifyCode",checkVerifyCode:"//passport.ke.com/register/ljRegister/CheckVerifyCode",sendSMS:"//passport.ke.com/register/ljRegister/SendMobileVerifyCode",checkMobileCode:"//passport.ke.com/register/ljRegister/CheckMobileVerifyCode"},g=0;function h(){lianjiaCasManager.config({setLoginUrl:V,service:V,getFirstTicket:x+"login?service="+encodeURIComponent(V)+"&get-lt=true&isajax=true",loginUrl:x+"login"}),a&&a()}function U(e){lianjiaCasManager?e():a=e}function p(){if(!o){o=!0;var e=document.createElement("script");e.src=x+"dist/js/passport.js",e.type="text/javascript",e.charset="utf-8",e.onload=h,document.getElementsByTagName("head")[0].appendChild(e)}}function q(){return window.$ULOG&&$ULOG.send("10225"),className=$(this).attr("class"),$(".overlay_bg").fadeIn(300),$("#dialog_tel").removeAttr("class").addClass("panel_login animated "+className).fadeIn(),$("#dialog_tel .verImg").trigger("click"),$("body").css({overflow:"hidden"}),p(),!1}function E(){return window.$ULOG&&$ULOG.send("10225"),className=$(this).attr("class"),$("#dialog").removeClass("bounceIn"),$("#dialog").hide(),$("#dialog_tel").removeAttr("class").addClass("panel_login animated className").show(),$("#dialog_tel .verImg").trigger("click"),$("body").css({overflow:"hidden"}),p(),!1}function T(){return $(".panel_success").remove(),window.$ULOG&&$ULOG.send("10225"),$(".panel_login").fadeOut(),className=$(this).attr("class"),$("#dialog_tel").removeClass("bounceIn"),$("#dialog_tel").hide(),$("#dialog_reg").hide(),$("#dialog").show(),$("body").css({overflow:"hidden"}),p(),!1}function M(){return $ULOG.send("10225"),className=$(this).attr("class"),$(".overlay_bg").fadeIn(300),$("#dialog_reg").removeAttr("class").addClass("panel_login animated "+className).fadeIn(),$("#dialog_reg .verImg").trigger("click"),$("body").css({overflow:"hidden"}),p(),!1}function z(){return window.$ULOG&&$ULOG.send("10448"),$(".panel_login").fadeOut(),className=$(this).attr("class"),$("#dialog_tel").removeClass("bounceIn"),$("#dialog_tel").hide(),$("#dialog_reg").hide(),$("#dialog").hide(),$("#dialog_forget").show(),$("#dialog_forget .verImg").trigger("click"),$("body").css({overflow:"hidden"}),p(),!1}function m(){var e;new $.Trans({url:u,dataType:"jsonp"}).request().done(function(e){e&&e.data&&e.data.username&&(e.code=1),0==e.status&&$.listener.trigger("userInfo",e)}).fail(function(e){e&&$.listener.trigger("userInfo",e)})}return $(document.body).ready(function(){var d=$("#con_login_user .verImg"),t=$("#con_login_user").find(".show-error"),c=$("#con_login_user_tel .verImg"),n=$("#con_login_user_tel").find(".show-error"),l=$("#con_login_user_reg .checkVerimg .verImg"),e=$("#con_login_user_tel .checkVerimg1 .verImg"),i=$("#con_login_user_reg").find(".show-error"),s=$("#con_forget_user_tel .verImg"),r=$("#con_forget_user_tel").find(".show-error"),o=$("#con_forget_user_pw").find(".show-error");function a(){$(".panel_login").fadeOut(),$(".overlay_bg").fadeOut(),$("body").css({overflow:""}),$("#dialog").removeClass("bounceIn")}d.on("click",function(){var e=+new Date;window.$ULOG&&$ULOG.send("10451"),$(this).attr("src",j+"?t="+e)}),c.on("click",function(){var e=+new Date;window.$ULOG&&$ULOG.send("10451"),$(this).attr("src",j+"?t="+e)}),s.on("click",function(){var e=+new Date;window.$ULOG&&$ULOG.send("10451"),$(this).attr("src",j+"?t="+e)}),l.on("click",function(){var e=+new Date;window.$ULOG&&$ULOG.send("10451"),$(this).attr("src",j+"?t="+e)}),e.on("click",function(){var e=+new Date;window.$ULOG&&$ULOG.send("10451"),$(this).attr("src",j+"?t="+e)}),$(".typeUserInfo").delegate(".btn-register","click",M),$(".typeUserInfo").delegate(".btn-login","click",q),$(".loninContaner").delegate(".tologin","click",T),$(".loninContaner").delegate(".totellogin","click",function(e){$(".panel_success").remove(),E()}),$(".loninContaner").delegate(".toforget","click",z),$(".overlay_bg, .claseDialogBtn, .close_login").click(function(){a()}),$(".loninContaner").delegate(".checkbox-btn","click",function(e){var t=$(this),n;t.find("input").get(0).checked?t.find("span").addClass("active"):t.find("span").removeClass("active")});var u=function(e,t){var n,i=e||this,r=!1,o={};i.parent().show();var e=$.extend(o,e);i.css({color:"#333333"});var a='<div class="drag_bg"></div><div class="drag_text" onselectstart="return false;" unselectable="on">拖动滑块验证</div><div class="handler handler_bg"></div>';i.html(a);var s=i.find(".handler"),c=i.find(".drag_bg"),l=i.find(".drag_text"),d=i.width()-s.width();function u(){s.removeClass("handler_bg").addClass("handler_ok_bg"),l.text("验证通过"),i.css({color:"#00ae66"}),s.unbind("mousedown"),$(document).unbind("mousemove"),$(document).unbind("mouseup"),t&&t()}s.mousedown(function(e){r=!0,n=e.pageX-parseInt(s.css("left"),10)}),s.mousedown(function(e){r=!0,n=e.pageX-parseInt(s.css("left"),10)}),$(document).mousemove(function(e){var t=e.pageX-n;r&&(0<t&&t<=d?(s.css({left:t}),c.css({width:t})):d<t&&u())}).mouseup(function(e){var t;r=!1,e.pageX-n<d&&(s.css({left:0}),c.css({width:0}))})},f=function(e){u(e);var t=e.find(".handler"),n=e.find(".drag_bg"),i=e.find(".drag_text");t.css({left:0}),n.css({width:0}),t.removeClass("handler_ok_bg").addClass("handler_bg"),i.text("拖动滑块验证"),$("#drag").css({color:"#333333"}),e.parent().hide()};function g(e){e=e||"用户名或者密码错误",t.find("dd").html(e),t.show()}function h(){t.hide()}function p(e){e=e||"用户名或者密码错误",n.find("dd").html(e),n.show()}function m(){n.hide()}function v(e){e=e||"用户名或者密码错误",i.find("dd").html(e),i.show()}function _(){i.hide()}function y(e){e=e||"用户名或者密码错误",r.find("dd").html(e),r.show()}function b(){r.hide()}$("#con_login_user").delegate("input","keyup",function(e){13==e.keyCode&&$(".login-user-btn").click()});var k=0;$(".login-user-btn").on("click",function(e){window.$ULOG&&$ULOG.send("10446"),$(".border-a").removeClass("border-a");var t=$("#con_login_user").find(".item"),n=$("#con_login_agent").find(".item"),i=t.find(".users").val(),r=t.find(".password").val();if(!i||!0!==I(i,"phone"))return t.find(".users").focus(),g("请输入有效的手机号码"),void $("#con_login_user").find(".userName").addClass("border-red");if($("#con_login_user").find(".userName").removeClass("border-red"),!r)return t.find(".password").focus(),g("请输入密码"),void $("#con_login_user").find(".pwd").addClass("border-red");$("#con_login_user").find(".pwd").removeClass("border-red");var o=$("#con_login_user").find('[name="remember"]').get(0),a={username:i,password:r,code:""};if(o&&o.checked&&(a.remember=1),"none"!=$("#con_login_user .checkVerimg").css("display")){var s=$(".ver-img").val();if(!S.test(s))return g("验证码格式错误"),$(".ver-img").focus(),void $("#con_login_user").find(".checkVerimg").addClass("border-red");$("#con_login_user").find(".checkVerimg").removeClass("border-red"),a.code=s}var c=null;if("none"!=$(".drag").css("display")){if(!k)return void g("滑块验证不通过");c=(new Date).getTime(),k=0,f($("#drag"))}return h(),lianjiaCasManager.config({loginUrl:x+"login",getFirstTicket:x+"login?service="+encodeURIComponent(V)+"&type=1&get-lt=true&isajax=true&from=lianjiaweb"+(null===c?"":"&time="+c)}),void U(function(){lianjiaCasManager.login(a,function(e){$.listener.trigger("loginActSuccess"),d.trigger("click"),window.NOTAUTOJUMP||location.reload()},function(e){if(t.removeClass("border-red"),e&&e.eventId)switch(e.eventId){case"needCaptchaCheckWhenIpLimit":$("#con_login_user .checkVerimg").show(),g("请输入图形验证码"),d.trigger("click"),$("#con_login_user").find(".checkVerimg").addClass("border-red");break;case"needSendSms":$("#drag").find(".handler").hasClass("handler_ok_bg")||(u($("#drag")),g("请拖动滑块进行验证")),d.trigger("click");break;case"needCaptcha":$("#con_login_user .checkVerimg").show(),g("请输入图形验证码"),d.trigger("click"),$("#con_login_user").find(".checkVerimg").addClass("border-red");break;default:g(e.msg),d.trigger("click")}})});function l(e){if("1"==e.code)if(e.data.success)location.reload();else if(e.data.isNeedVerifyCode&&"none"==$("#con_login_user .checkVerimg").css("display"))$("#con_login_user .checkVerimg").show(),$("#con_login_user .checkVerimg img").attr("src",C.fixedUrl("//login.lianjia.com/login/GenerateVerifyCode?rand"+(new Date).getTime()));else{var t="用户名或者密码错误";switch(e.data.errorCode){case 1:t="用户名不存在";break;case 2:t="密码不正确,请重试";break;case 3:t="验证码输入不正确或者已经过期",$("#con_login_user .checkVerimg img").attr("src",C.fixedUrl("//login.lianjia.com/login/GenerateVerifyCode?rand"+(new Date).getTime()))}g(t)}}}),$(".login-user-tel-btn").on("click",function(e){window.$ULOG&&$ULOG.send("10446"),$(".border-a").removeClass("border-a");var t=$("#con_login_user_tel").find(".item"),n=$("#con_login_agent").find(".item"),i=t.find(".users_tel").val(),r=t.find(".verifycode").val();if(!i||!0!==I(i,"phone"))return t.find(".users_tel").focus(),p("请输入有效的手机号码"),void $("#con_login_user_tel").find(".userName").addClass("border-red");if($("#con_login_user_tel").find(".userName").removeClass("border-red"),!r)return t.find(".verifycode").focus(),void $("#con_login_user_tel").find(".Verify").addClass("border-red");$("#con_login_user_tel").find(".Verify").removeClass("border-red");var o=$("#con_login_user_tel").find('[name="remember"]').get(0),a={username:i,smsCode:r,code:"",type:2};if(o&&o.checked&&(a.remember=1),"none"!=$("#con_login_user_tel .checkVerimg").css("display")){var s=$("#con_login_user_tel .ver-img").val();if(!S.test(s))return p("验证码格式错误"),$("#con_login_user_tel .ver-img").focus(),void $("#con_login_user_tel").find(".checkVerimg").addClass("border-red");$("#con_login_user_tel").find(".checkVerimg").removeClass("border-red"),a.code=s}m(),lianjiaCasManager.config({loginUrl:x+"login",getFirstTicket:x+"login?service="+encodeURIComponent(V)+"&get-lt=true&isajax=true&type=2&from=lianjiaweb"}),U(function(){t.removeClass("border-red"),lianjiaCasManager.login(a,function(e){-1==e.code?(p(),c.trigger("click")):($.listener.trigger("loginActSuccess"),window.NOTAUTOJUMP||location.reload())},function(e){if(t.removeClass("border-red"),e&&e.eventId)switch(e.eventId){case"needCaptcha":p("请输入验证码"),$("#con_login_user_tel .checkVerimg").show(),c.trigger("click");break;case"showCaptchaWhenSendSms":p("请输入验证码"),$("#con_login_user_tel .checkVerimg").show(),c.trigger("click");default:p(e.msg),c.trigger("click")}})})}),$(".user-forget").on("click",function(e){window.$ULOG&&$ULOG.send("10449"),$(".border-a").removeClass("border-a");var t=$("#con_forget_user_tel").find(".item"),n=t.find(".user_forget_phone").val(),i=t.find(".verifycode").val(),r=$("#con_forget_user_tel").find(".password_reg").val();if(!n||!0!==I(n,"phone"))return t.find(".user_forget_phone").focus(),y("请输入有效的手机号码"),void $("#con_forget_user_tel").find(".userName").addClass("border-red");if($("#con_forget_user_tel").find(".userName").removeClass("border-red"),!r||!0!==I(r,"pwd"))return t.find(".password_reg").focus(),y("请输入不少于8位数的密码（数字+字母）"),void $("#con_forget_user_pw").find(".pwd").addClass("border-red");if(!r.match(/\d/)||!r.match(/[A-Za-z]/))return t.find(".password_reg").focus(),y("请输入不少于8位数的密码（数字+字母）"),void $("#con_forget_user_pw").find(".pwd").addClass("border-red");if($("#con_forget_user_pw").find(".pwd").removeClass("border-red"),!i)return t.find(".verifycode").focus(),t.find(".verifycode").addClass("border-a"),void $("#con_forget_user_tel").find(".Verify").addClass("border-red");$("#con_forget_user_tel").find(".Verify").removeClass("border-red");var o={username:n,phone:n,smsCode:i,newPassword:r,confirmPassword:r};if("none"!=$("#con_forget_user_tel .checkVerimg").css("display")){var a=$("#con_forget_user_tel .ver-img").val();if(!S.test(a))return y("验证码格式错误"),$("#con_forget_user_tel .ver-img").focus(),void $("#con_forget_user_tel").find(".checkVerimg").addClass("border-red");$("#con_forget_user_tel").find(".checkVerimg").removeClass("border-red"),o.code=a}b(),lianjiaCasManager.config({getFirstTicket:x+"forgotpassword?service="+encodeURIComponent(V)+"&get-lt=true&isajax=true&from=lianjiaweb",loginUrl:x+"forgotpassword"}),U(function(){lianjiaCasManager.login(o,function(e){$("#con_forget_user_pw").find(".pwd").removeClass("border-red"),$.listener.trigger("loginActSuccess"),window.NOTAUTOJUMP||(N("修改密码成功"),s.trigger("click"))},function(e){$("#con_forget_user_pw").find(".pwd").removeClass("border-red"),1===e.code?y():(2===e.code?y("请输入验证码"):3===e.code?y("短信验证码输入错误"):y(e.msg),$("#con_forget_user_tel .checkVerimg").show()),s.trigger("click")})})}),$(".register-user-btn").on("click",function(e){window.$ULOG&&$ULOG.send("10447"),$(".border-a").removeClass("border-a");var t=$("#con_login_user_reg").find(".item"),n=$("#con_login_agent").find(".item"),i=t.find(".users_reg").val(),r=t.find(".verifycode").val(),o=t.find(".password_reg").val();if(!i||!0!==I(i,"phone"))return t.find(".users_reg").focus(),v("请输入有效的手机号码"),void $("#con_login_user_reg").find(".userName").addClass("border-red");if($("#con_login_user_reg").find(".userName").removeClass("border-red"),!r)return t.find(".verifycode").focus(),t.find(".verifycode").addClass("border-a"),void $("#con_login_user_reg").find(".Verify").addClass("border-red");if($("#con_login_user_reg").find(".Verify").removeClass("border-red"),!o||!0!==I(o,"pwd"))return t.find(".password_reg").focus(),v("请输入不少于8位数的密码（数字+字母）"),void $("#con_login_user_reg").find(".pwd").addClass("border-red");if($("#con_login_user_reg").find(".pwd").removeClass("border-red"),!o.match(/\d/)||!o.match(/[A-Za-z]/))return t.find(".password_reg").focus(),v("请输入不少于8位数的密码（数字+字母）"),void $("#con_login_user_reg").find(".pwd").addClass("border-red");$("#con_login_user_reg").find(".pwd").removeClass("border-red");var a=$("#con_login_user_reg").find('[name="read"]').get(0),s={username:i,verify:r,password:o,smsCode:r,confirmPassword:o};if(!a.checked)return v("请阅读协议并确认"),void a.focus();if("none"!=$("#con_login_user_reg .checkVerimg").css("display")){var c=$("#con_login_user_reg .ver-img").val();if(!S.test(c))return v("验证码格式错误"),$("#con_login_user_reg .ver-img").focus(),void $("#con_login_user_reg").find(".checkVerimg").addClass("border-red");$("#con_login_user_reg").find(".checkVerimg").removeClass("border-red"),s.code=c}_(),lianjiaCasManager.config({getFirstTicket:x+"register?service="+encodeURIComponent(V)+"&get-lt=true&isajax=true&from=lianjiaweb",loginUrl:x+"register"}),U(function(){lianjiaCasManager.login(s,function(e){t.removeClass("border-red"),-1==e.code?(v(e.msg),l.trigger("click")):($.listener.trigger("loginActSuccess"),window.NOTAUTOJUMP||N("注册成功",!0))},function(e){if(t.removeClass("border-red"),e&&e.eventId)switch(e.eventId){case"needCaptcha":v("请输入验证码"),$("#con_login_user_reg .checkVerimg").show(),l.trigger("click");break;case"showCaptchaWhenSendSms":v("请输入验证码"),$("#con_login_user_reg .checkVerimg").show(),l.trigger("click");default:v(e.msg),l.trigger("click")}})})});var w=function(e){if(null==e||""===e)return!1;if("object"==typeof e)for(var t in e){var n=e[t].value,i=e[t].required;if(void 0===i||!1===i.value);else if(null==n||""==n)return!!i.hint&&i.hint;var r=e[t].pattern;if(r&&!n.match(r.value))return!!r.hint&&r.hint;var o=e[t].equal;if(o){var a=e[o.propertyName];if(null==a)return!1;if(a.value!=n)return!!o.hint&&o.hint}}return!0};$("#send_verify_code_tel").on("click",function(e){if($(this).hasClass("disabled"))return!1;window.$ULOG&&$ULOG.send("10445");var t={telNum:{value:$(".users_tel").val(),pattern:{value:L,hint:"请输入有效的手机号码"}}},n=w(t);if(1!=n)return p(n),!1;var i={phone:$(".users_tel").val()};if(0<$("#con_login_user_tel .checkVerimg").length&&""!=$("#con_login_user_tel .checkVerimg input").val()&&(i.code=$("#con_login_user_tel .checkVerimg input").val(),$("#con_login_user_tel").find(".checkVerimg").removeClass("border-red")),!$("#con_login_user_tel .checkVerimg input").val())return $("#con_login_user_tel").find(".checkVerimg").addClass("border-red"),p("请输入图形验证码"),!1;var r=function(e){var t=null,n=$("#send_verify_code_tel"),i;t=setInterval(function(){if(e<=0)return n.removeClass("disabled"),n.find("em").html("重新获取验证码"),clearInterval(t),void m();40==e&&$(".send_verify_code_s").show(),n.find("em").html(e--+"s 后重新发送"),n.addClass("disabled")},1e3)};$.ajax({url:O.sendVerifyCode,type:"post",dataType:"jsonp",data:i}).done(function(e){1===e.code?(m(),r(60)):(2==e.code?(p("请输入图形验证码"),$("#con_login_user_tel .checkVerimg").show()):8==e.code||0==e.code?p(e.msg):p(e),c.trigger("click"))}).fail(function(e){p("发送失败，请重试"),r(0),$(this).removeClass("disable"),1===e.code?(m(),c.trigger("click"),r(60)):(2==e.code?(p("请输入图形验证码"),$("#con_login_user_tel .checkVerimg").show()):8==e.code||0==e.code?p(e.msg):p(e),c.trigger("click"))})}),$("#send_verify_code_tel_s .voice_a").on("click",function(e){if($(this).hasClass("disabled"))return!1;var t={telNum:{value:$(".users_tel").val(),pattern:{value:L,hint:"请输入有效的手机号码"}}},n=w(t);if(1!=n)return p(n),!1;var i={phone:$(".users_tel").val()};if(0<$("#con_login_user_tel .checkVerimg").length&&""!=$("#con_login_user_tel .checkVerimg input").val()&&(i.code=$("#con_login_user_tel .checkVerimg input").val(),$("#con_login_user_tel").find(".checkVerimg").removeClass("border-red")),!$("#con_login_user_tel .checkVerimg input").val())return p("请输入图形验证码"),$("#con_login_user_tel").find(".checkVerimg").addClass("border-red"),!1;$.ajax({url:O.sendVerifyVoiceCode,type:"post",dataType:"jsonp",data:i}).done(function(e){1===e.code?(m(),$("#send_verify_code_tel_s").hide(),p("验证码将以电话的形式的通知到您，请注意接听")):(2==e.code?(p("请输入验证码"),$("#send_verify_code_tel .checkVerimg").show()):8==e.code||0==e.code?p(e.msg):p(e),c.trigger("click"))}).fail(function(e){e.code=1,p("发送失败，请重试"),$(this).removeClass("disable"),1===e.code?m():2==e.code?(p("请输入验证码"),$("#send_verify_code_tel .checkVerimg").show()):8==e.code||0==e.code?p(e.msg):p(e),c.trigger("click")})}),$("#send_verify_code_forget").on("click",function(e){if($(this).hasClass("disabled"))return!1;window.$ULOG&&$ULOG.send("10445");var t={telNum:{value:$(".user_forget_phone").val(),pattern:{value:L,hint:"请输入有效的手机号码"}}},n=w(t);if(1!=n)return y(n),!1;var i={phone:$(".user_forget_phone").val()};if(0<$("#con_forget_user_tel .checkVerimg").length&&""!=$("#con_forget_user_tel .checkVerimg input").val()&&(i.code=$("#con_forget_user_tel .checkVerimg input").val(),$("#con_forget_user_tel").find(".checkVerimg").removeClass("border-red")),!$("#con_forget_user_tel .checkVerimg input").val())return y("请输入图形验证码"),$("#con_forget_user_tel").find(".checkVerimg").addClass("border-red"),!1;var r=function(e){var t=null,n=$("#send_verify_code_forget"),i;t=setInterval(function(){if(e<=0)return n.removeClass("disabled"),n.find("em").html("重新获取验证码"),clearInterval(t),void _();40==e&&$("#send_verify_code_forget_s").show(),n.find("em").html(e--+"s 后重新发送"),n.addClass("disabled")},1e3)};$.ajax({url:O.sendVerifyCode+"?sendOn=exist",dataType:"jsonp",data:i}).done(function(e){1==e.code?(b(),r(60)):(8==e.code||0==e.code?y(e.msg):2==e.code?(y("请输入验证码"),$("#con_forget_user_tel .checkVerimg").show()):y(e),s.trigger("click"))}).fail(function(e){e.code=1,y("发送失败，请重试"),r(0),$(this).removeClass("disable"),1===e.code?(b(),r(60)):(2==e.code?(y("请输入验证码"),$("#con_forget_user_tel .checkVerimg").show()):8==e.code||0==e.code?y(e.msg):y(e),s.trigger("click"))})}),$("#send_verify_code_forget_s .voice_a").on("click",function(e){if($(this).hasClass("disabled"))return!1;var t={telNum:{value:$(".user_forget_phone").val(),pattern:{value:L,hint:"请输入有效的手机号码"}}},n=w(t);if(1!=n)return v(n),!1;var i={phone:$(".user_forget_phone").val()};if(0<$("#con_forget_user_tel .checkVerimg").length&&""!=$("#con_forget_user_tel .checkVerimg input").val()&&(i.code=$("#con_forget_user_tel .checkVerimg input").val(),$("#con_forget_user_tel").find(".checkVerimg").removeClass("border-red")),!$("#con_forget_user_tel .checkVerimg input").val())return y("请输入图形验证码"),$("#con_forget_user_tel").find(".checkVerimg").addClass("border-red"),!1;$.ajax({url:O.sendVerifyVoiceCode+"?sendOn=exist",type:"post",dataType:"jsonp",data:i}).done(function(e){1===e.code?(b(),$("#send_verify_code_forget_s").hide(),y("验证码将以电话的形式的通知到您，请注意接听")):(8==e.code||0==e.code?y(e.msg):2==e.code?(y("请输入验证码"),$("#con_forget_user_tel .checkVerimg").show()):y(e),s.trigger("click"))}).fail(function(e){y("发送失败，请重试"),$(this).removeClass("disable"),1===e.code?b():2==e.code?(p("请输入验证码"),$("#con_forget_user_tel .checkVerimg").show()):8==e.code||0==e.code?y(e.msg):y(e),s.trigger("click")})}),$("#send_verify_code_reg").on("click",function(e){if($(this).hasClass("disabled"))return!1;window.$ULOG&&$ULOG.send("10445");var t={telNum:{value:$(".users_reg").val(),pattern:{value:L,hint:"请输入有效的手机号码"}}},n=w(t);if(1!=n)return v(n),!1;var i={phone:$(".users_reg").val()};if(0<$("#con_login_user_reg .checkVerimg").length&&""!=$("#con_login_user_reg .checkVerimg input").val()&&(i.code=$("#con_login_user_reg .checkVerimg input").val(),$("#con_login_user_reg").find(".checkVerimg").removeClass("border-red")),!$("#con_login_user_reg .checkVerimg input").val())return v("请输入图形验证码"),$("#con_login_user_reg").find(".checkVerimg").addClass("border-red"),!1;var r=function(e){var t=null,n=$("#send_verify_code_reg"),i;t=setInterval(function(){if(e<=0)return n.removeClass("disabled"),n.find("em").html("重新获取验证码"),clearInterval(t),void _();40==e&&$("#send_verify_code_reg_s").show(),n.find("em").html(e--+"s 后重新发送"),n.addClass("disabled")},1e3)};$.ajax({url:O.sendVerifyCode+"?sendOn=noExist",dataType:"jsonp",data:i}).done(function(e){1==e.code?(_(),r(60)):(8==e.code||0==e.code?v(e.msg):2==e.code?(v("请输入验证码"),$("#con_login_user_reg .checkVerimg").show()):v(e),l.trigger("click"))}).fail(function(e){v("发送失败，请重试"),r(0),$(this).removeClass("disable"),1==e.code?(_(),r(60)):(0==e.code||8==e.code?v(e.msg):2==e.code?(v("请输入验证码"),$("#con_login_user_reg .checkVerimg").show()):v(e),l.trigger("click"))})}),$("#send_verify_code_reg_s .voice_a").on("click",function(e){if($(this).hasClass("disabled"))return!1;var t={telNum:{value:$(".users_reg").val(),pattern:{value:L,hint:"请输入有效的手机号码"}}},n=w(t);if(1!=n)return v(n),!1;var i={phone:$(".users_reg").val()};if(0<$("#con_login_user_reg .checkVerimg").length&&""!=$("#con_login_user_reg .checkVerimg input").val()&&(i.code=$("#con_login_user_reg .checkVerimg input").val(),$("#con_login_user_reg").find(".checkVerimg").removeClass("border-red")),!$("#con_login_user_reg .checkVerimg input").val())return v("请输入图形验证码"),$("#con_login_user_reg").find(".checkVerimg").addClass("border-red"),!1;$.ajax({url:O.sendVerifyVoiceCode+"?sendOn=noExist",type:"post",dataType:"jsonp",data:i}).done(function(e){1==e.code?(_(),$("#send_verify_code_reg_s").hide(),v("验证码将以电话的形式的通知到您，请注意接听")):8==e.code||0==e.code?(v(e.msg),l.trigger("click")):2==e.code?(v("请输入验证码"),$("#con_login_user_reg .checkVerimg").show()):(v(e),l.trigger("click"))}).fail(function(e){e.code=1,v("发送失败，请重试"),$(this).removeClass("disable"),1===e.code?_():2==e.code?(v("请输入验证码"),$("#con_login_user_reg .checkVerimg").show()):8==e.code||0==e.code?v(e.msg):v(e),l.trigger("click")})})}),$(".password-view").on("click",function(){var e=$(this).siblings("input");e.attr("type","password"==e.attr("type")?"text":"password")}),$(".checkVerimg").trigger("click"),{init:function(){function t(e){var t=$(".typeUserInfo");e&&e.displayName&&(e.displayName=$.encodeHTML($.getLimitString(e.displayName,20,"..")),$('[data-el="login"]').addClass("hide"),$('[data-el="user_box"]').removeClass("hide"),$('[data-el="user_box"] [data-el="userName"]').attr("href",i.env.userCenter).text(e.displayName),$('[data-el="logout_btn"]').attr("href",i.env.logout+"?service="+encodeURIComponent("https://www.lianjia.com/user/checklogin?redirect="+encodeURIComponent(location.href))))}$.listener.on("userInfo",function(e){t(e.data),e&&e.data&&e.data.mobile}),m()},openLoginDialog:q,openDialogRegister:M}}),define("module/top/index",["module/login/login","util/api"],function(){var e=require("module/login/login"),t=require("util/api");function n(e){return i.find('[data-el="'+e+'"]')}var i=$("#top"),r=n("login"),o=n("btn_login"),a=n("register"),s=n("user_box");return{login:$.noop,loginSuccess:function(e){r.addClass("hide"),s.removeClass("hide")},bind:function(){o.on("click",function(){e.openLoginDialog()}),a.on("click",function(){e.openDialogRegister()})},init:function(){this.bind(),e.init()}}}),define("module/footer/index",[],function(){function e(){$(".footer__middle").on("mouseover",'[data-el="parentList"] li a',function(){$('[data-el="parentList"] li a').removeClass("cur"),$(this).addClass("cur");var e=$(this).attr("data-index");$('ul[data-el="childrenList"]').hide(),$('ul[data-el="childrenList"]').eq(e).show()})}function t(){e()}return{init:t}}),define("ui/suggest/index",[],function(){var c={};return function(i,$,y){String.trim||(String.prototype.trim=function(){for(var e,e,t=/\s/,n=(e=(e=this).replace(/^\s\s*/,"")).length;t.test(e.charAt(--n)););return e.slice(0,n+1)}),String.replaceTpl||(String.prototype.replaceTpl=function(n){return this.replace(/#\{([^}]*)\}/gm,function(e,t){return n[t.trim()]})}),String.htmlEncode||(String.prototype.htmlEncode=function(){return String(this).replace(/\x26/g,"&amp;").replace(/\x3c/g,"&lt;").replace(/\x3E/g,"&gt;").replace(/\x22/g,"&quot;").replace(/\x27/g,"&#39;").replace(/\xA9/g,"&copy;")});var r=" ",b=null,u=/<[^>]+>/g,e=document.documentElement.classList!==y,k=/\w/.test("İ"),o=k&&!i.XMLHttpRequest,w=$.documentMode&&9===$.documentMode,C=function(e){if(e){var t=e.split("."),n=t.length,i=window,r=0,o;if(1<n)for(;r<n-1;r++)o=t[r],i=0===r&&i[o]?i[o]:o in i?i[o]:i[o]={};return i}},l=e?function(e,t){return e.classList.contains(t)}:function(e,t){return-1<(r+e.className+r).indexOf(r+t+r)},f=e?function(e,t){e.classList.add(t)}:function(e,t){l(e,t)||(e.className+=(e.className?r:"")+t)},g=e?function(e,t){e.classList.remove(t)}:function(e,t){if(l(e,t)){var n=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(n,r)}},d=$.addEventListener?function(e,t,n){e.addEventListener(t,n,!1)}:function(e,t,n){e.attachEvent("on"+t,n)},h=function(e,t,n){d(e,t,function(e){var t=(e=e||i.event).srcElement||e.target;n.call(t,e)})},a=k?function(e,t){return t=t.replace(/\-(\w)/g,function(e,t){return t.toUpperCase()}),e.currentStyle[t]}:function(e,t){return $.defaultView.getComputedStyle(e,null).getPropertyValue(t)},t=function(e){for(var t=e+"=",n=document.cookie.split(";"),i=0;i<n.length;i++){for(var r=n[i];" "==r.charAt(0);)r=r.substring(1,r.length);if(0==r.indexOf(t))return r.substring(t.length,r.length)}return null},s=function(e,t){if(!(this instanceof s))return new s(e,t);var n=this;n.el=e+""===e?$.getElementById(e):e,n.el&&(n.o={classNameWrap:t.classNameWrap||"sug-wrap",classNameQuery:t.classNameQuery,classNameQueryNull:t.classNameQueryNull,classNameSelect:t.classNameSelect||"sug-select",classNameClose:t.classNameClose||"sug-close",classNameShim:t.classNameShim||"sug-shim",locAbs:t.locAbs||!1,pressDelay:t.pressDelay===y?3:t.pressDelay,autoFocus:t.autoFocus||!1,delay:t.delay||200,n:t.n||10,t:t.t||!0,autoCompleteData:t.autoCompleteData||!1,url:t.url||!1,charset:t.charset,callbackFn:t.callbackFn||!1,callbackName:t.callbackName||!1,callbackDataKey:t.callbackDataKey||!1,callbackDataNum:t.callbackDataNum||!1,requestQuery:t.requestQuery||!1,requestParas:t.requestParas||{},noSubmit:t.noSubmit||!1,onSelect:t.onSelect,onSearchDirect:t.onSearchDirect,onCheckForm:t.onCheckForm,onKeySelect:t.onKeySelect,onMouseSelect:t.onMouseSelect,onShow:t.onShow,onHide:t.onHide,onFill:t.onFill,onRequest:t.onRequest,onSucess:t.onSucess,onError:t.onError,onQueryChange:t.onQueryChange,onKeyEsc:t.onKeyEsc,customUrl:t.customUrl||!1,templ:t.templ||!1,autoCache:t.autoCache||!1},n.wrap=n.el.parentNode,n.init())},n=s.prototype;n.init=function(){var r=this,e=r.o;if(r.layoutInit(),r.reset(),r.inputHandle(),e.autoFocus&&setTimeout(function(){r.el.focus()},16),!e.autoCompleteData){var o=e.callbackFn,t=C(o,!0),n,i=o.split(".").pop();r.callback=function(e){e=e||{};var t=arguments.callee;(r=o&&t.repeat&&t.context||r).o.onSucess&&r.o.onSucess.call(r);var n=r.o.callbackDataKey||r.o.callbackDataNum,i=n?e[n]:e;if(!i||!i.length)return r.hide(1),void(r.isHide=!1);r.fill(e,r.q),r.show(),r.o.autoCache&&(r.cache[r.q]=e)},t[i]?t[i].repeat=!0:o&&(t[i]=r.callback)}},n.reset=function(e){var t=this,n;for(n in e)t.o[n]=e[n];t.cache={},t.q="",t.s=b,t.i=-1,t.val="",t.inputTimer(),t.isHide=!1,t.hide(1)},n.layoutInit=function(){var e=this,t=e.o,n=t.locAbs?$.body:e.wrap,i=e.sugWrap=$.createElement("div");if(e.el.setAttribute("autocomplete","off"),o){var r=e.shim=i.appendChild($.createElement("iframe"));r.src="about:blank",f(r,t.classNameShim),r.frameBorder=0,r.scrolling="no",e.content=i.appendChild(i.cloneNode(null))}else e.content=i;f(i,t.classNameWrap),!t.locAbs&&"static"===a(n,"position")&&(n.style.position="relative"),n.appendChild(i)},n.show=function(){this.sugWrap.style.display="",this.o.onShow&&this.o.onShow.call(this)},n.hide=function(e){var t=this;t.sugWrap.style.display="none",t.q=t.el.value,2!=e&&(t.s=b,t.i=-1),1==e&&t.fill(),t.o.onHide&&t.o.onHide.call(t)},n.holdFocus=function(e,t){t.preventDefault?t.preventDefault():e.onbeforedeactivate=function(){i.event.returnValue=!1,e.onbeforedeactivate=null}},n.inputTimer=function(e){var t=this,n=t.el,i=t.t,r;if(e){if(i||!t.o.autoCompleteData&&!t.o.url)return;t.t=setInterval(function(){if(!(r=n.value).trim())return t.o.onQueryChange&&t.o.onQueryChange.call(t),t.forceShow||t.hide(1),void(t.q=r);r!==t.q?t.updata(r):t.val=r,t.o.onQueryChange&&t.o.onQueryChange.call(t,!!r.trim())},t.o.delay)}else i&&clearInterval(t.t),t.t=0},n.getIndex=function(e,t){for(var n=t.length;n--;)if(t[n]===e)return n;return-1},n.matchEl=function(e,t,n){for(;e!==t;){if(n.call(e))return e;e=e.parentNode}return b},n.submitForm=function(){var e=this.el.form;e.onsubmit?e.onsubmit():(this.o.onCheckForm&&this.o.onCheckForm(e),e.submit())},n.keydownMove=function(e){var t=this,n=t.sugWrap.getElementsByTagName("OL")[0];if(n)if(t.isHide)t.isHide=!1;else{var i=n.getElementsByTagName("LI"),r=i.length,o=t.el,a=t.s,s=t.o,c=s.classNameSelect,l=t.q||"",d;a&&(g(a,c),t.i=t.getIndex(a,i),t.s=b),t.i===y&&(t.index=-1),-1!==t.i&&g(i[t.i],c),40===e?t.i++:38===e&&t.i--,-2===t.i?t.i=r-1:t.i===r?(o.value=l,t.i=-1):-1===t.i&&(o.value=l),-1!==t.i&&t.i!==r?(d=i[t.i],f(d,c),s.onKeySelect&&s.onKeySelect.call(t,d),!s.autoCompleteData&&(o.value=d.getAttribute("q").replace(u,"")),t.s=d):40!==e&&38!==e||s.onKeySelect&&s.onKeySelect.call(t,i[0],!0)}},n.inputHandle=function(){var i=this,r=i.o,o=i.el,e=o.form,a=i.sugWrap,t=r.classNameSelect,n=r.autoCompleteData,s=0,c;o.onkeypress=function(e){e=e||window.event,c=e.keyCode;var t=i.s?i.s.getElementsByTagName("a")[0]:null,n="";13===c&&t&&(n=t.getAttribute("href"),i.el.blur(),window.open(n),e.preventDefault?e.preventDefault():e.returnValue=!1)},o.onkeydown=function(e){if(e=e||window.event,27===(c=e.keyCode))return i.hide(2),a.getElementsByTagName("ol")[0]&&(i.isHide=!0),!n&&(o.value=i.q),i.inputTimer(),i.o.onKeyEsc&&i.o.onKeyEsc.call(i),!1;if(32<c&&c<41)o.value||"none"!==a.style.display?40!==c&&38!==c||(r.pressDelay&&0!=s++?s===r.pressDelay&&(s=0):(i.isHide&&i.show(),i.keydownMove(c),i.inputTimer()),!k&&e.preventDefault()):o.blur();else if(13===c){if(i.inputTimer(),i.hide(2),r.onSelect&&r.onSelect.call(i),i.s&&l(i.s,"sug-url")&&r.onSearchDirect&&r.onSearchDirect(i.s,o.value,i.val),n)return o.value=i.s?i.s.getAttribute("q").replace(u,""):"",i.o.onFill&&i.o.onFill.call(i),!1;if(r.noSubmit)return!1}else{if(8<c&&c<19)return void(9!==c&&i.holdFocus(o,e));i.inputTimer(1)}},d(o,"keyup",function(){s=0}),d(o,"blur",function(){i.hide(2),a.getElementsByTagName("ol")[0]&&(i.isHide=!0),i.inputTimer()}),h(a,"mouseover",function(){var e=i.matchEl(this,a,function(){return"LI"===this.tagName});e&&(i.s&&g(i.s,t),f(e,t),i.s=e)}),h(a,"mouseout",function(){var e=i.matchEl(this,a,function(){return"LI"===this.tagName});"LI"===this.tagName&&this!==e&&g(e,t)}),d(a,"mousedown",function(e){i.inputTimer(),i.holdFocus(o,e)}),h(a,"mouseup",function(e){var t=a.getElementsByTagName("OL")[0],n;if(!(!t||e.which&&2<e.which||e.button&&1!==e.button&&4!==e.button)&&(l(this,r.classNameClose)&&i.hide(),n=i.matchEl(this,a,function(){return"LI"===this.tagName}))){if(o.value=n.getAttribute("q").replace(u,""),i.hide(),i.inputTimer(),r.onSelect&&r.onSelect.call(i,n),i.i=i.getIndex(n,t.getElementsByTagName("LI")),i.o.onFill&&i.o.onFill.call(i),l(n,"sug-url"))return r.onSearchDirect&&r.onSearchDirect(n,o.value,i.val),!0;r.onMouseSelect&&r.onMouseSelect.call(i,n),!r.autoCompleteData&&!r.noSubmit&&i.submitForm()}})},n.fill=function(r,o){var e=this,t=e.content;if(arguments.length<2)t.innerHTML="";else{var a=e.o,n=a.templ,s=a.classNameQueryNull,c=a.classNameQuery;this.content.innerHTML=n?n.call(e,r,o):function(){r=r[a.callbackDataKey||a.callbackDataNum]||[];var e=0,t=Math.min(r.length,a.n),n=[],i;for(o=o.trim();e<t;e++)(i=r[e])!==y&&n.push('<li q="'+i+'"'+(s&&-1<i.indexOf(o)?"":" class="+s)+">"+(c?i.replace(o,'<span class="'+c+'">'+o+"</span>"):i)+"</li>");return"<ol>"+n.join("")+"</ol>"}()}},n.updata=function(e){var t=this,n=t.o.autoCompleteData||t.cache[e];if(t.q=e,t.i=-1,t.isHide=!1,n!==y){if(t.o.autoCompleteData&&!n.length)return;return t.fill(n,e),void t.show()}t.request(e)},n.request=function(e){var t=this,n=t.o,i=n.callbackFn,r=n.callbackName,o=n.onSucess,a=n.onError,s=n.onRequest,c=t.callback,l=encodeURIComponent,d=n.url,u=n.customUrl,f=n.requestParas,g=[],h,p;if(i){var m=C(i),v=i.split(".").pop();m[v]=t.callback,m[v].repeat&&(m[v].context=t)}else r&&((p=t.script).readyState?p.onreadystatechange=function(){"loaded"!=p.readyState&&"complete"!=p.readyState||(p.onreadystatechange=b,o&&o.call(t),c(r))}:p.onload=function(){o&&o.call(t),c(r)});if(a&&(t.script.onerror=function(){a.call(t)}),!t.script||!k||w){var _=$.getElementsByTagName("script")[0];(p=$.createElement("script")).type="text/javascript",p.async=!0,t.script?_.parentNode.replaceChild(p,t.script):_.parentNode.insertBefore(p,_),t.script=p}s&&s.call(this),f=function(){for(h in f)(p=f[h])!==y&&g.push(l(h)+"="+l(f[h]));return n.t&&g.push(l("t")+"="+l(+new Date)),g.join("&")}(),t.script.charset=n.charset?n.charset:"",t.script.src=u&&u.call(t,f)||d+"?"+n.requestQuery+"="+encodeURIComponent(e)+"&"+f,t.val=e},c=s}(window,document),c}),define("util/observer",[],function(){var e;return $({})}),define("util/searchStore",[],function(){var t="ZUFANG"+(config&&config.cur_city_id?config.cur_city_id:""),n="localStorage";function r(){try{return window[n][t]&&JSON.parse(window[n][t])||null}catch(e){return null}}function o(e){try{window[n][t]=JSON.stringify(e)}catch(e){}}function i(n){var e=r()||[],i=[];i.push(n),$.each(e,function(e,t){t.id===n.id&&t.type===n.type||i.push(t)}),o(i=i.slice(0,50))}function e(){try{window[n].removeItem(t)}catch(e){}}return{get:function(){return r()},add:function(e){i(e)},clear:function(){e()}}}),define("util/checkLogin",["util/ajax"],function(){var e=require("util/ajax");function n(t,n){try{e({url:"/zufang/aj/userinfo",method:"get",dataType:"json"}).then(function(e){t(e)}).fail(function(e){n&&n(e)})}catch(e){console.log(e)}}return{checkLogin:function(e,t){n(e,t)}}}),define("util/cookie",[],function(){var t=/\+/g,f,e,n;function g(e){return f.raw?e:encodeURIComponent(e)}function h(e){return f.raw?e:decodeURIComponent(e)}function p(e){return g(f.json?JSON.stringify(e):String(e))}function i(e){0===e.indexOf('"')&&(e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return e=decodeURIComponent(e.replace(t," ")),f.json?JSON.parse(e):e}catch(e){}}function m(e,t){var n=f.raw?e:i(e);return $.isFunction(t)?t(n):n}return(f=e=function(e,t,n){if(1<arguments.length&&!$.isFunction(t)){if("number"==typeof(n=$.extend({},f.defaults,n)).expires){var i=n.expires,r=n.expires=new Date;r.setMilliseconds(r.getMilliseconds()+864e5*i)}return document.cookie=[g(e),"=",p(t),n.expires?"; expires="+n.expires.toUTCString():"",n.path?"; path="+n.path:"",n.domain?"; domain="+n.domain:"",n.secure?"; secure":""].join("")}for(var o=e?void 0:{},a=document.cookie?document.cookie.split("; "):[],s=0,c=a.length;s<c;s++){var l=a[s].split("="),d=h(l.shift()),u=l.join("=");if(e===d){o=m(u,t);break}e||void 0===(u=m(u))||(o[d]=u)}return o}).defaults={},{cookie:e,removeCookie:function(e,t){return $.cookie(e,"",$.extend({},t,{expires:-1})),!$.cookie(e)}}}),define("util/loadjs",[],function(){function e(e,t){$.getScript(e,function(){t&&t()})}return{load:e}}),define("module/search/index",["ui/suggest/index","util/observer","util/searchStore","util/api","util/ajax","util/checkLogin","util/cookie","util/loadjs"],function(){var e=require("ui/suggest/index"),t=require("util/observer"),c=require("util/searchStore"),i=$("#search"),l=i.find('[data-el="input"]'),r=i.find('[data-el="button"]'),n=require("util/api"),a=require("util/ajax"),o=require("util/checkLogin"),s=require("util/cookie"),d=require("util/loadjs"),u,f=g_conf.resblockid,g={code:0,ucid:""},h=null;function p(e){h=new LianjiaIM({appid:imConf.imAppid,appkey:imConf.imAppkey,is_ljbb:!1,is_bkbb:!0,token:s.cookie("lianjia_token"),userData:e,downAppUrl:" ",appDesc:" ",staticRoot:"https://s1.ljcdn.com/feroot/?_v=20180131223836909"})}function m(){var n=e(l[0],{classNameWrap:"sug-search",classNameQuery:"sug-query",classNameSelect:"sug-select",delay:80,n:10,autoFocus:!1,requestQuery:"query",requestParas:{callback:"SearchSug2015",city_id:config.cur_city_id,channel:"rent"},url:"/zufang/ajax/sug",callbackFn:"SearchSug2015",callbackDataKey:"data",noSubmit:!0,autoCache:!0,onMouseSelect:function(e){e&&l.attr("data-json",e.getAttribute("data-json")),t.trigger("submit_input",{channel:"mouse"})},onSucess:function(){l.attr("data-json","")},onSelect:function(e){e||t.trigger("submit_input",{channel:"enter"})},onKeySelect:function(e,t){e&&!t?l.attr("data-json",e.getAttribute("data-json")):l.attr("data-json","")},onQueryChange:function(e){if(void 0===e&&!n.forceShow){var t=c.get();t&&t.length&&(t[0].isHistory=!0,n.fill({data:t},""),n.show(),n.forceShow=!0)}void 0!==e&&(n.forceShow=!1)},templ:function(e,t){var n=e.data||[],i=[],r=0,o="",a=Math.min(10,n.length),s=!1;for(a&&(s=n[0].isHistory,delete n[0].isHistory,s?i.push('<p>搜索历史<span class="fr pointer" data-el="clearHistory">清空搜索历史</span></p>'):i.push("<p>你可能在找</p>"));r<a;r++)o="<li data-json='",o+=JSON.stringify(n[r]),o+="' data-event_id='"+(s?10798:10799)+"' data-event_action='target="+n[r].uri,o+="' data-origin='"+t+"' q='",o+=n[r].name,o+="'><span class='fl oneline ui--suggest__oneline ",o+=s?"ui--suggest__oneline--long":"",o+="'>",o+=t?'<span class="ui--suggest__hl">'+n[r].name.replace(t,'<span class="ui--suggest__em">'+t+"</span>")+"</span>":'<span class="ui--suggest__hl">'+n[r].name+"</span>",o+='<span class="ui--suggest__light">',n[r].alias&&(o+=t?"（"+n[r].alias.replace(t,'<span class="ui--suggest__em">'+t+"</span>")+"）":"（"+n[r].alias+"）"),o+=t?(n[r].sub_title||"").replace(t,'<span class="ui--suggest__em">'+t+"</span>"):n[r].sub_title,o+="</span></span>",s||(o+='<span class="fr ui--suggest__aside">约'+n[r].count+"套在租"),o+="</li>",i.push(o);return"<ol>"+i.join("")+"</ol>"}});l.on("focus",function(){if($.trim(l.val()))n.forceShow=!1;else{var e=c.get();e&&e.length&&(e[0].isHistory=!0,n.fill({data:e},""),n.show(),n.forceShow=!0)}}),r.on("click",function(){t.trigger("submit_input",{channel:"button"})}),t.on("submit_input",function(e,t){var n=l.attr("data-json"),i=$.trim(l.val()),r=n&&$.parseJSON(n),o=encodeURIComponent(i),a="",s={};r?(a=r.uri,$.extend(s,r)):(a="/zufang/rs"+o+"/",$.extend(s,{name:i,id:i,type:"query",uri:a,sub_title:"",alias:"",count:""})),i&&c.add(s),$ULOG.send(10800,{action:{search_condition:a}}),location.href=a}),i.on("click",'[data-el="clearHistory"]',function(){c.clear(),n.hide(1),n.forceShow=!1}),$('[data-el="callIM_agent"]').on("click",function(){var e=$(this).attr("data-type"),t=$(this).attr("data-port"),n=$(this).attr("data-houseName"),i=$(this).attr("data-event_action");$ULOG.send(13753,{action:{Resblock_id:f,Agent_ucid:u,e_plan:i}});var r={ucid:u,port:t,msgPayload:"您好,我想咨询"+n+"的相关信息"};i&&(r.extends=JSON.stringify({app_data:JSON.stringify({business_dig_v:i})})),o.checkLogin(function(e){e&&e.data&&e.data.id?h&&(g.ucid!=e.data.id?(g.code=1,g.ucid=e.data.id+"",p(g),setTimeout(function(){h.initTalk(r)},2e3)):h.initTalk(r)):$('[data-el="btn_login"]').trigger("click")},function(){$('[data-el="btn_login"]').trigger("click")})})}function v(){var n=$('[data-el="updatePhone"]'),e=n.attr("data-ucid"),t="diaoding",i=$("#card_agent"),r=n.attr("data-digv"),o;e&&a({url:"/zufang/aj/recommendAgent/brokers",dataType:"json",data:{position:t,ucid:e,dig_v:r}}).then(function(e){if(e=e&&e.data){var t=e.agent_phone.replace(",","转");n.html(t),u=e.agent_ucid,y()}})}function _(){var e=$('[data-el="callIM_agent"]').eq(0),t=e&&$(e).attr("data-brand");d.load(n.env.LianjiaIM,function(){o.checkLogin(function(e){e&&e.data&&e.data.id&&g.ucid!=e.data.id&&(g.code=1,g.ucid=e.data.id+"",p(g))})})}function y(){var e,t=$('[data-el="callIM_agent"]').attr("data-event_action"),n;$("#card_agent")&&$ULOG.send(13751,{action:{Resblock_id:f,Agent_ucid:u,e_plan:t}})}return{initIM:function(e){g.code=1,g.ucid=e.id+"",p(g)},init:function(){_(),m(),v()}}}),define("util/getParams",[],function(){function t(e){var t=location.search.length&&location.search.substring(1).split("&"),i={};return $(t).each(function(e,t){var n=t.split("=");n[0]&&(i[n[0]]=n[1])}),i[e]}function i(e,t,n){var i=location;n&&((i=$.parseUrl(n)).pathname="/"+i.path,i.search="?"+i.query,i.hash="#"+i.hash);var r,o=i.search+"&"+e+"="+t,a;return location.protocol+"//"+location.host+i.pathname+o+i.hash}return{getParams:function(e){return t(e)},setParams:function(e,t,n){return i(e,t,n)}}}),define("module/filter/index",["util/searchStore","util/getParams"],function(){var l=require("util/searchStore"),d=require("util/getParams"),u=$("#filter");function f(n){var i={radio:[],checkbox:[],str:[],items:[]},e={name:"",id:"",type:"",uri:"",sub_title:"",alias:"",count:""},t=n.closest("ul"),r=n.parent();if(r.hasClass("filter__item--level2")||r.hasClass("filter__item--level3")){if(e.name=n.text(),e.id=r.attr("data-id"),e.type=r.attr("data-type"),"不限"==e.name)if(r.hasClass("filter__item--level3")){var o=$(".filter__item--level2.strong");e.name=o.find("a").eq(0).text(),e.id=o.attr("data-id"),e.type=o.attr("data-type")}else e.name=config.cur_city_name,e.id=config.cur_city_id,e.type="global"}else{var a=$.trim($(".search__input").attr("data-value"));if(a)e.name=a,e.id=a,e.type="query";else{var s=$(".filter__item--level2.strong"),c=$(".filter__item--level3.strong");c.length&&-1==$.trim(c.text()).search("不限")?(e.name=$.trim(c.text()),e.id=c.attr("data-id"),e.type=c.attr("data-type")):s.length&&-1==$.trim(s.text()).search("不限")&&(e.name=$.trim(s.text()),e.id=s.attr("data-id"),e.type=s.attr("data-type"))}}return u.find("ul").each(function(){var e=$(this);e.hasClass("filter__item--noaside")||(this==t.get(0)?(e.find(".checked, .strong").each(function(){var e=$(this),t=e.find("a");"javascript:;"!==t.attr("href")&&"不限"!==$.trim(t.text())&&e.hasClass("filter__item--level5")&&n.get(0)!=this&&(i.checkbox.push(t.text()),i.str.push(t.text()))}),r.hasClass("checked")||r.hasClass("strong")||"不限"===$.trim(n.text())||(r.hasClass("filter__item--level5")?(i.checkbox.push(n.text()),i.str.push(n.text())):r.hasClass("filter__item--level4")&&(i.radio.push(n.text()),i.str.push(n.text())))):e.find(".checked, .strong").each(function(){var e=$(this),t=e.find("a");"javascript:;"!==t.attr("href")&&"不限"!==$.trim(t.text())&&(e.hasClass("filter__item--level5")&&(i.checkbox.push(t.text()),i.str.push(t.text())),e.hasClass("filter__item--level4")&&(i.radio.push(t.text()),i.str.push(t.text())))}))}),e.id||(e.name=config.cur_city_name,e.id=config.cur_city_id,e.type="global"),e.sub_title=i.str.join(" "),i.items.push(e),e}function e(){u.on("click",'[data-tab="1"]',function(){if($(this).hasClass("down"));else{var e=$(this).attr("data-antitarget"),t=$(this).attr("data-el");$(this).addClass("down strong"),u.find('ul[data-target="'+e+'"]').addClass("hide"),u.find('ul[data-target="'+t+'"]').removeClass("hide"),u.find('li[data-el="'+e+'"]').removeClass("down strong")}}).on("click",'[data-el="button"]',function(){var e=$(this).parent(),t=e.attr("data-url"),n="",i=$.trim(e.find('[data-el="input_start"]').val()),r=$.trim(e.find('[data-el="input_end"]').val()),o=Math.round(i)||0,a=Math.round(r)||0;i&&r&&a<o&&(a=(o=[o,a])[0],o=o[1]);var s=null,c="";n=i||r?!i&&r?t.replace("brp{min}",i).replace("rba{min}",i).replace("{max}",a):i&&!r?t.replace("{min}",o).replace("erp{max}",r).replace("rea{max}",r):t.replace("{min}",o).replace("{max}",a):t.replace("brp{min}",i).replace("erp{max}",r).replace("rba{min}",i).replace("rea{max}",r),i&&!r?c=o+"元以上":!i&&r?c=a+"元以下":i&&r&&(c=o+"-"+a+"元"),e.parent().find(".checked").removeClass("checked"),s=f($(this)),n=n.replace(/(.+)\/\/$/,"$1/"),s.uri=n,c&&(s.sub_title+=" "+c),l.add(s),location.href=n+(d.getParams("showMore")?"?showMore=1":"")}).on("click","a",function(e){var t=$(this),n=null;t.closest(".filter__item--noaside").length||(e.preventDefault(),e.stopPropagation(),location.href=t.attr("href")+(d.getParams("showMore")?"?showMore=1":""),"javascript:;"!==t.attr("href")&&((n=f(t)).uri=t.attr("href")+(d.getParams("showMore")?"?showMore=1":""),l.add(n),$ULOG.send(10800,{action:{search_condition:n.uri}})))}),$('[data-el="filterMore"]').on("click",function(){var e=$(this),n=e.find("i"),t;$(".filter__ul").each(function(e,t){3<e&&(n.hasClass("up")?$(t).removeClass("hide"):$(t).addClass("hide"))}),n.hasClass("up")?(history.pushState(null,"",location.protocol+"//"+location.host+location.pathname+"?showMore=1"),e.html('收起<i class="more-icon down"></i>')):(e.html('更多<i class="more-icon up"></i>'),history.pushState(null,"",location.protocol+"//"+location.host+location.pathname))})}function t(){var e=$('[data-el="filterMore"]'),t=$(".filter__ul"),n;d.getParams("showMore")?(t.each(function(e,t){3<e&&$(t).removeClass("hide")}),e.html('收起<i class="more-icon down"></i>')):e.html('更多<i class="more-icon up"></i>')}return{init:function(){e(),t()}}}),define("util/pn",[],function(){function l(e,t,n){var i=[];if(t=t||1,e<=(n=n||6))for(var r=0;r<e;r++)i.push(r+1);else{i.push(1),4<t&&i.push("");for(var o=Math.max(t-2,2),a=Math.min(t+2,e-1),r=o;r<=a;r++)i.push(r);t<e-3&&i.push(""),i.push(e)}return i}function d(e,t,n,i){function r(e){if(i&&1<=e){var t=i.replace(/\{page\}/g,e);return 1===e&&-1<t.search("pg1")&&(t=-1<t.search("pg1/")?t.replace(/pg1\//,""):t.replace(/pg1/,"")),t}return"javascript:;"}var o=[];if(n=n||1,e&&e.length){o.push('<a class="hide" href="'+r(n-1)+'" data-page="'+(n-1)+'" class="'+(1<n&&6<t?"":"disable")+'">&lt;</a>');for(var a=e.length,s=0;s<a;s++)o.push(e[s]?"<a "+(e[s]==n?'class="cur"':"")+' href="'+r(e[s])+'" data-page="'+e[s]+'">'+e[s]+"</a>":"<span>...</span>");n<t&&6<t&&o.push('<a class="next" href="'+r(n+1)+'" data-page="'+(n+1)+'">下一页</a>')}return o.join("")}function e(e,n){if(e){var i={dom:$(e),template:"",targetWrapper:"",totalPage:0,curPage:0},t=$({});return r(),t}function r(){o(),c(),s(),a()}function o(){i.template=i.dom.attr("data-url")+n;var e=i.dom.attr("target-wrapper");e&&(i.targetWrapper=$(e));var t={totalPage:parseInt(i.dom.attr("data-totalPage")),curPage:parseInt(i.dom.attr("data-curPage"))};$.extend(i,t)}function a(){if(!(i.totalPage<=1)){var e=l(i.totalPage,i.curPage);e.length||i.dom.hide();var t=d(e,i.totalPage,i.curPage,i.template);if(i.dom.html(t),i.targetWrapper){var n=i.targetWrapper.children();n.hide(),n.eq(i.curPage-1).show(),i.targetWrapper.find(".lj-lazy").lazyload()}}}function s(){i.targetWrapper&&t.on("showPage",function(e,t){i.curPage=t,a()})}function c(){i.dom.delegate("[data-page]","click",function(){var e=$(this).attr("data-page");t.trigger("showPage",parseInt(e))})}}return e}),define("module/list_content/index",["util/pn","util/getParams"],function(){var t=require("util/pn"),e=require("util/getParams"),n=$("#content");function i(){var e=n.find('[data-el="page_navigation"]');e.length&&t(e,"#contentList")}function r(){$(".content__list").on("click",".content__list--item a",function(e){e.stopPropagation(),e.preventDefault();var t=$('[data-el="rentType"] .strong').attr("data-id"),n=$(this).attr("href"),i=$(this).attr("data-id"),r=$(this).attr("target"),o=0<n.indexOf("?")?n+"&nav="+t+(i?"&layout_id="+i:""):n+"?nav="+t+(i?"&layout_id="+i:"");window.open(o,r)})}return{init:function(){i(),r()}}}),define("module/duty_pop/index",[],function(){function t(e){var t='<div class="pop-large" data-el="popLarge"><div class="pop-close" data-el="popLargeClose"></div><img src="'+e+'" class="pop-img"/></div>';$("body").append(t)}function n(){$('[data-el="dutyPic"]').on("click",function(){var e;t($(this).attr("src")),$('[data-el="popLarge"], [data-el="popLargeClose"]').on("click",function(){$(this).remove()})})}function e(e){n()}return{init:e}}),define("module/fix_right/kefu",[],function(){function e(e){var t=['<div class="m-kefu">','<div class="box">','<div class="close">×</div>','<div class="hd">官方客服</div>','<div class="bd">','<div class="text">您可以与在线顾问进行实时沟通或者拨打客服热线获得帮助</div>','<div class="item">','<span class="item-1">在线咨询</span>','<span class="item-2 zixun">立即咨询</span>','<span class="item-3 time">周一至周日 09:00-22:00</span>',"</div>",'<div class="item">','<span class="item-1">客服热线</span>','<span class="item-2 num">1010 9666</span>','<span class="item-3 time">周一至周日 09:00-20:00</span>',"</div>","</div>",'<div class="ft">',"<span>关闭</span>","</div>","</div>","</div>"].join("");$(document.body).on("click","#back-top .phone a",function(){$(".m-kefu").length?$(".m-kefu").show():$(document.body).append(t)}).on("click",".m-kefu .ft span, .m-kefu .close",function(){$(".m-kefu").hide()}).on("click",".m-kefu .zixun",function(){$(".m-kefu .close").click(),window.__isLogin?$(".lianjiaim .lianjiaim-body-item").first().find("tr").first().click():$(".btn-login").click()})}return e}),define("util/storage",[],function(){function e(e,t){localStorage.setItem(e,t)}function t(e){return localStorage.getItem(e)}function n(e){localStorage.removeItem(e)}function i(e,t){sessionStorage.setItem(e,t)}function r(e){return sessionStorage.getItem(e)}function o(e){sessionStorage.removeItem(e)}return{setSessionStorage:i,getSessionStorage:r,clearSessionStorage:o,setStorage:e,getStorage:t,clearStorage:n}}),define("module/im/index",["util/api","util/checkLogin","util/cookie","util/loadjs","util/storage"],function(){var n=require("util/api"),o=require("util/checkLogin"),t=require("util/cookie"),i=require("util/loadjs"),a=require("util/storage"),s={code:0,ucid:""},c=null;function l(e){c=new LianjiaIM({appid:imConf.imAppid,appkey:imConf.imAppkey,is_ljbb:!0,is_bkbb:!1,token:t.cookie("lianjia_token"),userData:e,downAppUrl:" ",appDesc:" ",staticRoot:"https://s1.ljcdn.com/feroot/?_v=20180131223836909"})}function e(){var e=$('[data-el="callIM"]').eq(0),t=e&&$(e).attr("data-brand");i.load(n.env.LianjiaIM,function(){o.checkLogin(function(e){e&&e.data&&e.data.id&&s.ucid!=e.data.id&&(s.code=1,s.ucid=e.data.id+"",l(s))})})}function r(i,e){var t=(new Date).toLocaleDateString(),n=a.getStorage("IM_HOUSE_INFO")&&JSON.parse(a.getStorage("IM_HOUSE_INFO"))||{};n=n[i.houseId]||"";var r={ucid:i.agentUcid,port:i.port,push_content:i.title};r=t==n?e&&e.length?$.extend(r,{msgPayload:e}):r:e&&e.length?$.extend(r,{scheme:i.scheme,msgPayload:e}):$.extend(r,{scheme:i.scheme}),o.checkLogin(function(e){if(e&&e.data&&e.data.id){if(c){s.ucid!=e.data.id?(s.code=1,s.ucid=e.data.id+"",l(s),setTimeout(function(){c.initTalk(r)},2e3)):c.initTalk(r);var t={};t[i.houseId]=(new Date).toLocaleDateString();var n=$.extend(JSON.parse(a.getStorage("IM_HOUSE_INFO")),t);a.setStorage("IM_HOUSE_INFO",JSON.stringify(n))}}else $('[data-el="btn_login"]').trigger("click")},function(){$('[data-el="btn_login"]').trigger("click")})}function d(){$('[data-el="callIM"]').on("click",function(){var e,t="layout"==$(this).data("type")?$(this).attr("data-id")+getParams.getParams("layout_id"):$(this).attr("data-id"),n;r({agentUcid:$(this).attr("data-im_id"),houseId:t,houseType:$(this).attr("data-type"),scheme:"lianjiaim://rentplat/httpreq?cardID=2&id="+$(this).attr("data-id")+"&idType=rent_plat_c&cardType="+$(this).attr("data-type"),port:$(this).attr("data-port"),title:$(this).attr("data-title")})}),$('[data-el="send-im"]').on("click",function(){var e,t;r({agentUcid:$(this).parent().data("im_id"),houseId:$(this).parent().data("id"),houseType:$(this).parent().data("type"),scheme:"lianjiaim://rentplat/httpreq?cardID=2&id="+$(this).parent().data("id")+"&idType=rent_plat_c&cardType="+$(this).parent().data("type"),port:$(this).parent().data("port"),title:$(this).parent().data("title")},$(this).data("msg"))})}return{initIM:function(e){s.code=1,s.ucid=e.id+"",l(s)},init:function(){e(),d()}}}),define("module/fix_right/index",["require","module/fix_right/kefu","module/im/index"],function(e){var t=e("module/fix_right/kefu"),n=e("module/im/index");function i(){$("body").on("click","#back-top li",function(){var e=$(this).find("a").attr("data-url");if(e)if(window.__isLogin)window.open(e);else{var t=$(".btn-login");0<t.length?t.trigger("click"):alert("请登录后使用，谢谢！")}})}function r(){var e;$("#back-top").on("mouseenter","li",function(){var e=$(this).find(".popup").eq(0),t=this.className;e.show(),e.stop().animate({opacity:"1",right:"38px"},200)}).on("mouseleave","li",function(){var e=$(this).find(".popup").eq(0),t=this.className;curItemClass="",e.stop().animate({opacity:"0",right:"48px"},200,function(){t!=curItemClass&&e.hide()})})}function o(){var e,t;$(window).height()<$(document).scrollTop()?$("#gotop").show():$("#gotop").hide()}function a(){var e=$("#gotop");e.mouseenter(function(){$(this).find("span").css({opacity:"1"}),$(this).css({overflow:"inherit",width:"auto"})}),e.mouseleave(function(e){$(this).find("span").css({opacity:"0"}),$(this).css({overflow:"hidden",width:"37px"})}),$(document).ready(function(e){o(),$("body").on("click","#gotop",function(){$("html , body").animate({scrollTop:0},1e3)})}),$(window).scroll(function(e){o()})}function s(){i(),r()}return{init:function(e){t(),s(),a(),n.init()}}}),define("util/lazyload",[],function(){var e=null;function t(i,d){if(d.getElementsByClassName){var u,f,g=d.documentElement,c=i.Date,r=i.HTMLPictureElement,o="addEventListener",h="getAttribute",t=i[o],p=i.setTimeout,n=i.requestAnimationFrame||p,l=i.requestIdleCallback,m=/^picture$/i,a=["load","error","lazyincluded","_lazyloaded"],s={},v=Array.prototype.forEach,_=function(e,t){return s[t]||(s[t]=new RegExp("(\\s|^)"+t+"(\\s|$)")),s[t].test(e[h]("class")||"")&&s[t]},$=function(e,t){_(e,t)||e.setAttribute("class",(e[h]("class")||"").trim()+" "+t)},y=function(e,t){var n;(n=_(e,t))&&e.setAttribute("class",(e[h]("class")||"").replace(n," "))},b=function(t,n,e){var i=e?o:"removeEventListener";e&&b(t,n),a.forEach(function(e){t[i](e,n)})},k=function(e,t,n,i,r){var o=d.createEvent("CustomEvent");return n||(n={}),n.instance=u,o.initCustomEvent(t,!i,!r,n),e.dispatchEvent(o),o},w=function(e,t){var n;!r&&(n=i.picturefill||f.pf)?n({reevaluate:!0,elements:[e]}):t&&t.src&&(e.src=t.src)},C=function(e,t){return(getComputedStyle(e,null)||{})[t]},x=function(e,t,n){for(n=n||e.offsetWidth;n<f.minSize&&t&&!e._lazysizesWidth;)n=t.offsetWidth,t=t.parentNode;return n},S=(L=[],V=I=[],(e=function(e,t){j&&!t?e.apply(this,arguments):(V.push(e),N||(N=!0,d.hidden?p(O):n(O)))})._lsFlush=O=function(){var e=V;for(V=I.length?L:I,N=!(j=!0);e.length;)e.shift()();j=!1},e),j,N,I,L,V,O,e,U=function(n,e){return e?function(){S(n)}:function(){var e=this,t=arguments;S(function(){n.apply(e,t)})}},q=function(e){var n,i=0,r=125,t=666,o=t,a=function(){n=!1,i=c.now(),e()},s=l?function(){l(a,{timeout:o}),o!==t&&(o=t)}:U(function(){p(a)},!0);return function(e){var t;(e=!0===e)&&(o=44),n||(n=!0,(t=r-(c.now()-i))<0&&(t=0),e||t<9&&l?s():p(s,t))}},E=function(e){var t,n,i=99,r=function(){t=null,e()},o=function(){var e=c.now()-n;e<99?p(o,99-e):(l||r)(r)};return function(){n=c.now(),t||(t=p(o,99))}},T=(X=/^img$/i,Z=/^iframe$/i,Y="onscroll"in i&&!/glebot/.test(navigator.userAgent),ne=te=ee=0,ie=-1,re=function(e){ne--,e&&e.target&&b(e.target,re),(!e||ne<0||!e.target)&&(ne=0)},oe=function(e,t){var n,i=e,r="hidden"==C(d.body,"visibility")||"hidden"!=C(e,"visibility");for(R-=t,B+=t,H-=t,W+=t;r&&(i=i.offsetParent)&&i!=d.body&&i!=g;)(r=0<(C(i,"opacity")||1))&&"visible"!=C(i,"overflow")&&(n=i.getBoundingClientRect(),r=W>n.left&&H<n.right&&B>n.top-1&&R<n.bottom+1);return r},se=q(ae=function(){var e,t,n,i,r,o,a,s,c,l=u.elements;if((D=f.loadMode)&&ne<8&&(e=l.length)){t=0,ie++,null==K&&("expand"in f||(f.expand=500<g.clientHeight&&500<g.clientWidth?500:370),Q=f.expand,K=Q*f.expFactor),te<K&&ne<1&&2<ie&&2<D&&!d.hidden?(te=K,ie=0):te=1<D&&1<ie&&ne<6?Q:0;for(;t<e;t++)if(l[t]&&!l[t]._lazyRace)if(Y)if((s=l[t][h]("data-expand"))&&(o=1*s)||(o=te),c!==o&&(P=innerWidth+o*J,G=innerHeight+o,a=-1*o,c=o),n=l[t].getBoundingClientRect(),(B=n.bottom)>=a&&(R=n.top)<=G&&(W=n.right)>=a*J&&(H=n.left)<=P&&(B||W||H||R)&&(f.loadHidden||"hidden"!=C(l[t],"visibility"))&&(z&&ne<3&&!s&&(D<3||ie<4)||oe(l[t],o))){if(he(l[t]),r=!0,9<ne)break}else!r&&z&&!i&&ne<4&&ie<4&&2<D&&(M[0]||f.preloadAfterLoad)&&(M[0]||!s&&(B||W||H||R||"auto"!=l[t][h](f.sizesAttr)))&&(i=M[0]||l[t]);else he(l[t]);i&&!r&&he(i)}}),le=U(ce=function(e){$(e.target,f.loadedClass),y(e.target,f.loadingClass),b(e.target,de),k(e.target,"lazyloaded")}),de=function(e){le({target:e.target})},ue=function(t,n){try{t.contentWindow.location.replace(n)}catch(e){t.src=n}},fe=function(e){var t,n=e[h](f.srcsetAttr);(t=f.customMedia[e[h]("data-media")||e[h]("media")])&&e.setAttribute("media",t),n&&e.setAttribute("srcset",n)},ge=U(function(e,t,n,i,r){var o,a,s,c,l,d;(l=k(e,"lazybeforeunveil",t)).defaultPrevented||(i&&(n?$(e,f.autosizesClass):e.setAttribute("sizes",i)),a=e[h](f.srcsetAttr),o=e[h](f.srcAttr),r&&(c=(s=e.parentNode)&&m.test(s.nodeName||"")),d=t.firesLoad||"src"in e&&(a||o||c),l={target:e},d&&(b(e,re,!0),clearTimeout(A),A=p(re,2500),$(e,f.loadingClass),b(e,de,!0)),c&&v.call(s.getElementsByTagName("source"),fe),a?e.setAttribute("srcset",a):o&&!c&&(Z.test(e.nodeName)?ue(e,o):e.src=o),r&&(a||c)&&w(e,{src:o})),e._lazyRace&&delete e._lazyRace,y(e,f.lazyClass),S(function(){(!d||e.complete&&1<e.naturalWidth)&&(d?re(l):ne--,ce(l))},!0)}),pe=function(){if(!z)if(c.now()-F<999)p(pe,999);else{var e=E(function(){f.loadMode=3,se()});z=!0,f.loadMode=3,se(),t("scroll",function(){3==f.loadMode&&(f.loadMode=2),e()},!0)}},{_:function(){var e;F=c.now(),u.elements=d.getElementsByClassName(f.lazyClass),M=d.getElementsByClassName(f.lazyClass+" "+f.preloadClass),J=f.hFac,t("scroll",se,!0),t("resize",se,!0),i.MutationObserver?new MutationObserver(se).observe(g,{childList:!0,subtree:!0,attributes:!0}):(g[o]("DOMNodeInserted",se,!0),g[o]("DOMAttrModified",se,!0),setInterval(se,999)),t("hashchange",se,!0),["focus","mouseover","click","load","transitionend","animationend","webkitAnimationEnd"].forEach(function(e){d[o](e,se,!0)}),/d$|^c/.test(d.readyState)||(d[o]("DOMContentLoaded",se),p(pe,2e4)),u.elements.length?(ae(),S._lsFlush()):se()},checkElems:se,unveil:he=function(e){var t,n=X.test(e.nodeName),i=n&&(e[h](f.sizesAttr)||e[h]("sizes")),r="auto"==i;(!r&&z||!n||!e[h]("src")&&!e.srcset||e.complete||_(e,f.errorClass))&&(t=k(e,"lazyunveilread").detail,r&&me.updateElem(e,!0,e.offsetWidth),e._lazyRace=!0,ne++,ge(e,t,r,i,n))}}),M,z,A,D,F,P,G,R,H,W,B,Q,K,J,X,Z,Y,ee,te,ne,ie,re,oe,ae,se,ce,le,de,ue,fe,ge,he,pe,me=(_e=U(function(e,t,n,i){var r,o,a;if(e._lazysizesWidth=i,i+="px",e.setAttribute("sizes",i),m.test(t.nodeName||""))for(o=0,a=(r=t.getElementsByTagName("source")).length;o<a;o++)r[o].setAttribute("sizes",i);n.detail.dataAttr||w(e,n.detail)}),$e=function(e,t,n){var i,r=e.parentNode;r&&(n=x(e,r,n),(i=k(e,"lazybeforesizes",{width:n,dataAttr:!!t})).defaultPrevented||(n=i.detail.width)&&n!==e._lazysizesWidth&&_e(e,r,i,n))},{_:function(){ve=d.getElementsByClassName(f.autosizesClass),t("resize",be)},checkElems:be=E(function(){var e,t=ve.length;if(t)for(e=0;e<t;e++)$e(ve[e])}),updateElem:$e}),ve,_e,$e,ye,be,ke=function(){ke.i||(ke.i=!0,me._(),T._())};return function(){var e,t={lazyClass:"lazyload",loadedClass:"lazyloaded",loadingClass:"lazyloading",preloadClass:"lazypreload",errorClass:"lazyerror",autosizesClass:"lazyautosizes",srcAttr:"data-src",srcsetAttr:"data-srcset",sizesAttr:"data-sizes",minSize:40,customMedia:{},init:!1,expFactor:1.5,hFac:.8,loadMode:1,loadHidden:!0};for(e in f=i.lazySizesConfig||i.lazysizesConfig||{},t)e in f||(f[e]=t[e]);i.lazySizesConfig=f,p(function(){f.init&&ke()})}(),u={cfg:f,autoSizer:me,loader:T,init:ke,uP:w,aC:$,rC:y,hC:_,fire:k,gW:x,rAF:S}}}return e=t(window,window.document)}),define("util/validate",[],function(){return{isPhone:function(n){var e,i="";return[{reg:function(e){return 0<e.length},msg:"请输入手机号"},{reg:function(e){return 11===e.length},msg:"手机号须为11位"},{reg:/\d{11}/,msg:"手机号为纯数字"},{reg:/1\d{10}/,msg:"手机号须以1开头"}].some(function(e,t){if(!(e.reg.test&&e.reg.test(n)||$.isFunction(e.reg)&&e.reg(n)))return i=e.msg,!0}),i},isVarifyCode:function(n){var e,i="";return[{reg:function(e){return 6===e.length},msg:"验证码须为6位"},{reg:/\d{6}/,msg:"验证码为纯数字"}].some(function(e,t){if(!(e.reg.test&&e.reg.test(n)||$.isFunction(e.reg)&&e.reg(n)))return i=e.msg,!0}),i}}}),define("config/passport",[],function(){var t=config.passport_host;function e(e){return t+e}return{sendSms:e("/sendSms"),freshCaptch:e("/freshCaptch"),login:{getFirstTicket:e("/login?get-lt=true&isajax=true&type=2"),loginUrl:e("/login?type=2"),service:config.passport_service||"http://matrixapi.lianjia.com",setLoginUrl:location.protocol+"//"+location.host+"/cas/login"}}}),define("module/login/index",["util/validate","config/passport","util/ajax","util/observer"],function(){var t=require("util/validate"),n=require("config/passport"),i=require("util/ajax"),r=require("util/observer");function e(e){return o.find('[data-el="'+e+'"]')}var o=$("#login"),a=e("phoneInput"),s=e("codeInput"),c=e("getCode"),l=e("popup"),d=e("imgCodeInput"),u=e("refeshImgCode"),f=e("picConfirm"),g=e("closePopup"),h=e("showError"),p=e("autoLogin"),m=e("submit"),v=e("shadow");function _(){return $.trim(a.val())}function y(e){return t.isPhone(e)}function b(){return $.trim(s.val())}function k(e){return t.isVarifyCode(e)}function w(){return $.trim(d.val())}function C(e){lianjiaCasManager.login({username:e.phone,code:e.code,_eventId:"submit"},function(e){(e=e&&e.data||{}).displayName?location.reload():S("登录失败，请重试")},function(e){S(e&&e.msg||"登录失败，请重试")})}function x(e,t){i({url:n.sendSms,dataType:"jsonp",data:{phone:e,code:t||""}}).done(function(e){1==(e=e||{}).code?(L.stop(),L.start()):2==e.code?(V.show(),V.refreshCode()):S(e.msg||"发送失败，请重试"),e.smsCode&&s.val(e.smsCode.code)}).fail(function(){S("发送失败，请重试")})}function S(e){h.text(e),h.removeClass("hide")}function j(){h.addClass("hide")}function N(){return{phone:_(),code:b(),isAuto:p.hasClass("login__check--checked")}}function I(e){var t=y(e.phone)||"";return t=t||k(e.code)}var L={t:null,start:function(){var e=59,t=0;function n(){59<=t?L.stop():(c.removeClass("enabled"),c.text(c.attr("data-tip")+"("+(59-t++)+")"))}n(),L.t=setInterval(n,1e3)},stop:function(){c.addClass("enabled"),c.text(c.attr("data-origin")),L.t&&clearInterval(L.t),L.t=null}},V={show:function(){l.removeClass("hide"),V.refreshCode()},hide:function(){l.addClass("hide")},refreshCode:function(){d.val(""),u.attr("src",n.freshCaptch+"?_="+ +new Date),d.focus()},bind:function(){u.on("click",function(){V.refreshCode()}),f.on("click",function(){var e=w();e&&(V.hide(),x(_(),e))}),g.on("click",function(){V.hide()})}};return{loginSuccess:function(e){},initConfig:function(){},bind:function(){var e=this;v.on("click",function(){e.hideBox()}),r.on("login",function(){e.showBox()}),c.on("click",function(){if(c.hasClass("enabled")){var e=y(_());e?S(e):(j(),x(_()),c.html()==c.attr("data-origin")?$ULOG.send(10793):$ULOG.send(10791))}}),p.on("click",function(){p.toggleClass("login__check--checked")}),m.on("click",function(){var e=N(),t=I(e);t?(S(t),$ULOG.send(10786,{action:{status:"failed"}})):(j(),C(e),$ULOG.send(10786,{action:{status:"success"}}))}),V.bind()},showBox:function(){o.removeClass("hide")},hideBox:function(){o.addClass("hide")},loginMsg:function(){var t=this;i({url:"/zufang/aj/userinfo",method:"get",dataType:"json"}).done(function(e){(e=(e=e||{}).data)&&e.displayName&&(window.__isLogin=!0,t.loginSuccess(e))})},init:function(){this.bind(),this.initConfig(),this.loginMsg()}}}),define("page/list/index",["module/top/index","module/footer/index","module/search/index","module/filter/index","module/list_content/index","module/duty_pop/index","module/fix_right/index","util/lazyload","module/login/index"],function(){var e=require("module/top/index"),t=require("module/footer/index"),n=require("module/search/index"),i=require("module/filter/index"),r=require("module/list_content/index"),o=require("module/duty_pop/index"),a=require("module/fix_right/index"),s=require("util/lazyload"),c=require("module/login/index");return{init:function(){e.init(),t.init(),c.init(),n.init(),i.init(),r.init(),$(".lazyload").attr("data-expand",400),s.init(),o.init(),a.init()}}});